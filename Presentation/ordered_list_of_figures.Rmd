---
title: "Ordered List of Figures"
author: "Spiro Stilianoudakis"
date: "May 28, 2019"
output:
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Supplementary/figure1_dist_densities_gm12878.png) |
| **Supplementary Figure 1. Performing $log_{2}$ transformations normalized skewed distance densities across resolution for GM12878.** When measured in basepairs, distances were highly right skewed for all resolutions: (A) 10 kb, (B) 25 kb, (C) 50 kb, and (D) 100 kb. After $log_{2}$ transforming the distances, densities became much more gaussian distributed for all resolutions: (E) 10 kb, (F) 25 kb, (G) 50 kb, and (H) 100 kb. Each density curve represents a cell line specific annotation, and its relationship with all resolution specific genomic bins. |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Supplementary/figure2_dist_densities_k562.png) |
| **Supplementary Figure 2. Performing $log_{2}$ transformations normalized skewed distance densities across resolution for K562.** When measured in basepairs, distances were highly right skewed for all resolutions: (A) 10 kb, (B) 25 kb, (C) 50 kb, and (D) 100 kb. After $log_{2}$ transforming the distances, densities became much more gaussian distributed for all resolutions: (E) 10 kb, (F) 25 kb, (G) 50 kb, and (H) 100 kb. Each density curve represents a cell line specific annotation, and its relationship with all resolution specific genomic bins. |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Figures/figure1_ensemble_framework.png) |
| **Figure 1. Ensemble Framework.** A diagram of the cell line specific ensemble framework detailing the various combination of inputs used in the model building pipeline. The minoirty and majority classes were represented by the genomic bins that overlapped with flanked TAD boundaries or did not, respectively. Functional genomic annotations obtained from the UCSC Genome Browser Database composed the feature space. The data was split into a 7:3 training to testing set ratio. A feature engineering step was included to isolate the spatial relationship, of increasing granularity, between annotations and genomic bins. Data re-sampling and regularization was applied to the training data. Lastly, a random forest classification algorithm was implemeted and validated on the testing data. |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Figures/figure2_model_construction_V3.png) |
| **Figure 2. Model Construction.** An illustration of the proposed model construction given cell line specific Hi-C data. Above is an example of a subsection of the contact matrix for chromosome 14 (at megabase scale) on GM12878 [@durand2016juicer]. The contact matrix is a visualization of the interconnectivity of the linear genome at 100 kb resolution. The boundary coordinates of TADs were identified using the Arrowhead algorithm. To account for the uncertainty in TAD boundary detection, each boundary point was flanked on both sides by resolution-specific genomic regions (bins). The response vector $Y$, used for classification, was determined by whether a genomic bin overlapped with a flanked boundary region ($Y=1$) or not ($Y=0$). The spatial relationship between positional coordinates of various functional genomic annotations, obtained from the UCSC Genome Browser Database, together with the genomic bins were then used to define the feature space of the models represented by the data matrix $X = \{X_1, X_2, ..., X_p\}$, where $p$ was the complete set of functional annotations. |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Figures/figure3_predictor_types.png) |
| **Figure 3. Predictor types.** Three separate types of predictors were considered when quantifying the association between TAD boundaries and genomic annotations. Each predictor type was used to build the feature space of specific models in the ensemble framework. (A) _Overlap Counts_ (OC) consider the total number of genomic features that overlapped with each genomic bin. (B) _Overlap Percent_ (OP) was calculated by dividing the sum of all feature widths within each specific bin by the total bin width. (C) _Distance_ ($log_{2}$ transformed) was calculated by measuring the distance (in bases) from the center of each genomic bin to the center of the nearest region defining a genomic annotation.  |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Figures/figure4_gm12878_model_performances.png) |
| **Figure 4. SMOTE re-sampled models built on distance-type predictors yielded optimal MCCs across resolutions for GM12878.** Performances of random forest classification models built on each of the 3 predictor types: (A) OC, (B) OP, and (C) Distance. Within each predictor type, and across resolution, training data was re-sampled using different techniques including: None (red), ROS (green), RUS (blue), and SMOTE (purple). Performances were aggregated using means across each chromosome, with error bars representing 1 standard deviation away from the mean.  |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Supplementary/figure3_k562_model_performances.png) |
| **Supplementary Figure 3. SMOTE re-sampled models built on distance-type predictors yielded optimal MCCs across resolutions for K562.** Performances of random forest classification models built on each of the 3 predictor types: (A) OC, (B) OP, and (C) Distance. Within each predictor type, and across resolution, training data was re-sampled using different techniques including: None (red), ROS (green), RUS (blue), and SMOTE (purple). Performances were aggregated using means across each chromosome, with error bars representing 1 standard deviation away from the mean. |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Figures/figure5_proportion_of_importances_gm12878.png) |
| **Figure 5. The proportional importance of optimally built predictive models was outweighed by transcription factor binding sites across resolutions for GM12878.** Stacked barplots illustrate the proportion of total predictive importance in models using optimal data level characteristics determined by the ensemble framework (SMOTE re-sampling; with distance-type predictors), for each resolution on GM12878. Proportions are grouped by the class of cell line specific annotations in the feature space including chromatin state segmentations (CSS), histone modifications (HM), and transcription factor binding sites (TFBS).  |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Supplementary/figure4_proportion_of_importances_k562.png) |
| **Supplementary Figure 4. The proportional importance of optimally built predictive models was outweighed by transcription factor binding sites across resolutions for K562.** Stacked barplots illustrate the proportion of total predictive importance in models using optimal data level characteristics determined by the ensemble framework (SMOTE re-sampling; with distance-type predictors), for each resolution on GM12878. Proportions are grouped by the class of cell line specific annotations in the feature space including chromatin state segmentations (CSS), histone modifications (HM), and transcription factor binding sites (TFBS). |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Figures/figure6_comparing_sets_of_annotations_gm12878.png) |
| **Figure 6. Optimally built TFBS-specific models outperformed other annotation-specific models across resolution for GM12878** Performances were compared for random forest models built using specific groups of annotations as the feature space including: histone modifications (HM; red), chromatin state segmentations (CSS; green), transcription factor binding sites (TFBS; blue), and a feature space containing all 3 types combined (combined; purple). Each bar represents a model ran through the ensemble framework, with re-sampling technique and predictor-type characteristics fixed to SMOTE and distance-types. The error bars represent $\pm$ 1 standard deviation from the mean MCC across each chromosome.  |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Supplementary/figure5_comparing_sets_of_annotations_k562.png) |
| **Supplementary Figure 5. Optimally built TFBS-specific models outperformed other annotation-specific models across resolution for K562** Performances were compared for random forest models built using specific groups of annotations as the feature space including: histone modifications (HM; red), chromatin state segmentations (CSS; green), transcription factor binding sites (TFBS; blue), and a feature space containing all 3 types combined (combined; purple). Each bar represents a model ran through the ensemble framework, with re-sampling technique and predictor-type characteristics fixed to SMOTE and distance-types. The error bars represent $\pm$ 1 standard deviation from the mean MCC across each chromosome. |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Figures/figure7_variable_importance_heatmaps_tfbs_gm12878.png) |
| **Figure 7. Top 20 most predictive transcription factor binding sites sorted by 10 kb for GM12878.** A heatmap illustrating the importance of the key transcription factors for optimally built random forest models. Importances were sorted according to the 10 kb resolution and rescaled to values between 0 and 100. Transcription factors with higher values of predictive importance are denoted in dark red.  |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Supplementary/figure6_variable_importance_heatmaps_tfbs_k562.png) |
| **Supplementary Figure 6. Top 20 most predictive transcription factor binding sites sorted by 10 kb for K562.** A heatmap illustrating the importance of the key cell line specific transcription factors for optimally built random forest models across resolution. Importances were sorted according to the 10 kb resolution and rescaled to values between 0 and 100. Transcription factors with higher values of predictive importance are denoted in dark red. |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Figures/figure8_distance_boxplots_key_tfbs_gm12878_10kb.png) |
| **Figure 8. Top predictive transcription factor binding sites are significantly closer to bins that overlap with 10 kb flanked TAD boundaries on GM12878** Boxplots illustrating the distribution of distances (on $log_{2}$ scale) around 10 kb regions on the linear genome that either overlapped with a flanked TAD boundary (Yes) or did not (No), for the most influential cell line specific TFBS including SMC3, CTCF, RAD21, ZNF143, and YY1sc281. P-values obtained from Wilcoxon Rank Sum tests are provided assessing the significance [$NS$ = p > 0.05; $*$ = 0.01 < p $\le$ 0.05; $**$ = 0.001 < p $\le$ 0.01; $***$ = 0.0001 < p $\le$ 0.001; $****$ = p $\le$ 0.00001]. |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Supplementary/figure9_distance_boxplots_key_tfbs_gm12878_other_res.png) |
| **Supplementary Figure 9. Top predictive transcription factor binding sites were significantly closer to bins that overlapped with varying units of flanked TAD boundaries on GM12878** Boxplots illustrating the distribution of distances (on $log_{2}$ scale) around (A) 25 kb, (B) 50 kb, and (C) 100 kb regions on the linear genome that either overlapped with a flanked TAD boundary (Yes) or did not (No), for the most influential cell line specific TFBS including SMC3, CTCF, RAD21, ZNF143, and YY1sc281. P-values obtained from Wilcoxon Rank Sum tests are provided assessing the significance [$NS$ = p > 0.05; $*$ = 0.01 < p $\le$ 0.05; $**$ = 0.001 < p $\le$ 0.01; $***$ = 0.0001 < p $\le$ 0.001; $****$ = p $\le$ 0.00001]. |
+-------+

+-------+
| ![](C:/Users/stili/Documents/TAD_predictive_modeling/Manuscript/Supplementary/figure10_distance_boxplots_key_tfbs_K562_all_res.png) |
| **Supplementary Figure 10. Top predictive transcription factor binding sites were significantly closer to bins that overlapped with varying units of flanked TAD boundaries on K562** Boxplots illustrating the distribution of distances (on $log_{2}$ scale) around (A) 10 kb, (B) 25 kb, (C) 50 kb, and (D) 100 kb regions on the linear genome that either overlapped with a flanked TAD boundary (Yes) or did not (No), for the most influential cell line specific TFBS including SMC3, CTCF, RAD21, and ZNF143. P-values obtained from Wilcoxon Rank Sum tests are provided assessing the significance [$NS$ = p > 0.05; $*$ = 0.01 < p $\le$ 0.05; $**$ = 0.001 < p $\le$ 0.01; $***$ = 0.0001 < p $\le$ 0.001; $****$ = p $\le$ 0.00001]. |
+-------+














