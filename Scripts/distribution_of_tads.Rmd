---
title: "Distribution of TADs"
author: "Spiro Stilianoudakis"
date: "April 10, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading Libraries

```{r}
library(GenomicRanges)
library(caret)
library(data.table)
library(gbm)
library(randomForest)
library(glmnet)
library(pROC)
library(plyr)
library(dplyr)
library(ggplot2)
library(DMwR)
library(gridExtra)
library(pROC)
library(ROCR)
#library(leaps)
library(cluster)
library(ggpubr)
library(scales)
library(GGally)
library(VennDiagram)
library(network)
library(sna)
library(gtable)
library(grid)
library(magrittr) 
library(DT)
library(tidyverse)
library(reshape)
library(ROSE)
library(lattice)
library(corrplot)
library(cluster)
library(RColorBrewer)

```

# GM12878

## 10kb

```{r}
tad_gm12878_10kb <- read.table("Z:/TAD_data_analysis/GM12878/10kb/GM12878_domain_data_10000.b.txt")
tad_gm12878_10kb <- tad_gm12878_10kb[,1:3]

tad_gm12878_10kb <- tad_gm12878_10kb %>%
  group_by(V1) %>%
  mutate(Length = V3-V2)

tad_gm12878_10kb$V1 <- factor(tad_gm12878_10kb$V1, levels = c(1:22))

tad_data_gm12878_10kb <- tad_gm12878_10kb %>% 
  group_by(V1) %>% 
  summarise(Count = length(V1),
            Length = mean(Length))


```


## 25kb

```{r}
tad_gm12878_25kb <- read.table("Z:/TAD_data_analysis/GM12878/25kb/GM12878_domain_data_25000.b.txt")
tad_gm12878_25kb <- tad_gm12878_25kb[,1:3]

tad_gm12878_25kb <- tad_gm12878_25kb %>%
  group_by(V1) %>%
  mutate(Length = V3-V2)

tad_gm12878_25kb$V1 <- factor(tad_gm12878_25kb$V1, levels = c(1:22))

tad_data_gm12878_25kb <- tad_gm12878_25kb %>% 
  group_by(V1) %>% 
  summarise(Count = length(V1),
            Length = mean(Length))


```


## 50kb

```{r}
tad_gm12878_50kb <- read.table("Z:/TAD_data_analysis/GM12878/50kb/GM12878_domain_data_50000.b.txt")
tad_gm12878_50kb <- tad_gm12878_50kb[,1:3]

tad_gm12878_50kb <- tad_gm12878_50kb %>%
  group_by(V1) %>%
  mutate(Length = V3-V2)

tad_gm12878_50kb$V1 <- factor(tad_gm12878_50kb$V1, levels = c(1:22))

tad_data_gm12878_50kb <- tad_gm12878_50kb %>% 
  group_by(V1) %>% 
  summarise(Count = length(V1),
            Length = mean(Length))


```


## 100kb

```{r}
tad_gm12878_100kb <- read.table("Z:/TAD_data_analysis/GM12878/100kb/GM12878_domain_data_100000.b.txt")
tad_gm12878_100kb <- tad_gm12878_100kb[,1:3]

tad_gm12878_100kb <- tad_gm12878_100kb %>%
  group_by(V1) %>%
  mutate(Length = V3-V2)

tad_gm12878_100kb$V1 <- factor(tad_gm12878_100kb$V1, levels = c(1:22))

tad_data_gm12878_100kb <- tad_gm12878_100kb %>% 
  group_by(V1) %>% 
  summarise(Count = length(V1),
            Length = mean(Length))


```


# K562

## 10kb

```{r}
tad_K562_10kb <- read.table("Z:/TAD_data_analysis/K562/10kb/K562_domain_data_10000.b.txt")
tad_K562_10kb <- tad_K562_10kb[,1:3]

tad_K562_10kb <- tad_K562_10kb %>%
  group_by(V1) %>%
  mutate(Length = V3-V2)

tad_K562_10kb$V1 <- factor(tad_K562_10kb$V1, levels = c(1:22))

tad_data_K562_10kb <- tad_K562_10kb %>% 
  group_by(V1) %>% 
  summarise(Count = length(V1),
            Length = mean(Length))


```


## 25kb

```{r}
tad_K562_25kb <- read.table("Z:/TAD_data_analysis/K562/25kb/K562_domain_data_25000.b.txt")
tad_K562_25kb <- tad_K562_25kb[,1:3]

tad_K562_25kb <- tad_K562_25kb %>%
  group_by(V1) %>%
  mutate(Length = V3-V2)

tad_K562_25kb$V1 <- factor(tad_K562_25kb$V1, levels = c(1:22))

tad_data_K562_25kb <- tad_K562_25kb %>% 
  group_by(V1) %>% 
  summarise(Count = length(V1),
            Length = mean(Length))


```


## 50kb

```{r}
tad_K562_50kb <- read.table("Z:/TAD_data_analysis/K562/50kb/K562_domain_data_50000.b.txt")
tad_K562_50kb <- tad_K562_50kb[,1:3]

tad_K562_50kb <- tad_K562_50kb %>%
  group_by(V1) %>%
  mutate(Length = V3-V2)

tad_K562_50kb$V1 <- factor(tad_K562_50kb$V1, levels = c(1:22))

tad_data_K562_50kb <- tad_K562_50kb %>% 
  group_by(V1) %>% 
  summarise(Count = length(V1),
            Length = mean(Length))


```


## 100kb

```{r}
tad_K562_100kb <- read.table("Z:/TAD_data_analysis/K562/100kb/K562_domain_data_100000.b.txt")
tad_K562_100kb <- tad_K562_100kb[,1:3]

tad_K562_100kb <- tad_K562_100kb %>%
  group_by(V1) %>%
  mutate(Length = V3-V2)

tad_K562_100kb$V1 <- factor(tad_K562_100kb$V1, levels = c(1:22))

tad_data_K562_100kb <- tad_K562_100kb %>% 
  group_by(V1) %>% 
  summarise(Count = length(V1),
            Length = mean(Length))


```

# Tables

```{r}
combined <- rbind.data.frame(tad_data_gm12878_10kb,
                             tad_data_gm12878_25kb,
                             tad_data_gm12878_50kb,
                             tad_data_gm12878_100kb,
                             tad_data_K562_10kb,
                             tad_data_K562_25kb,
                             tad_data_K562_50kb,
                             tad_data_K562_100kb)

combined <- combined[-which(combined$V1==9),]
combined$V1 <- factor(combined$V1)

combined$CL <- c(rep("GM12878", 84), rep("K562", 84))
combined$Resolution <- c(rep("10 kb", 21),
                         rep("25 kb", 21),
                         rep("50 kb", 21),
                         rep("100 kb", 21),
                         rep("10 kb", 21),
                         rep("25 kb", 21),
                         rep("50 kb", 21),
                         rep("100 kb", 21))
combined$CL <- factor(combined$CL)
combined$Resolution <- factor(combined$Resolution, levels=c("10 kb", "25 kb", "50 kb", "100 kb"))

summarytab <- combined %>% 
  group_by(CL, Resolution) %>% 
  summarise(AveNumber = mean(Count),
            SDNumber = sd(Count),
            AveLength = mean(Length),
            SDLength = sd(Length))
summarytab[,3:6] <- round(summarytab[,3:6], 1)
```



