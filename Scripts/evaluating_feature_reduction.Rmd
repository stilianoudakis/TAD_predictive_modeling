---
title: "Evaluating Regularization"
author: "Spiro Stilianoudakis"
date: "March 7, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading Libraries

```{r}
library(GenomicRanges)
library(caret)
library(data.table)
library(gbm)
library(randomForest)
library(glmnet)
library(pROC)
library(dplyr)
library(ggplot2)
library(DMwR)
library(gridExtra)
library(pROC)
library(ROCR)
library(cluster)
library(ggpubr)
library(scales)
library(GGally)
library(VennDiagram)
library(network)
library(sna)
library(gtable)
library(grid)
library(magrittr) 
library(DT)
library(tidyverse)
library(reshape)
library(ROSE)
library(lattice)
library(corrplot)
library(cluster)
library(RColorBrewer)

```

# Evaluating Elastic-Net

##GM12878


```{r}
chromstates <- list.files("Z:/TAD_data_analysis/annotations/BroadHMM")
chromstates <- chromstates[grep("Gm12878", chromstates)]
chromstates <- gsub(paste0(c("Gm12878-", ".bed"), collapse = "|"),"",chromstates)

histones <- list.files("Z:/TAD_data_analysis/annotations/HistoneModifications")
histones <- histones[grep("Gm12878", histones)]
histones <- gsub(paste0(c("Gm12878-", ".bed"), collapse = "|"),"",histones)

tfbs <- list.files("Z:/TAD_data_analysis/annotations/tfbs/cell_type_specific/gm12878")
tfbs <- gsub(paste0(c("Gm12878-", ".bed", "-Haib", "-Sydh", "-Broad", "-Uw", "-Uta", "-Chicago"), collapse = "|"),"", tfbs)
tfbs <- tfbs[!duplicated(tfbs)]

ratio.per.chr <- as.numeric()

for(i in c("10kb", "25kb", "50kb", "100kb")){
  for(j in paste0("CHR", c(1:8,10:22))){
    enetvars <- readRDS(paste0("Z:/TAD_data_analysis/GM12878/",
                                 i,
                                 "/results_by_chr/",
                                 j,
                                 "/smote/distance/enet/enetcoefs.rds"))
        
    enetvars <- gsub("_dist", "", enetvars)
    
    cssratio <- length(intersect(enetvars, chromstates))/length(chromstates)
    hmratio <- length(intersect(enetvars, histones))/length(histones)
    tfbsratio <- length(intersect(enetvars, tfbs))/length(tfbs)
    
    #res.per.chr <- c(res.per.chr, i)
    #ann.per.chr <- c(ann.per.chr, j)
    #chr.per.chr <- c(chr.per.chr, c("CSS", "HM", "TFBS"))
    ratio.per.chr <- c(ratio.per.chr, c(cssratio,hmratio,tfbsratio))
      
  }
}

enet_ratios_gm12878 <- cbind.data.frame(Ratio=ratio.per.chr,
                                        Annotation=rep(c("CSS","HM","TFBS"), 84),
                                        Chromosome=rep(c(rep("CHR1",3),
                                                     rep("CHR2",3),
                                                     rep("CHR3",3),
                                                     rep("CHR4",3),
                                                     rep("CHR5",3),
                                                     rep("CHR6",3),
                                                     rep("CHR7",3),
                                                     rep("CHR8",3),
                                                     rep("CHR10",3),
                                                     rep("CHR11",3),
                                                     rep("CHR12",3),
                                                     rep("CHR13",3),
                                                     rep("CHR14",3),
                                                     rep("CHR15",3),
                                                     rep("CHR16",3),
                                                     rep("CHR17",3),
                                                     rep("CHR18",3),
                                                     rep("CHR19",3),
                                                     rep("CHR20",3),
                                                     rep("CHR21",3),
                                                     rep("CHR22",3)),4),
                                        Resolution=c(rep("10 kb", 21*3),
                                                     rep("25 kb", 21*3),
                                                     rep("50 kb", 21*3),
                                                     rep("100 kb", 21*3)))


enet_ratios_gm12878_summ <- enet_ratios_gm12878 %>%
  group_by(Resolution, Annotation) %>%
  dplyr::summarise(AveRatio = mean(Ratio, na.rm = TRUE),
            AveRatioSD = sd(Ratio, na.rm = TRUE))

```





