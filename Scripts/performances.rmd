---
title: "Performances Code"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading Libraries

```{r}
library(GenomicRanges)
library(caret)
library(data.table)
library(gbm)
library(randomForest)
library(glmnet)
library(pROC)
library(plyr)
library(dplyr)
library(ggplot2)
library(DMwR)
library(gridExtra)
library(pROC)
library(ROCR)
#library(leaps)
library(cluster)
library(ggpubr)
library(scales)
library(GGally)
library(VennDiagram)
library(network)
library(sna)
library(gtable)
library(grid)
library(magrittr) 
library(DT)
library(tidyverse)
library(reshape)
library(ROSE)
library(lattice)

```

# Evaluating Distance Densities
##GM12878
###10kb

```{r}
gm12878_10kb <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/train.rds")

gm12878_10kb_ld <- gm12878_10kb[,c(1,grep("_dist", names(gm12878_10kb)))]

###############
#gm12878_10kb_ld <- gm12878_10kb_ld[,c(1:5)]
###############

gm12878_10kb_d <- gm12878_10kb_ld
gm12878_10kb_d[,-1] <- exp(gm12878_10kb_ld[,-1]) - 1
gm12878_10kb_d$Average_dist <- rowMeans(gm12878_10kb_d[,-1])

gm12878_10kb_ld$Average_dist <- rowMeans(gm12878_10kb_ld[,-1])
names(gm12878_10kb_ld)[-1] <- paste(substr(names(gm12878_10kb_ld)[-1],
                                           1, 
                                           nchar(names(gm12878_10kb_ld)[-1])-4), 
                                    "logdist", 
                                    sep="")

gm12878_10kb_alldist <- cbind.data.frame(gm12878_10kb_d[,-1], gm12878_10kb_ld[,-1])

long10kb <- melt(gm12878_10kb_alldist)
long10kb$variable <- as.character(long10kb$variable)
long10kb$Transformation <- NA
long10kb$Transformation[grep("_logdist", long10kb$variable)] <- rep("Log Distance", length(long10kb$variable[grep("_logdist", long10kb$variable)]))
long10kb$Transformation[grep("_logdist", long10kb$variable, invert = TRUE)] <- rep("Distance", length(long10kb$variable[grep("_logdist", long10kb$variable, invert = TRUE)]))

table(long10kb$Transformation)


distdensity10kb <- ggplot() + 
  geom_density(data=long10kb[intersect(grep("_dist", long10kb$variable), grep("Average", long10kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long10kb[grep("Average_dist", long10kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,2.5e+07) + 
	ylab("")+ 
  scale_x_continuous(limits = c(0,2.5e+07), labels = c("0.0e+00"="0", "5.0e+06"="5", "1e+07"="10", "1.5e+07"="15", "2.0e+07"="20", "2.0e+07"="25"))+
	scale_fill_manual(values="red")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

logdistdensity10kb <- ggplot() + 
  geom_density(data=long10kb[intersect(grep("logdist", long10kb$variable), grep("Average", long10kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long10kb[grep("Average_logdist", long10kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	ylab("")+ 
	scale_fill_manual(values="blue")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

#rescaling nontransformed and combining two plots
long10kb$value[long10kb$Transformation=="Distance"] <- long10kb$value[long10kb$Transformation=="Distance"]/1000000
long10kb <- long10kb[grep("Average", long10kb$variable, invert = TRUE),]
long10kb$variable <- factor(long10kb$variable)
long10kb$Transformation <- factor(long10kb$Transformation)

alldensity10kb <- ggplot(long10kb, aes(x=value, group=variable, fill=Transformation)) + 
  geom_density(alpha=0.01) +
  scale_fill_manual(name = "", labels = c("Untransformed", "Log2"), values = c("red", "blue")) +
  guides(fill = guide_legend(override.aes = list(alpha=1)))+
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	ylab("10 kb")+ 
  ylim(0,.8)+
  ggtitle("GM12878") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
  

```


###25kb

```{r}
gm12878_25kb <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/training_testing/train.rds")

gm12878_25kb_ld <- gm12878_25kb[,c(1,grep("_dist", names(gm12878_25kb)))]

###############
#gm12878_25kb_ld <- gm12878_25kb_ld[,c(1:5)]
###############

gm12878_25kb_d <- gm12878_25kb_ld
gm12878_25kb_d[,-1] <- exp(gm12878_25kb_ld[,-1]) - 1
gm12878_25kb_d$Average_dist <- rowMeans(gm12878_25kb_d[,-1])

gm12878_25kb_ld$Average_dist <- rowMeans(gm12878_25kb_ld[,-1])
names(gm12878_25kb_ld)[-1] <- paste(substr(names(gm12878_25kb_ld)[-1],
                                           1, 
                                           nchar(names(gm12878_25kb_ld)[-1])-4), 
                                    "logdist", 
                                    sep="")

gm12878_25kb_alldist <- cbind.data.frame(gm12878_25kb_d[,-1], gm12878_25kb_ld[,-1])

long25kb <- melt(gm12878_25kb_alldist)
long25kb$variable <- as.character(long25kb$variable)
long25kb$Transformation <- NA
long25kb$Transformation[grep("_logdist", long25kb$variable)] <- rep("Log Distance", length(long25kb$variable[grep("_logdist", long25kb$variable)]))
long25kb$Transformation[grep("_logdist", long25kb$variable, invert = TRUE)] <- rep("Distance", length(long25kb$variable[grep("_logdist", long25kb$variable, invert = TRUE)]))

table(long25kb$Transformation)


distdensity25kb <- ggplot() + 
  geom_density(data=long25kb[intersect(grep("_dist", long25kb$variable), grep("Average", long25kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long25kb[grep("Average_dist", long25kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,2.5e+07) + 
	ylab("")+ 
  scale_x_continuous(limits = c(0,2.5e+07), labels = c("0.0e+00"="0", "5.0e+06"="5", "1e+07"="10", "1.5e+07"="15", "2.0e+07"="20", "2.0e+07"="25"))+
	scale_fill_manual(values="red")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

logdistdensity25kb <- ggplot() + 
  geom_density(data=long25kb[intersect(grep("logdist", long25kb$variable), grep("Average", long25kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long25kb[grep("Average_logdist", long25kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) +  
	ylab("")+ 
	scale_fill_manual(values="blue")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

#rescaling nontransformed and combining two plots
long25kb$value[long25kb$Transformation=="Distance"] <- long25kb$value[long25kb$Transformation=="Distance"]/1000000
long25kb <- long25kb[grep("Average", long25kb$variable, invert = TRUE),]
long25kb$variable <- factor(long25kb$variable)
long25kb$Transformation <- factor(long25kb$Transformation)

alldensity25kb <- ggplot(long25kb, aes(x=value, group=variable, fill=Transformation)) + 
  geom_density(alpha=0.01) +
  scale_fill_manual(name = "", labels = c("Untransformed", "Log2"), values = c("red", "blue")) +
  guides(fill = guide_legend(override.aes = list(alpha=1)))+
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	ylab("25 kb")+ 
  ylim(0,.8)+
  #ggtitle("GM12878") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
  
```

###50kb

```{r}
gm12878_50kb <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/training_testing/train.rds")

gm12878_50kb_ld <- gm12878_50kb[,c(1,grep("_dist", names(gm12878_50kb)))]

###############
#gm12878_50kb_ld <- gm12878_50kb_ld[,c(1:5)]
###############

gm12878_50kb_d <- gm12878_50kb_ld
gm12878_50kb_d[,-1] <- exp(gm12878_50kb_ld[,-1]) - 1
gm12878_50kb_d$Average_dist <- rowMeans(gm12878_50kb_d[,-1])

gm12878_50kb_ld$Average_dist <- rowMeans(gm12878_50kb_ld[,-1])
names(gm12878_50kb_ld)[-1] <- paste(substr(names(gm12878_50kb_ld)[-1],
                                           1, 
                                           nchar(names(gm12878_50kb_ld)[-1])-4), 
                                    "logdist", 
                                    sep="")

gm12878_50kb_alldist <- cbind.data.frame(gm12878_50kb_d[,-1], gm12878_50kb_ld[,-1])

long50kb <- melt(gm12878_50kb_alldist)
long50kb$variable <- as.character(long50kb$variable)
long50kb$Transformation <- NA
long50kb$Transformation[grep("_logdist", long50kb$variable)] <- rep("Log Distance", length(long50kb$variable[grep("_logdist", long50kb$variable)]))
long50kb$Transformation[grep("_logdist", long50kb$variable, invert = TRUE)] <- rep("Distance", length(long50kb$variable[grep("_logdist", long50kb$variable, invert = TRUE)]))

table(long50kb$Transformation)


distdensity50kb <- ggplot() + 
  geom_density(data=long50kb[intersect(grep("_dist", long50kb$variable), grep("Average", long50kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long50kb[grep("Average_dist", long50kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,2.5e+07) + 
	ylab("")+ 
  scale_x_continuous(limits = c(0,2.5e+07), labels = c("0.0e+00"="0", "5.0e+06"="5", "1e+07"="10", "1.5e+07"="15", "2.0e+07"="20", "2.0e+07"="25"))+
	scale_fill_manual(values="red")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

logdistdensity50kb <- ggplot() + 
  geom_density(data=long50kb[intersect(grep("logdist", long50kb$variable), grep("Average", long50kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long50kb[grep("Average_logdist", long50kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	ylab("")+ 
	scale_fill_manual(values="blue")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

#rescaling nontransformed and combining two plots
long50kb$value[long50kb$Transformation=="Distance"] <- long50kb$value[long50kb$Transformation=="Distance"]/1000000
long50kb <- long50kb[grep("Average", long50kb$variable, invert = TRUE),]
long50kb$variable <- factor(long50kb$variable)
long50kb$Transformation <- factor(long50kb$Transformation)

alldensity50kb <- ggplot(long50kb, aes(x=value, group=variable, fill=Transformation)) + 
  geom_density(alpha=0.01) +
  scale_fill_manual(name = "", labels = c("Untransformed", "Log2"), values = c("red", "blue")) +
  guides(fill = guide_legend(override.aes = list(alpha=1)))+
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	ylab("50 kb")+ 
  ylim(0,.8)+
  #ggtitle("GM12878") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
  
```

###100kb

```{r}
gm12878_100kb <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/training_testing/train.rds")

gm12878_100kb_ld <- gm12878_100kb[,c(1,grep("_dist", names(gm12878_100kb)))]

###############
#gm12878_100kb_ld <- gm12878_100kb_ld[,c(1:5)]
###############

gm12878_100kb_d <- gm12878_100kb_ld
gm12878_100kb_d[,-1] <- exp(gm12878_100kb_ld[,-1]) - 1
gm12878_100kb_d$Average_dist <- rowMeans(gm12878_100kb_d[,-1])

gm12878_100kb_ld$Average_dist <- rowMeans(gm12878_100kb_ld[,-1])
names(gm12878_100kb_ld)[-1] <- paste(substr(names(gm12878_100kb_ld)[-1],
                                           1, 
                                           nchar(names(gm12878_100kb_ld)[-1])-4), 
                                    "logdist", 
                                    sep="")

gm12878_100kb_alldist <- cbind.data.frame(gm12878_100kb_d[,-1], gm12878_100kb_ld[,-1])

long100kb <- melt(gm12878_100kb_alldist)
long100kb$variable <- as.character(long100kb$variable)
long100kb$Transformation <- NA
long100kb$Transformation[grep("_logdist", long100kb$variable)] <- rep("Log Distance", length(long100kb$variable[grep("_logdist", long100kb$variable)]))
long100kb$Transformation[grep("_logdist", long100kb$variable, invert = TRUE)] <- rep("Distance", length(long100kb$variable[grep("_logdist", long100kb$variable, invert = TRUE)]))

table(long100kb$Transformation)


distdensity100kb <- ggplot() + 
  geom_density(data=long100kb[intersect(grep("_dist", long100kb$variable), grep("Average", long100kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long100kb[grep("Average_dist", long100kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("No Transformation") + 
	xlim(0,2.5e+07) + 
	ylab("")+ 
  scale_x_continuous(limits = c(0,2.5e+07), labels = c("0.0e+00"="0", "5.0e+06"="5", "1e+07"="10", "1.5e+07"="15", "2.0e+07"="20", "2.0e+07"="25"))+
	scale_fill_manual(values="red")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

logdistdensity100kb <- ggplot() + 
  geom_density(data=long100kb[intersect(grep("logdist", long100kb$variable), grep("Average", long100kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long100kb[grep("Average_logdist", long100kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("Log Tranformation") + 
	xlim(0,25) + 
	ylab("")+ 
	scale_fill_manual(values="blue")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

#rescaling nontransformed and combining two plots
long100kb$value[long100kb$Transformation=="Distance"] <- long100kb$value[long100kb$Transformation=="Distance"]/1000000
long100kb <- long100kb[grep("Average", long100kb$variable, invert = TRUE),]
long100kb$variable <- factor(long100kb$variable)
long100kb$Transformation <- factor(long100kb$Transformation)

alldensity100kb <- ggplot(long100kb, aes(x=value, group=variable, fill=Transformation)) + 
  geom_density(alpha=0.01) +
  scale_fill_manual(name = "", labels = c("Untransformed", "Log2"), values = c("red", "blue")) +
  guides(fill = guide_legend(override.aes = list(alpha=1)))+
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	ylab("100 kb")+ 
  ylim(0,.8)+
  #ggtitle("GM12878") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

```


##K562
###10kb

```{r}
K562_10kb <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/train.rds")

K562_10kb_ld <- K562_10kb[,c(1,grep("_dist", names(K562_10kb)))]

###############
#K562_10kb_ld <- K562_10kb_ld[,c(1:5)]
###############

K562_10kb_d <- K562_10kb_ld
K562_10kb_d[,-1] <- exp(K562_10kb_ld[,-1]) - 1
K562_10kb_d$Average_dist <- rowMeans(K562_10kb_d[,-1])

K562_10kb_ld$Average_dist <- rowMeans(K562_10kb_ld[,-1])
names(K562_10kb_ld)[-1] <- paste(substr(names(K562_10kb_ld)[-1],
                                           1, 
                                           nchar(names(K562_10kb_ld)[-1])-4), 
                                    "logdist", 
                                    sep="")

K562_10kb_alldist <- cbind.data.frame(K562_10kb_d[,-1], K562_10kb_ld[,-1])

long10kb <- melt(K562_10kb_alldist)
long10kb$variable <- as.character(long10kb$variable)
long10kb$Transformation <- NA
long10kb$Transformation[grep("_logdist", long10kb$variable)] <- rep("Log Distance", length(long10kb$variable[grep("_logdist", long10kb$variable)]))
long10kb$Transformation[grep("_logdist", long10kb$variable, invert = TRUE)] <- rep("Distance", length(long10kb$variable[grep("_logdist", long10kb$variable, invert = TRUE)]))

table(long10kb$Transformation)


distdensity10kb <- ggplot() + 
  geom_density(data=long10kb[intersect(grep("_dist", long10kb$variable), grep("Average", long10kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long10kb[grep("Average_dist", long10kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,2.5e+07) + 
	ylab("")+ 
  scale_x_continuous(limits = c(0,2.5e+07), labels = c("0.0e+00"="0", "5.0e+06"="5", "1e+07"="10", "1.5e+07"="15", "2.0e+07"="20", "2.0e+07"="25"))+
	scale_fill_manual(values="red")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

logdistdensity10kb <- ggplot() + 
  geom_density(data=long10kb[intersect(grep("logdist", long10kb$variable), grep("Average", long10kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long10kb[grep("Average_logdist", long10kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	ylab("")+ 
	scale_fill_manual(values="blue")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

#rescaling nontransformed and combining two plots
long10kb$value[long10kb$Transformation=="Distance"] <- long10kb$value[long10kb$Transformation=="Distance"]/1000000
long10kb <- long10kb[grep("Average", long10kb$variable, invert = TRUE),]
long10kb$variable <- factor(long10kb$variable)
long10kb$Transformation <- factor(long10kb$Transformation)

alldensity10kb_k562 <- ggplot(long10kb, aes(x=value, group=variable, fill=Transformation)) + 
  geom_density(alpha=0.01) +
  scale_fill_manual(name = "", labels = c("Untransformed", "Log2"), values = c("red", "blue")) +
  guides(fill = guide_legend(override.aes = list(alpha=1)))+
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	#ylab("10 kb")+ 
  ylim(0,.8)+
  ggtitle("K562") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
  
```


###25kb

```{r}
K562_25kb <- readRDS("Z:/TAD_data_analysis/K562/25kb/training_testing/train.rds")

K562_25kb_ld <- K562_25kb[,c(1,grep("_dist", names(K562_25kb)))]

###############
#K562_25kb_ld <- K562_25kb_ld[,c(1:5)]
###############

K562_25kb_d <- K562_25kb_ld
K562_25kb_d[,-1] <- exp(K562_25kb_ld[,-1]) - 1
K562_25kb_d$Average_dist <- rowMeans(K562_25kb_d[,-1])

K562_25kb_ld$Average_dist <- rowMeans(K562_25kb_ld[,-1])
names(K562_25kb_ld)[-1] <- paste(substr(names(K562_25kb_ld)[-1],
                                           1, 
                                           nchar(names(K562_25kb_ld)[-1])-4), 
                                    "logdist", 
                                    sep="")

K562_25kb_alldist <- cbind.data.frame(K562_25kb_d[,-1], K562_25kb_ld[,-1])

long25kb <- melt(K562_25kb_alldist)
long25kb$variable <- as.character(long25kb$variable)
long25kb$Transformation <- NA
long25kb$Transformation[grep("_logdist", long25kb$variable)] <- rep("Log Distance", length(long25kb$variable[grep("_logdist", long25kb$variable)]))
long25kb$Transformation[grep("_logdist", long25kb$variable, invert = TRUE)] <- rep("Distance", length(long25kb$variable[grep("_logdist", long25kb$variable, invert = TRUE)]))

table(long25kb$Transformation)


distdensity25kb <- ggplot() + 
  geom_density(data=long25kb[intersect(grep("_dist", long25kb$variable), grep("Average", long25kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long25kb[grep("Average_dist", long25kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,2.5e+07) + 
	ylab("")+ 
  scale_x_continuous(limits = c(0,2.5e+07), labels = c("0.0e+00"="0", "5.0e+06"="5", "1e+07"="10", "1.5e+07"="15", "2.0e+07"="20", "2.0e+07"="25"))+
	scale_fill_manual(values="red")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

logdistdensity25kb <- ggplot() + 
  geom_density(data=long25kb[intersect(grep("logdist", long25kb$variable), grep("Average", long25kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long25kb[grep("Average_logdist", long25kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	ylab("")+ 
	scale_fill_manual(values="blue")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

#rescaling nontransformed and combining two plots
long25kb$value[long25kb$Transformation=="Distance"] <- long25kb$value[long25kb$Transformation=="Distance"]/1000000
long25kb <- long25kb[grep("Average", long25kb$variable, invert = TRUE),]
long25kb$variable <- factor(long25kb$variable)
long25kb$Transformation <- factor(long25kb$Transformation)

alldensity25kb_k562 <- ggplot(long25kb, aes(x=value, group=variable, fill=Transformation)) + 
  geom_density(alpha=0.01) +
  scale_fill_manual(name = "", labels = c("Untransformed", "Log2"), values = c("red", "blue")) +
  guides(fill = guide_legend(override.aes = list(alpha=1)))+
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	#ylab("25 kb")+ 
  ylim(0,.8)+
  #ggtitle("K562") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
  
```


###50kb

```{r}
K562_50kb <- readRDS("Z:/TAD_data_analysis/K562/50kb/training_testing/train.rds")

K562_50kb_ld <- K562_50kb[,c(1,grep("_dist", names(K562_50kb)))]

###############
#K562_50kb_ld <- K562_50kb_ld[,c(1:5)]
###############

K562_50kb_d <- K562_50kb_ld
K562_50kb_d[,-1] <- exp(K562_50kb_ld[,-1]) - 1
K562_50kb_d$Average_dist <- rowMeans(K562_50kb_d[,-1])

K562_50kb_ld$Average_dist <- rowMeans(K562_50kb_ld[,-1])
names(K562_50kb_ld)[-1] <- paste(substr(names(K562_50kb_ld)[-1],
                                           1, 
                                           nchar(names(K562_50kb_ld)[-1])-4), 
                                    "logdist", 
                                    sep="")

K562_50kb_alldist <- cbind.data.frame(K562_50kb_d[,-1], K562_50kb_ld[,-1])

long50kb <- melt(K562_50kb_alldist)
long50kb$variable <- as.character(long50kb$variable)
long50kb$Transformation <- NA
long50kb$Transformation[grep("_logdist", long50kb$variable)] <- rep("Log Distance", length(long50kb$variable[grep("_logdist", long50kb$variable)]))
long50kb$Transformation[grep("_logdist", long50kb$variable, invert = TRUE)] <- rep("Distance", length(long50kb$variable[grep("_logdist", long50kb$variable, invert = TRUE)]))

table(long50kb$Transformation)


distdensity50kb <- ggplot() + 
  geom_density(data=long50kb[intersect(grep("_dist", long50kb$variable), grep("Average", long50kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long50kb[grep("Average_dist", long50kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,2.5e+07) + 
	ylab("")+ 
  scale_x_continuous(limits = c(0,2.5e+07), labels = c("0.0e+00"="0", "5.0e+06"="5", "1e+07"="10", "1.5e+07"="15", "2.0e+07"="20", "2.0e+07"="25"))+
	scale_fill_manual(values="red")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

logdistdensity50kb <- ggplot() + 
  geom_density(data=long50kb[intersect(grep("logdist", long50kb$variable), grep("Average", long50kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long50kb[grep("Average_logdist", long50kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	ylab("")+ 
	scale_fill_manual(values="blue")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

#rescaling nontransformed and combining two plots
long50kb$value[long50kb$Transformation=="Distance"] <- long50kb$value[long50kb$Transformation=="Distance"]/1000000
long50kb <- long50kb[grep("Average", long50kb$variable, invert = TRUE),]
long50kb$variable <- factor(long50kb$variable)
long50kb$Transformation <- factor(long50kb$Transformation)

alldensity50kb_k562 <- ggplot(long50kb, aes(x=value, group=variable, fill=Transformation)) + 
  geom_density(alpha=0.01) +
  scale_fill_manual(name = "", labels = c("Untransformed", "Log2"), values = c("red", "blue")) +
  guides(fill = guide_legend(override.aes = list(alpha=1)))+
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	#ylab("50 kb")+ 
  ylim(0,.8)+
  #ggtitle("K562") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
  
```
  

###100kb

```{r}
K562_100kb <- readRDS("Z:/TAD_data_analysis/K562/100kb/training_testing/train.rds")

K562_100kb_ld <- K562_100kb[,c(1,grep("_dist", names(K562_100kb)))]

###############
#K562_100kb_ld <- K562_100kb_ld[,c(1:5)]
###############

K562_100kb_d <- K562_100kb_ld
K562_100kb_d[,-1] <- exp(K562_100kb_ld[,-1]) - 1
K562_100kb_d$Average_dist <- rowMeans(K562_100kb_d[,-1])

K562_100kb_ld$Average_dist <- rowMeans(K562_100kb_ld[,-1])
names(K562_100kb_ld)[-1] <- paste(substr(names(K562_100kb_ld)[-1],
                                           1, 
                                           nchar(names(K562_100kb_ld)[-1])-4), 
                                    "logdist", 
                                    sep="")

K562_100kb_alldist <- cbind.data.frame(K562_100kb_d[,-1], K562_100kb_ld[,-1])

long100kb <- melt(K562_100kb_alldist)
long100kb$variable <- as.character(long100kb$variable)
long100kb$Transformation <- NA
long100kb$Transformation[grep("_logdist", long100kb$variable)] <- rep("Log Distance", length(long100kb$variable[grep("_logdist", long100kb$variable)]))
long100kb$Transformation[grep("_logdist", long100kb$variable, invert = TRUE)] <- rep("Distance", length(long100kb$variable[grep("_logdist", long100kb$variable, invert = TRUE)]))

table(long100kb$Transformation)


distdensity100kb <- ggplot() + 
  geom_density(data=long100kb[intersect(grep("_dist", long100kb$variable), grep("Average", long100kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long100kb[grep("Average_dist", long100kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,2.5e+07) + 
	ylab("")+ 
  scale_x_continuous(limits = c(0,2.5e+07), labels = c("0.0e+00"="0", "5.0e+06"="5", "1e+07"="10", "1.5e+07"="15", "2.0e+07"="20", "2.0e+07"="25"))+
	scale_fill_manual(values="red")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

logdistdensity100kb <- ggplot() + 
  geom_density(data=long100kb[intersect(grep("logdist", long100kb$variable), grep("Average", long100kb$variable, invert = TRUE)),]
               ,aes(x=value, 
                    group=variable, 
                    fill=Transformation), alpha=0.01, size=0.5) +
  #geom_density(data=long100kb[grep("Average_logdist", long100kb$variable),]
  #             ,aes(x=value), size = 1) +
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	ylab("")+ 
	scale_fill_manual(values="blue")+
		#labels=as.character(
		#		unique(
		#			sort(
		#				as.numeric(
		#					substr(as.character(domains$Chromosome),4,nchar(as.character(domains$Chromosome))))))),
		#values=rainbow(22)) +
	theme_minimal() +
  guides(fill=FALSE)+
  theme(axis.text.y = element_blank())
  #theme(axis.line = element_line(color="black", size = .5))

#rescaling nontransformed and combining two plots
long100kb$value[long100kb$Transformation=="Distance"] <- long100kb$value[long100kb$Transformation=="Distance"]/1000000
long100kb <- long100kb[grep("Average", long100kb$variable, invert = TRUE),]
long100kb$variable <- factor(long100kb$variable)
long100kb$Transformation <- factor(long100kb$Transformation)

alldensity100kb_k562 <- ggplot(long100kb, aes(x=value, group=variable, fill=Transformation)) + 
  geom_density(alpha=0.01) +
  scale_fill_manual(name = "", labels = c("Untransformed", "Log2"), values = c("red", "blue")) +
  guides(fill = guide_legend(override.aes = list(alpha=1)))+
  geom_vline(xintercept=0, size=1)+
  geom_hline(yintercept=0, size=1)+
	xlab("") + 
	xlim(0,25) + 
	#ylab("100 kb")+ 
  ylim(0,.8)+
  #ggtitle("K562") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
  
```

##Combined

```{r}
#alldistplots <- grid.arrange(distdensity10kb, logdistdensity10kb,
#             distdensity25kb, logdistdensity25kb,
#             distdensity50kb, logdistdensity50kb,
#             distdensity100kb, logdistdensity100kb, ncol=2, nrow=4)

alldistplots <- ggarrange(alldensity10kb,
                          alldensity10kb_k562,
                          alldensity25kb,
                          alldensity25kb_k562,
                          alldensity50kb,
                          alldensity50kb_k562,
                          alldensity100kb,
                          alldensity100kb_k562, 
          ncol=2, 
          nrow=4,
          #labels = c("A","", "B","", "C","", "D",""),
          legend = "top",
          common.legend = TRUE)

annotate_figure(alldistplots,
                bottom = text_grob("Distance to Nearest TAD Boundary \n (in millions of basepairs)", 
                                color = "black", 
                                face = "bold", 
                                size = 15),
                left = text_grob("Density", 
                                 color = "black",
                                 size = 15,
                                 rot = 90))
```


#Evaluating Imbalance Ratios
##GM12878
###10kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/train.rds")
test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")

set.seed(123)
sampids <- sample(which(train$y=="No"),
                        length(which(train$y=="Yes")),
                        replace = FALSE)
data.rus <- rbind.data.frame(train[which(train$y=="Yes"),],
                           train[sampids,])
		
set.seed(123)		
sampids <- sample(which(train$y=="Yes"),
                        length(which(train$y=="No")),
                        replace = TRUE)
data.ros <- rbind.data.frame(train[which(train$y=="No"),],
                           train[sampids,])
						   
set.seed(123)
data.sm <- SMOTE(y ~ ., 
                     data=train, 
                     perc.over = 100, 
                     perc.under = 200)

names(train)[-1] <- gsub("-","_",names(train)[-1])
data.rose <- ROSE(y ~ ., data=train,seed=1,p=0.5)$data
					 
#set.seed(123)
#n <- 1000
#nr <- nrow(train)
#splitdat <- split(train, rep(1:ceiling(nr/n), each=n, length.out=nr))
#meds <- max(unlist(lapply(splitdat, function(x){length(which(x$y=="Yes"))})))
#medoids <- list(as.numeric(),length(splitdat))
#for(i in 1:length(splitdat)){
#  print(i)
#  data <- splitdat[[i]]
#  majority <- data[which(data$y=="No"),-1]
#  minnum <- length(which(data$y=="Yes"))
# 
#  pam.med <- pam(majority, k = minnum, diss = FALSE,
#                 metric = "manhattan", 
#                 #medoids = NULL, 
#                 #stand = FALSE, 
#                 cluster.only = FALSE,
#                 do.swap = TRUE,
#                 keep.diss = FALSE,
#                 keep.data = FALSE,
#                 pamonce = FALSE, trace.lev = 2)
#  
#  medoids[[i]] <- as.numeric(rownames(pam.med$medoids))
#  
#}
#medoids <- unlist(medoids)
#data.km <- rbind.data.frame(train[which(as.numeric(rownames(train)) %in% medoids),],
#                               train[which(train$y=="Yes"),])

x10 <- data.frame(IR = c((length(train$y[which(train$y=="Yes")])+length(test$y[which(test$y=="Yes")]))/(length(train$y[which(train$y=="No")])+length(test$y[which(test$y=="No")])), 
					  length(train$y[which(train$y=="Yes")])/length(train$y[which(train$y=="No")]),
					  length(test$y[which(test$y=="Yes")])/length(test$y[which(test$y=="No")]),
					  length(data.rus$y[which(data.rus$y=="Yes")])/length(data.rus$y[which(data.rus$y=="No")]),
					  length(data.ros$y[which(data.ros$y=="Yes")])/length(data.ros$y[which(data.ros$y=="No")]),
					  length(data.sm$y[which(data.sm$y=="Yes")])/length(data.sm$y[which(data.sm$y=="No")]),
					  length(data.rose$y[which(data.rose$y=="Yes")])/length(data.rose$y[which(data.rose$y=="No")])),
					  #length(data.km$y[which(data.km$y=="No")]), 
					  #length(data.km$y[which(data.km$y=="Yes")])),
			    CB = c("Complete",
					   "Train",
					   "Test",
					   "Under-Sampling",
					   "Over-Sampling",
					   "SMOTE",
					   "ROSE"))

p10kb <- ggplot(x10, aes(y=IR, x=factor(CB, levels = unique(x10$CB)))) + 
  geom_bar( stat="identity") +
  ylab("Imbalance Ratio")+
  xlab("")+
  #ylim(0, 30000)+
  theme_bw() +
  #guides(fill=FALSE)+
  theme(axis.text.x = element_text(size=15, 
                                   angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        #axis.title.x = element_text(size = 15),
        axis.title.y = element_text(size = 15)) 

```		

###25kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/training_testing/train.rds")
test <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/training_testing/test.rds")

set.seed(123)
sampids <- sample(which(train$y=="No"),
                        length(which(train$y=="Yes")),
                        replace = FALSE)
data.rus <- rbind.data.frame(train[which(train$y=="Yes"),],
                           train[sampids,])
		
set.seed(123)		
sampids <- sample(which(train$y=="Yes"),
                        length(which(train$y=="No")),
                        replace = TRUE)
data.ros <- rbind.data.frame(train[which(train$y=="No"),],
                           train[sampids,])
						   
set.seed(123)
data.sm <- SMOTE(y ~ ., 
                     data=train, 
                     perc.over = 100, 
                     perc.under = 200)

names(train)[-1] <- gsub("-","_",names(train)[-1])
data.rose <- ROSE(y ~ ., data=train,seed=1,p=0.5)$data
					 
#set.seed(123)
#n <- 1000
#nr <- nrow(train)
#splitdat <- split(train, rep(1:ceiling(nr/n), each=n, length.out=nr))
#meds <- max(unlist(lapply(splitdat, function(x){length(which(x$y=="Yes"))})))
#medoids <- list(as.numeric(),length(splitdat))
#for(i in 1:length(splitdat)){
#  print(i)
#  data <- splitdat[[i]]
#  majority <- data[which(data$y=="No"),-1]
#  minnum <- length(which(data$y=="Yes"))
# 
#  pam.med <- pam(majority, k = minnum, diss = FALSE,
#                 metric = "manhattan", 
#                 #medoids = NULL, 
#                 #stand = FALSE, 
#                 cluster.only = FALSE,
#                 do.swap = TRUE,
#                 keep.diss = FALSE,
#                 keep.data = FALSE,
#                 pamonce = FALSE, trace.lev = 2)
#  
#  medoids[[i]] <- as.numeric(rownames(pam.med$medoids))
#  
#}
#medoids <- unlist(medoids)
#data.km <- rbind.data.frame(train[which(as.numeric(rownames(train)) %in% medoids),],
#                               train[which(train$y=="Yes"),])

x25 <- data.frame(IR = c((length(train$y[which(train$y=="Yes")])+length(test$y[which(test$y=="Yes")]))/(length(train$y[which(train$y=="No")])+length(test$y[which(test$y=="No")])), 
					  length(train$y[which(train$y=="Yes")])/length(train$y[which(train$y=="No")]),
					  length(test$y[which(test$y=="Yes")])/length(test$y[which(test$y=="No")]),
					  length(data.rus$y[which(data.rus$y=="Yes")])/length(data.rus$y[which(data.rus$y=="No")]),
					  length(data.ros$y[which(data.ros$y=="Yes")])/length(data.ros$y[which(data.ros$y=="No")]),
					  length(data.sm$y[which(data.sm$y=="Yes")])/length(data.sm$y[which(data.sm$y=="No")]),
					  length(data.rose$y[which(data.rose$y=="Yes")])/length(data.rose$y[which(data.rose$y=="No")])),
					  #length(data.km$y[which(data.km$y=="No")]), 
					  #length(data.km$y[which(data.km$y=="Yes")])),
			    CB = c("Complete",
					   "Train",
					   "Test",
					   "Under-Sampling",
					   "Over-Sampling",
					   "SMOTE",
					   "ROSE"))

p25kb <- ggplot(x25, aes(y=IR, x=factor(CB, levels = unique(x25$CB)))) + 
  geom_bar( stat="identity") +
  ylab("Imbalance Ratio")+
  xlab("")+
  #ylim(0, 30000)+
  theme_bw() +
  #guides(fill=FALSE)+
  theme(axis.text.x = element_text(size=15, 
                                   angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        #axis.title.x = element_text(size = 15),
        axis.title.y = element_text(size = 15)) 

```		

###50kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/training_testing/train.rds")
test <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/training_testing/test.rds")

set.seed(123)
sampids <- sample(which(train$y=="No"),
                        length(which(train$y=="Yes")),
                        replace = FALSE)
data.rus <- rbind.data.frame(train[which(train$y=="Yes"),],
                           train[sampids,])
		
set.seed(123)		
sampids <- sample(which(train$y=="Yes"),
                        length(which(train$y=="No")),
                        replace = TRUE)
data.ros <- rbind.data.frame(train[which(train$y=="No"),],
                           train[sampids,])
						   
set.seed(123)
data.sm <- SMOTE(y ~ ., 
                     data=train, 
                     perc.over = 100, 
                     perc.under = 200)

names(train)[-1] <- gsub("-","_",names(train)[-1])
data.rose <- ROSE(y ~ ., data=train,seed=1,p=0.5)$data
					 
#set.seed(123)
#n <- 1000
#nr <- nrow(train)
#splitdat <- split(train, rep(1:ceiling(nr/n), each=n, length.out=nr))
#meds <- max(unlist(lapply(splitdat, function(x){length(which(x$y=="Yes"))})))
#medoids <- list(as.numeric(),length(splitdat))
#for(i in 1:length(splitdat)){
#  print(i)
#  data <- splitdat[[i]]
#  majority <- data[which(data$y=="No"),-1]
#  minnum <- length(which(data$y=="Yes"))
# 
#  pam.med <- pam(majority, k = minnum, diss = FALSE,
#                 metric = "manhattan", 
#                 #medoids = NULL, 
#                 #stand = FALSE, 
#                 cluster.only = FALSE,
#                 do.swap = TRUE,
#                 keep.diss = FALSE,
#                 keep.data = FALSE,
#                 pamonce = FALSE, trace.lev = 2)
#  
#  medoids[[i]] <- as.numeric(rownames(pam.med$medoids))
#  
#}
#medoids <- unlist(medoids)
#data.km <- rbind.data.frame(train[which(as.numeric(rownames(train)) %in% medoids),],
#                               train[which(train$y=="Yes"),])

x50 <- data.frame(IR = c((length(train$y[which(train$y=="Yes")])+length(test$y[which(test$y=="Yes")]))/(length(train$y[which(train$y=="No")])+length(test$y[which(test$y=="No")])), 
					  length(train$y[which(train$y=="Yes")])/length(train$y[which(train$y=="No")]),
					  length(test$y[which(test$y=="Yes")])/length(test$y[which(test$y=="No")]),
					  length(data.rus$y[which(data.rus$y=="Yes")])/length(data.rus$y[which(data.rus$y=="No")]),
					  length(data.ros$y[which(data.ros$y=="Yes")])/length(data.ros$y[which(data.ros$y=="No")]),
					  length(data.sm$y[which(data.sm$y=="Yes")])/length(data.sm$y[which(data.sm$y=="No")]),
					  length(data.rose$y[which(data.rose$y=="Yes")])/length(data.rose$y[which(data.rose$y=="No")])),
					  #length(data.km$y[which(data.km$y=="No")]), 
					  #length(data.km$y[which(data.km$y=="Yes")])),
			    CB = c("Complete",
					   "Train",
					   "Test",
					   "Under-Sampling",
					   "Over-Sampling",
					   "SMOTE",
					   "ROSE"))

p50kb <- ggplot(x50, aes(y=IR, x=factor(CB, levels = unique(x50$CB)))) + 
  geom_bar( stat="identity") +
  ylab("Imbalance Ratio")+
  xlab("")+
  #ylim(0, 30000)+
  theme_bw() +
  #guides(fill=FALSE)+
  theme(axis.text.x = element_text(size=15, 
                                   angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        #axis.title.x = element_text(size = 15),
        axis.title.y = element_text(size = 15)) 

```		

###100kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/training_testing/train.rds")
test <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/training_testing/test.rds")

set.seed(123)
sampids <- sample(which(train$y=="No"),
                        length(which(train$y=="Yes")),
                        replace = FALSE)
data.rus <- rbind.data.frame(train[which(train$y=="Yes"),],
                           train[sampids,])
		
set.seed(123)		
sampids <- sample(which(train$y=="Yes"),
                        length(which(train$y=="No")),
                        replace = TRUE)
data.ros <- rbind.data.frame(train[which(train$y=="No"),],
                           train[sampids,])
						   
set.seed(123)
data.sm <- SMOTE(y ~ ., 
                     data=train, 
                     perc.over = 100, 
                     perc.under = 200)

names(train)[-1] <- gsub("-","_",names(train)[-1])
data.rose <- ROSE(y ~ ., data=train,seed=1,p=0.5)$data
					 
#set.seed(123)
#n <- 1000
#nr <- nrow(train)
#splitdat <- split(train, rep(1:ceiling(nr/n), each=n, length.out=nr))
#meds <- max(unlist(lapply(splitdat, function(x){length(which(x$y=="Yes"))})))
#medoids <- list(as.numeric(),length(splitdat))
#for(i in 1:length(splitdat)){
#  print(i)
#  data <- splitdat[[i]]
#  majority <- data[which(data$y=="No"),-1]
#  minnum <- length(which(data$y=="Yes"))
# 
#  pam.med <- pam(majority, k = minnum, diss = FALSE,
#                 metric = "manhattan", 
#                 #medoids = NULL, 
#                 #stand = FALSE, 
#                 cluster.only = FALSE,
#                 do.swap = TRUE,
#                 keep.diss = FALSE,
#                 keep.data = FALSE,
#                 pamonce = FALSE, trace.lev = 2)
#  
#  medoids[[i]] <- as.numeric(rownames(pam.med$medoids))
#  
#}
#medoids <- unlist(medoids)
#data.km <- rbind.data.frame(train[which(as.numeric(rownames(train)) %in% medoids),],
#                               train[which(train$y=="Yes"),])

x100 <- data.frame(IR = c((length(train$y[which(train$y=="Yes")])+length(test$y[which(test$y=="Yes")]))/(length(train$y[which(train$y=="No")])+length(test$y[which(test$y=="No")])), 
					  length(train$y[which(train$y=="Yes")])/length(train$y[which(train$y=="No")]),
					  length(test$y[which(test$y=="Yes")])/length(test$y[which(test$y=="No")]),
					  length(data.rus$y[which(data.rus$y=="Yes")])/length(data.rus$y[which(data.rus$y=="No")]),
					  length(data.ros$y[which(data.ros$y=="Yes")])/length(data.ros$y[which(data.ros$y=="No")]),
					  length(data.sm$y[which(data.sm$y=="Yes")])/length(data.sm$y[which(data.sm$y=="No")]),
					  length(data.rose$y[which(data.rose$y=="Yes")])/length(data.rose$y[which(data.rose$y=="No")])),
					  #length(data.km$y[which(data.km$y=="No")]), 
					  #length(data.km$y[which(data.km$y=="Yes")])),
			    CB = c("Complete",
					   "Train",
					   "Test",
					   "Under-Sampling",
					   "Over-Sampling",
					   "SMOTE",
					   "ROSE"))

p100kb <- ggplot(x100, aes(y=IR, x=factor(CB, levels = unique(x100$CB)))) + 
  geom_bar( stat="identity") +
  ylab("Imbalance Ratio")+
  xlab("")+
  #ylim(0, 30000)+
  theme_bw() +
  #guides(fill=FALSE)+
  theme(axis.text.x = element_text(size=15, 
                                   angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        #axis.title.x = element_text(size = 15),
        axis.title.y = element_text(size = 15)) 

```		

##K562
###10kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/train.rds")
test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")

set.seed(123)
sampids <- sample(which(train$y=="No"),
                        length(which(train$y=="Yes")),
                        replace = FALSE)
data.rus <- rbind.data.frame(train[which(train$y=="Yes"),],
                           train[sampids,])
		
set.seed(123)		
sampids <- sample(which(train$y=="Yes"),
                        length(which(train$y=="No")),
                        replace = TRUE)
data.ros <- rbind.data.frame(train[which(train$y=="No"),],
                           train[sampids,])
						   
set.seed(123)
data.sm <- SMOTE(y ~ ., 
                     data=train, 
                     perc.over = 100, 
                     perc.under = 200)

names(train)[-1] <- gsub("-","_",names(train)[-1])
data.rose <- ROSE(y ~ ., data=train,seed=1,p=0.5)$data
					 
#set.seed(123)
#n <- 1000
#nr <- nrow(train)
#splitdat <- split(train, rep(1:ceiling(nr/n), each=n, length.out=nr))
#meds <- max(unlist(lapply(splitdat, function(x){length(which(x$y=="Yes"))})))
#medoids <- list(as.numeric(),length(splitdat))
#for(i in 1:length(splitdat)){
#  print(i)
#  data <- splitdat[[i]]
#  majority <- data[which(data$y=="No"),-1]
#  minnum <- length(which(data$y=="Yes"))
# 
#  pam.med <- pam(majority, k = minnum, diss = FALSE,
#                 metric = "manhattan", 
#                 #medoids = NULL, 
#                 #stand = FALSE, 
#                 cluster.only = FALSE,
#                 do.swap = TRUE,
#                 keep.diss = FALSE,
#                 keep.data = FALSE,
#                 pamonce = FALSE, trace.lev = 2)
#  
#  medoids[[i]] <- as.numeric(rownames(pam.med$medoids))
#  
#}
#medoids <- unlist(medoids)
#data.km <- rbind.data.frame(train[which(as.numeric(rownames(train)) %in% medoids),],
#                               train[which(train$y=="Yes"),])

x10_k562 <- data.frame(IR = c((length(train$y[which(train$y=="Yes")])+length(test$y[which(test$y=="Yes")]))/(length(train$y[which(train$y=="No")])+length(test$y[which(test$y=="No")])), 
					  length(train$y[which(train$y=="Yes")])/length(train$y[which(train$y=="No")]),
					  length(test$y[which(test$y=="Yes")])/length(test$y[which(test$y=="No")]),
					  length(data.rus$y[which(data.rus$y=="Yes")])/length(data.rus$y[which(data.rus$y=="No")]),
					  length(data.ros$y[which(data.ros$y=="Yes")])/length(data.ros$y[which(data.ros$y=="No")]),
					  length(data.sm$y[which(data.sm$y=="Yes")])/length(data.sm$y[which(data.sm$y=="No")]),
					  length(data.rose$y[which(data.rose$y=="Yes")])/length(data.rose$y[which(data.rose$y=="No")])),
					  #length(data.km$y[which(data.km$y=="No")]), 
					  #length(data.km$y[which(data.km$y=="Yes")])),
			    CB = c("Complete",
					   "Train",
					   "Test",
					   "Under-Sampling",
					   "Over-Sampling",
					   "SMOTE",
					   "ROSE"))

p10kb_k562 <- ggplot(x10_k562, aes(y=IR, x=factor(CB, levels = unique(x10_k562$CB)))) + 
  geom_bar( stat="identity") +
  ylab("Imbalance Ratio")+
  xlab("")+
  #ylim(0, 30000)+
  theme_bw() +
  #guides(fill=FALSE)+
  theme(axis.text.x = element_text(size=15, 
                                   angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        #axis.title.x = element_text(size = 15),
        axis.title.y = element_text(size = 15)) 

```


###25kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/K562/25kb/training_testing/train.rds")
test <- readRDS("Z:/TAD_data_analysis/K562/25kb/training_testing/test.rds")

set.seed(123)
sampids <- sample(which(train$y=="No"),
                        length(which(train$y=="Yes")),
                        replace = FALSE)
data.rus <- rbind.data.frame(train[which(train$y=="Yes"),],
                           train[sampids,])
		
set.seed(123)		
sampids <- sample(which(train$y=="Yes"),
                        length(which(train$y=="No")),
                        replace = TRUE)
data.ros <- rbind.data.frame(train[which(train$y=="No"),],
                           train[sampids,])
						   
set.seed(123)
data.sm <- SMOTE(y ~ ., 
                     data=train, 
                     perc.over = 100, 
                     perc.under = 200)

names(train)[-1] <- gsub("-","_",names(train)[-1])
data.rose <- ROSE(y ~ ., data=train,seed=1,p=0.5)$data
					 
#set.seed(123)
#n <- 1000
#nr <- nrow(train)
#splitdat <- split(train, rep(1:ceiling(nr/n), each=n, length.out=nr))
#meds <- max(unlist(lapply(splitdat, function(x){length(which(x$y=="Yes"))})))
#medoids <- list(as.numeric(),length(splitdat))
#for(i in 1:length(splitdat)){
#  print(i)
#  data <- splitdat[[i]]
#  majority <- data[which(data$y=="No"),-1]
#  minnum <- length(which(data$y=="Yes"))
# 
#  pam.med <- pam(majority, k = minnum, diss = FALSE,
#                 metric = "manhattan", 
#                 #medoids = NULL, 
#                 #stand = FALSE, 
#                 cluster.only = FALSE,
#                 do.swap = TRUE,
#                 keep.diss = FALSE,
#                 keep.data = FALSE,
#                 pamonce = FALSE, trace.lev = 2)
#  
#  medoids[[i]] <- as.numeric(rownames(pam.med$medoids))
#  
#}
#medoids <- unlist(medoids)
#data.km <- rbind.data.frame(train[which(as.numeric(rownames(train)) %in% medoids),],
#                               train[which(train$y=="Yes"),])

x25_k562 <- data.frame(IR = c((length(train$y[which(train$y=="Yes")])+length(test$y[which(test$y=="Yes")]))/(length(train$y[which(train$y=="No")])+length(test$y[which(test$y=="No")])), 
					  length(train$y[which(train$y=="Yes")])/length(train$y[which(train$y=="No")]),
					  length(test$y[which(test$y=="Yes")])/length(test$y[which(test$y=="No")]),
					  length(data.rus$y[which(data.rus$y=="Yes")])/length(data.rus$y[which(data.rus$y=="No")]),
					  length(data.ros$y[which(data.ros$y=="Yes")])/length(data.ros$y[which(data.ros$y=="No")]),
					  length(data.sm$y[which(data.sm$y=="Yes")])/length(data.sm$y[which(data.sm$y=="No")]),
					  length(data.rose$y[which(data.rose$y=="Yes")])/length(data.rose$y[which(data.rose$y=="No")])),
					  #length(data.km$y[which(data.km$y=="No")]), 
					  #length(data.km$y[which(data.km$y=="Yes")])),
			    CB = c("Complete",
					   "Train",
					   "Test",
					   "Under-Sampling",
					   "Over-Sampling",
					   "SMOTE",
					   "ROSE"))

p25kb_k562 <- ggplot(x25_k562, aes(y=IR, x=factor(CB, levels = unique(x25_k562$CB)))) + 
  geom_bar( stat="identity") +
  ylab("Imbalance Ratio")+
  xlab("")+
  #ylim(0, 30000)+
  theme_bw() +
  #guides(fill=FALSE)+
  theme(axis.text.x = element_text(size=15, 
                                   angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        #axis.title.x = element_text(size = 15),
        axis.title.y = element_text(size = 15)) 

```


###50kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/K562/50kb/training_testing/train.rds")
test <- readRDS("Z:/TAD_data_analysis/K562/50kb/training_testing/test.rds")

set.seed(123)
sampids <- sample(which(train$y=="No"),
                        length(which(train$y=="Yes")),
                        replace = FALSE)
data.rus <- rbind.data.frame(train[which(train$y=="Yes"),],
                           train[sampids,])
		
set.seed(123)		
sampids <- sample(which(train$y=="Yes"),
                        length(which(train$y=="No")),
                        replace = TRUE)
data.ros <- rbind.data.frame(train[which(train$y=="No"),],
                           train[sampids,])
						   
set.seed(123)
data.sm <- SMOTE(y ~ ., 
                     data=train, 
                     perc.over = 100, 
                     perc.under = 200)

names(train)[-1] <- gsub("-","_",names(train)[-1])
data.rose <- ROSE(y ~ ., data=train,seed=1,p=0.5)$data
					 
#set.seed(123)
#n <- 1000
#nr <- nrow(train)
#splitdat <- split(train, rep(1:ceiling(nr/n), each=n, length.out=nr))
#meds <- max(unlist(lapply(splitdat, function(x){length(which(x$y=="Yes"))})))
#medoids <- list(as.numeric(),length(splitdat))
#for(i in 1:length(splitdat)){
#  print(i)
#  data <- splitdat[[i]]
#  majority <- data[which(data$y=="No"),-1]
#  minnum <- length(which(data$y=="Yes"))
# 
#  pam.med <- pam(majority, k = minnum, diss = FALSE,
#                 metric = "manhattan", 
#                 #medoids = NULL, 
#                 #stand = FALSE, 
#                 cluster.only = FALSE,
#                 do.swap = TRUE,
#                 keep.diss = FALSE,
#                 keep.data = FALSE,
#                 pamonce = FALSE, trace.lev = 2)
#  
#  medoids[[i]] <- as.numeric(rownames(pam.med$medoids))
#  
#}
#medoids <- unlist(medoids)
#data.km <- rbind.data.frame(train[which(as.numeric(rownames(train)) %in% medoids),],
#                               train[which(train$y=="Yes"),])

x50_k562 <- data.frame(IR = c((length(train$y[which(train$y=="Yes")])+length(test$y[which(test$y=="Yes")]))/(length(train$y[which(train$y=="No")])+length(test$y[which(test$y=="No")])), 
					  length(train$y[which(train$y=="Yes")])/length(train$y[which(train$y=="No")]),
					  length(test$y[which(test$y=="Yes")])/length(test$y[which(test$y=="No")]),
					  length(data.rus$y[which(data.rus$y=="Yes")])/length(data.rus$y[which(data.rus$y=="No")]),
					  length(data.ros$y[which(data.ros$y=="Yes")])/length(data.ros$y[which(data.ros$y=="No")]),
					  length(data.sm$y[which(data.sm$y=="Yes")])/length(data.sm$y[which(data.sm$y=="No")]),
					  length(data.rose$y[which(data.rose$y=="Yes")])/length(data.rose$y[which(data.rose$y=="No")])),
					  #length(data.km$y[which(data.km$y=="No")]), 
					  #length(data.km$y[which(data.km$y=="Yes")])),
			    CB = c("Complete",
					   "Train",
					   "Test",
					   "Under-Sampling",
					   "Over-Sampling",
					   "SMOTE",
					   "ROSE"))

p50kb_k562 <- ggplot(x50_k562, aes(y=IR, x=factor(CB, levels = unique(x50_k562$CB)))) + 
  geom_bar( stat="identity") +
  ylab("Imbalance Ratio")+
  xlab("")+
  #ylim(0, 30000)+
  theme_bw() +
  #guides(fill=FALSE)+
  theme(axis.text.x = element_text(size=15, 
                                   angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        #axis.title.x = element_text(size = 15),
        axis.title.y = element_text(size = 15)) 

```


###100kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/K562/100kb/training_testing/train.rds")
test <- readRDS("Z:/TAD_data_analysis/K562/100kb/training_testing/test.rds")

set.seed(123)
sampids <- sample(which(train$y=="No"),
                        length(which(train$y=="Yes")),
                        replace = FALSE)
data.rus <- rbind.data.frame(train[which(train$y=="Yes"),],
                           train[sampids,])
		
set.seed(123)		
sampids <- sample(which(train$y=="Yes"),
                        length(which(train$y=="No")),
                        replace = TRUE)
data.ros <- rbind.data.frame(train[which(train$y=="No"),],
                           train[sampids,])
						   
set.seed(123)
data.sm <- SMOTE(y ~ ., 
                     data=train, 
                     perc.over = 100, 
                     perc.under = 200)

names(train)[-1] <- gsub("-","_",names(train)[-1])
data.rose <- ROSE(y ~ ., data=train,seed=1,p=0.5)$data
					 
#set.seed(123)
#n <- 1000
#nr <- nrow(train)
#splitdat <- split(train, rep(1:ceiling(nr/n), each=n, length.out=nr))
#meds <- max(unlist(lapply(splitdat, function(x){length(which(x$y=="Yes"))})))
#medoids <- list(as.numeric(),length(splitdat))
#for(i in 1:length(splitdat)){
#  print(i)
#  data <- splitdat[[i]]
#  majority <- data[which(data$y=="No"),-1]
#  minnum <- length(which(data$y=="Yes"))
# 
#  pam.med <- pam(majority, k = minnum, diss = FALSE,
#                 metric = "manhattan", 
#                 #medoids = NULL, 
#                 #stand = FALSE, 
#                 cluster.only = FALSE,
#                 do.swap = TRUE,
#                 keep.diss = FALSE,
#                 keep.data = FALSE,
#                 pamonce = FALSE, trace.lev = 2)
#  
#  medoids[[i]] <- as.numeric(rownames(pam.med$medoids))
#  
#}
#medoids <- unlist(medoids)
#data.km <- rbind.data.frame(train[which(as.numeric(rownames(train)) %in% medoids),],
#                               train[which(train$y=="Yes"),])

x100_k562 <- data.frame(IR = c((length(train$y[which(train$y=="Yes")])+length(test$y[which(test$y=="Yes")]))/(length(train$y[which(train$y=="No")])+length(test$y[which(test$y=="No")])), 
					  length(train$y[which(train$y=="Yes")])/length(train$y[which(train$y=="No")]),
					  length(test$y[which(test$y=="Yes")])/length(test$y[which(test$y=="No")]),
					  length(data.rus$y[which(data.rus$y=="Yes")])/length(data.rus$y[which(data.rus$y=="No")]),
					  length(data.ros$y[which(data.ros$y=="Yes")])/length(data.ros$y[which(data.ros$y=="No")]),
					  length(data.sm$y[which(data.sm$y=="Yes")])/length(data.sm$y[which(data.sm$y=="No")]),
					  length(data.rose$y[which(data.rose$y=="Yes")])/length(data.rose$y[which(data.rose$y=="No")])),
					  #length(data.km$y[which(data.km$y=="No")]), 
					  #length(data.km$y[which(data.km$y=="Yes")])),
			    CB = c("Complete",
					   "Train",
					   "Test",
					   "Under-Sampling",
					   "Over-Sampling",
					   "SMOTE",
					   "ROSE"))

p100kb_k562 <- ggplot(x100_k562, aes(y=IR, x=factor(CB, levels = unique(x100_k562$CB)))) + 
  geom_bar( stat="identity") +
  ylab("Imbalance Ratio")+
  xlab("")+
  #ylim(0, 30000)+
  theme_bw() +
  #guides(fill=FALSE)+
  theme(axis.text.x = element_text(size=15, 
                                   angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        #axis.title.x = element_text(size = 15),
        axis.title.y = element_text(size = 15)) 

```


##Combined
```{r}

IR=c(x10$IR[x10$CB=="Complete"],
                              x25$IR[x25$CB=="Complete"],
                              x50$IR[x50$CB=="Complete"],
                              x100$IR[x100$CB=="Complete"],
                              x10_k562$IR[x10_k562$CB=="Complete"], 
                              x25_k562$IR[x25_k562$CB=="Complete"],
                              x50_k562$IR[x50_k562$CB=="Complete"],
                              x100_k562$IR[x100_k562$CB=="Complete"])
CL <- c(rep("GM12878", 4), 
                  rep("K562", 4))
Resolution <- c(rep(c("10 kb", "25 kb", "50 kb", "100 kb"), 2))

allirdata <- cbind.data.frame(IR, CL, Resolution)
allirdata$CL <- factor(allirdata$CL, levels=c("GM12878", "K562"))
allirdata$Resolution <- factor(allirdata$Resolution, c("10 kb", "25 kb", "50 kb", "100 kb"))


allirplots <- ggplot(allirdata, aes(x = Resolution, y = IR,fill = CL)) + 
  geom_bar(position = "dodge", stat="identity") + 
  ylab("Imbalance Ratio") +
  xlab("Resolution") +
  #scale_fill_manual(name="Cell Line", values=c("red", "blue"))+
  labs(fill="Cell Line")+
  theme_bw() +
  #guides(fill=FALSE)+
  theme(axis.text.x = element_text(size=10),
        axis.text.y = element_text(size = 10),
        axis.title.x = element_text(size = 15),
        axis.title.y = element_text(size = 15),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))


```


#Feature Engineering

## Exploring Correlations

###GM12878

####10kb

```{r}

train <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/train.rds")

binswtad <- train[which(train$y=="Yes"),]
binswtad <- binswtad[,grep("count", names(binswtad))]

names(binswtad) <- gsub(paste(c("Gm12878",
                          "-",
                          "_",
                          "count",
                          "Haib",
                          "Sydh",
                          "Uta",
                          "Uw",
                          "Broad",
                          "Uchicago"), collapse = "|"),"", names(binswtad))


cormat <- cor(binswtad)

get_upper_tri <- function(cormat){
    cormat[lower.tri(cormat)]<- NA
    return(cormat)
}

upper_tri <- get_upper_tri(cormat)

melted_cormat <- melt(upper_tri, na.rm = TRUE)

reorder_cormat <- function(cormat){
# Use correlation between variables as distance
dd <- as.dist((1-cormat)/2)
hc <- hclust(dd)
cormat <-cormat[hc$order, hc$order]
}

cormat_reorder <- reorder_cormat(cormat)

upper_tri_reorder <- get_upper_tri(cormat_reorder)

melted_cormat_reorder <- melt(upper_tri_reorder, na.rm = TRUE)

corplot_gm12878_10kb <- ggplot(data = melted_cormat_reorder, aes(Var2, Var1, fill = value))+
 geom_tile(color = "white")+
 scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
   midpoint = 0, limit = c(-1,1), space = "Lab", 
   name="Pearson\nCorrelation") +
 ylab("") +
 xlab("") +  
 theme_minimal()+ 
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
    size = 10, hjust = 1),
       axis.text.y = element_text(size = 10))
 #coord_fixed()

pvals <- rcorr(as.matrix(binswtad))$P
upper_tri_pvals <- get_upper_tri(pvals) 
melted_pvals <- melt(upper_tri_pvals, na.rm = TRUE)
melted_cormat2 <- melted_cormat[-which(melted_cormat$value==1.00000000),]
melted_cormat2$pvals <- melted_pvals$value

#find significant correlations
sigcorrs_gm12878_10kb <- melted_cormat2[which(melted_cormat2$pvals<=.05),]
dim(sigcorrs_gm12878_10kb) #4595    4
sigcorrs_gm12878_10kb[,3:4] <- round(sigcorrs_gm12878_10kb[,3:4], 4)
sigcorrs_gm12878_10kb <- sigcorrs_gm12878_10kb[order(sigcorrs_gm12878_10kb$pvals, decreasing = FALSE),]

highcorrs_gm12878_10kb <- melted_cormat2[which(melted_cormat2$value > 0.70 | melted_cormat2$value < (-0.70)),] 
dim(highcorrs_gm12878_10kb) #21  4
highcorrs_gm12878_10kb[,3:4] <- round(highcorrs_gm12878_10kb[,3:4], 2)
highcorrs_gm12878_10kb <- highcorrs_gm12878_10kb[order(abs(highcorrs_gm12878_10kb$value), decreasing = TRUE),]


#clustered heatmap
clustcorplot_gm12878_10kb <- heatmap.2(cormat,
          #cellnote = cormat,  # same data set for cell labels
          main = "Correlation", # heat map title
          notecol="black",      # change font color of cell labels to black
          density.info="none",  # turns off density plot inside color legend
          trace="none",         # turns off trace lines inside the heat map
          margins =c(12,9),     # widens margins around plot
          #col=my_palette,       # use on color palette defined earlier
          #breaks=col_breaks,    # enable color transition at specified limits
          dendrogram="row",     # only draw a row dendrogram
          keysize = 1) 
```

####25kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/training_testing/train.rds")

binswtad <- train[which(train$y=="Yes"),]
binswtad <- binswtad[,grep("count", names(binswtad))]

names(binswtad) <- gsub(paste(c("Gm12878",
                          "-",
                          "_",
                          "count",
                          "Haib",
                          "Sydh",
                          "Uta",
                          "Uw",
                          "Broad",
                          "Uchicago"), collapse = "|"),"", names(binswtad))


cormat <- cor(binswtad)

get_upper_tri <- function(cormat){
    cormat[lower.tri(cormat)]<- NA
    return(cormat)
}

upper_tri <- get_upper_tri(cormat)

melted_cormat <- melt(upper_tri, na.rm = TRUE)

reorder_cormat <- function(cormat){
# Use correlation between variables as distance
dd <- as.dist((1-cormat)/2)
hc <- hclust(dd)
cormat <-cormat[hc$order, hc$order]
}

cormat_reorder <- reorder_cormat(cormat)

upper_tri_reorder <- get_upper_tri(cormat_reorder)

melted_cormat_reorder <- melt(upper_tri_reorder, na.rm = TRUE)

corplot_gm12878_25kb <- ggplot(data = melted_cormat_reorder, aes(Var2, Var1, fill = value))+
 geom_tile(color = "white")+
 scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
   midpoint = 0, limit = c(-1,1), space = "Lab", 
   name="Pearson\nCorrelation") +
 ylab("") +
 xlab("") +  
 theme_minimal()+ 
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
    size = 10, hjust = 1),
       axis.text.y = element_text(size = 10))
 #coord_fixed()

pvals <- rcorr(as.matrix(binswtad))$P
upper_tri_pvals <- get_upper_tri(pvals) 
melted_pvals <- melt(upper_tri_pvals, na.rm = TRUE)
melted_cormat2 <- melted_cormat[-which(melted_cormat$value==1.00000000),]
melted_cormat2$pvals <- melted_pvals$value

#find significant correlations
sigcorrs_gm12878_25kb <- melted_cormat2[which(melted_cormat2$pvals<=.05),]
dim(sigcorrs_gm12878_25kb) #4683    4
sigcorrs_gm12878_25kb[,3:4] <- round(sigcorrs_gm12878_25kb[,3:4], 4)
sigcorrs_gm12878_25kb <- sigcorrs_gm12878_25kb[order(sigcorrs_gm12878_25kb$pvals, decreasing = FALSE),]

highcorrs_gm12878_25kb <- melted_cormat2[which(melted_cormat2$value > 0.70 | melted_cormat2$value < (-0.70)),] 
dim(highcorrs_gm12878_25kb) #50  4
highcorrs_gm12878_25kb[,3:4] <- round(highcorrs_gm12878_25kb[,3:4], 2)
highcorrs_gm12878_25kb <- highcorrs_gm12878_25kb[order(abs(highcorrs_gm12878_25kb$value), decreasing = TRUE),]

#clustered heatmap
clustcorplot_gm12878_25kb <- heatmap.2(cormat,
          #cellnote = cormat,  # same data set for cell labels
          main = "Correlation", # heat map title
          notecol="black",      # change font color of cell labels to black
          density.info="none",  # turns off density plot inside color legend
          trace="none",         # turns off trace lines inside the heat map
          margins =c(6,6),     # widens margins around plot
          #col=my_palette,       # use on color palette defined earlier
          #breaks=col_breaks,    # enable color transition at specified limits
          dendrogram="row",     # only draw a row dendrogram
          keysize = 1) 
```

####50kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/training_testing/train.rds")

binswtad <- train[which(train$y=="Yes"),]
binswtad <- binswtad[,grep("count", names(binswtad))]

names(binswtad) <- gsub(paste(c("Gm12878",
                          "-",
                          "_",
                          "count",
                          "Haib",
                          "Sydh",
                          "Uta",
                          "Uw",
                          "Broad",
                          "Uchicago"), collapse = "|"),"", names(binswtad))


cormat <- cor(binswtad)

get_upper_tri <- function(cormat){
    cormat[lower.tri(cormat)]<- NA
    return(cormat)
}

upper_tri <- get_upper_tri(cormat)

melted_cormat <- melt(upper_tri, na.rm = TRUE)

reorder_cormat <- function(cormat){
# Use correlation between variables as distance
dd <- as.dist((1-cormat)/2)
hc <- hclust(dd)
cormat <-cormat[hc$order, hc$order]
}

cormat_reorder <- reorder_cormat(cormat)

upper_tri_reorder <- get_upper_tri(cormat_reorder)

melted_cormat_reorder <- melt(upper_tri_reorder, na.rm = TRUE)

corplot_gm12878_50kb <- ggplot(data = melted_cormat_reorder, aes(Var2, Var1, fill = value))+
 geom_tile(color = "white")+
 scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
   midpoint = 0, limit = c(-1,1), space = "Lab", 
   name="Pearson\nCorrelation") +
 ylab("") +
 xlab("") +  
 theme_minimal()+ 
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
    size = 10, hjust = 1),
       axis.text.y = element_text(size = 10))
 #coord_fixed()

pvals <- rcorr(as.matrix(binswtad))$P
upper_tri_pvals <- get_upper_tri(pvals) 
melted_pvals <- melt(upper_tri_pvals, na.rm = TRUE)
melted_cormat2 <- melted_cormat[-which(melted_cormat$value==1.00000000),]
melted_cormat2$pvals <- melted_pvals$value

#find significant correlations
sigcorrs_gm12878_50kb <- melted_cormat2[which(melted_cormat2$pvals<=.05),]
dim(sigcorrs_gm12878_50kb) #
sigcorrs_gm12878_50kb[,3:4] <- round(sigcorrs_gm12878_50kb[,3:4], 4)
sigcorrs_gm12878_50kb <- sigcorrs_gm12878_50kb[order(sigcorrs_gm12878_50kb$pvals, decreasing = FALSE),]

highcorrs_gm12878_50kb <- melted_cormat2[which(melted_cormat2$value > 0.70 | melted_cormat2$value < (-0.70)),] 
dim(highcorrs_gm12878_50kb) #
highcorrs_gm12878_50kb[,3:4] <- round(highcorrs_gm12878_50kb[,3:4], 2)
highcorrs_gm12878_50kb <- highcorrs_gm12878_50kb[order(abs(highcorrs_gm12878_50kb$value), decreasing = TRUE),]

#clustered heatmap
clustcorplot_gm12878_50kb <- heatmap.2(cormat,
          #cellnote = cormat,  # same data set for cell labels
          main = "Correlation", # heat map title
          notecol="black",      # change font color of cell labels to black
          density.info="none",  # turns off density plot inside color legend
          trace="none",         # turns off trace lines inside the heat map
          margins =c(6,6),     # widens margins around plot
          #col=my_palette,       # use on color palette defined earlier
          #breaks=col_breaks,    # enable color transition at specified limits
          dendrogram="row",     # only draw a row dendrogram
          keysize = 1)
```

####100kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/training_testing/train.rds")

binswtad <- train[which(train$y=="Yes"),]
binswtad <- binswtad[,grep("count", names(binswtad))]

names(binswtad) <- gsub(paste(c("Gm12878",
                          "-",
                          "_",
                          "count",
                          "Haib",
                          "Sydh",
                          "Uta",
                          "Uw",
                          "Broad",
                          "Uchicago"), collapse = "|"),"", names(binswtad))


cormat <- cor(binswtad)

get_upper_tri <- function(cormat){
    cormat[lower.tri(cormat)]<- NA
    return(cormat)
}

upper_tri <- get_upper_tri(cormat)

melted_cormat <- melt(upper_tri, na.rm = TRUE)

reorder_cormat <- function(cormat){
# Use correlation between variables as distance
dd <- as.dist((1-cormat)/2)
hc <- hclust(dd)
cormat <-cormat[hc$order, hc$order]
}

cormat_reorder <- reorder_cormat(cormat)

upper_tri_reorder <- get_upper_tri(cormat_reorder)

melted_cormat_reorder <- melt(upper_tri_reorder, na.rm = TRUE)

corplot_gm12878_100kb <- ggplot(data = melted_cormat_reorder, aes(Var2, Var1, fill = value))+
 geom_tile(color = "white")+
 scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
   midpoint = 0, limit = c(-1,1), space = "Lab", 
   name="Pearson\nCorrelation") +
 ylab("") +
 xlab("") +  
 theme_minimal()+ 
 theme(axis.text.x = element_text(angle = 45, vjust = 1, 
    size = 10, hjust = 1),
       axis.text.y = element_text(size = 10))
 #coord_fixed()

pvals <- rcorr(as.matrix(binswtad))$P
upper_tri_pvals <- get_upper_tri(pvals) 
melted_pvals <- melt(upper_tri_pvals, na.rm = TRUE)
melted_cormat2 <- melted_cormat[-which(melted_cormat$value==1.00000000),]
melted_cormat2$pvals <- melted_pvals$value

#find significant correlations
sigcorrs_gm12878_100kb <- melted_cormat2[which(melted_cormat2$pvals<=.05),]
dim(sigcorrs_gm12878_100kb) #4373    4
sigcorrs_gm12878_100kb[,3:4] <- round(sigcorrs_gm12878_100kb[,3:4], 4)
sigcorrs_gm12878_100kb <- sigcorrs_gm12878_100kb[order(sigcorrs_gm12878_100kb$pvals, decreasing = FALSE),]

highcorrs_gm12878_100kb <- melted_cormat2[which(melted_cormat2$value > 0.70 | melted_cormat2$value < (-0.70)),] 
dim(highcorrs_gm12878_100kb) #424   4
highcorrs_gm12878_100kb[,3:4] <- round(highcorrs_gm12878_100kb[,3:4], 2)
highcorrs_gm12878_100kb <- highcorrs_gm12878_100kb[order(abs(highcorrs_gm12878_100kb$value), decreasing = TRUE),]

#clustered heatmap
clustcorplot_gm12878_100kb <- heatmap.2(cormat,
          #cellnote = cormat,  # same data set for cell labels
          main = "Correlation", # heat map title
          notecol="black",      # change font color of cell labels to black
          density.info="none",  # turns off density plot inside color legend
          trace="none",         # turns off trace lines inside the heat map
          margins =c(6,6),     # widens margins around plot
          #col=my_palette,       # use on color palette defined earlier
          #breaks=col_breaks,    # enable color transition at specified limits
          dendrogram="row",     # only draw a row dendrogram
          keysize = 1)
```

###K562



## PR Curves

###GM12878

####10kb

#####None

```{r}

prall_None <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_None$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_None$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_None$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_None$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.431)","All (AUPRC: 0.358)", "Counts (AUPRC: 0.209)","Percents (AUPRC: 0.202)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)



```

#####RUS

```{r}
prall_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_RUS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_RUS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_RUS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_RUS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.431)","All (AUPRC: 0.358)", "Counts (AUPRC: 0.209)","Percents (AUPRC: 0.202)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```

#####ROS

```{r}
prall_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.431)","All (AUPRC: 0.358)", "Counts (AUPRC: 0.209)","Percents (AUPRC: 0.202)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####SMOTE

```{r}
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.431)","All (AUPRC: 0.358)", "Counts (AUPRC: 0.209)","Percents (AUPRC: 0.202)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROSE

```{r}
prall_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROSE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROSE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROSE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROSE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.431)","All (AUPRC: 0.358)", "Counts (AUPRC: 0.209)","Percents (AUPRC: 0.202)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


####25kb

#####None

```{r}

prall_None <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_None$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_None$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_None$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_None$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.436)","All (AUPRC: 0.380)", "Percents (AUPRC: 0.239)","Counts (AUPRC: 0.231)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```

#####RUS

```{r}
prall_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_RUS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_RUS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_RUS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_RUS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.436)","All (AUPRC: 0.380)", "Percents (AUPRC: 0.239)","Counts (AUPRC: 0.231)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROS

```{r}
prall_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.436)","All (AUPRC: 0.380)", "Percents (AUPRC: 0.239)","Counts (AUPRC: 0.231)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####SMOTE

```{r}
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.436)","All (AUPRC: 0.380)", "Percents (AUPRC: 0.239)","Counts (AUPRC: 0.231)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROSE

```{r}
prall_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROSE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROSE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROSE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROSE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.436)","All (AUPRC: 0.380)", "Percents (AUPRC: 0.239)","Counts (AUPRC: 0.231)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


####50kb

#####None

```{r}

prall_None <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_None$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_None$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_None$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_None$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.405)","All (AUPRC: 0.367)", "Percents (AUPRC: 0.218)","Counts (AUPRC: 0.212)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```

#####RUS

```{r}
prall_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_RUS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_RUS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_RUS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_RUS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.405)","All (AUPRC: 0.367)", "Percents (AUPRC: 0.218)","Counts (AUPRC: 0.212)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROS

```{r}
prall_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.405)","All (AUPRC: 0.367)", "Percents (AUPRC: 0.218)","Counts (AUPRC: 0.212)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####SMOTE

```{r}
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.405)","All (AUPRC: 0.367)", "Percents (AUPRC: 0.218)","Counts (AUPRC: 0.212)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROSE

```{r}
prall_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROSE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROSE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROSE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROSE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.405)","All (AUPRC: 0.367)", "Percents (AUPRC: 0.218)","Counts (AUPRC: 0.212)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


####100kb

#####None

```{r}

prall_None <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_None$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_None$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_None$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_None$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.361)","All (AUPRC: 0.301)", "Counts (AUPRC: 0.175)", "Percents (AUPRC: 0.156)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```

#####RUS

```{r}
prall_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_RUS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_RUS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_RUS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_RUS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.361)","All (AUPRC: 0.301)", "Counts (AUPRC: 0.175)", "Percents (AUPRC: 0.156)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROS

```{r}
prall_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.361)","All (AUPRC: 0.301)", "Counts (AUPRC: 0.175)", "Percents (AUPRC: 0.156)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####SMOTE

```{r}
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.361)","All (AUPRC: 0.301)", "Counts (AUPRC: 0.175)", "Percents (AUPRC: 0.156)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROSE

```{r}
prall_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROSE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROSE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROSE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROSE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.361)","All (AUPRC: 0.301)", "Counts (AUPRC: 0.175)", "Percents (AUPRC: 0.156)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


###K562

####10kb

#####None

```{r}

prall_None <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_None$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_None$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_None$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_None$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.431)","All (AUPRC: 0.358)", "Counts (AUPRC: 0.209)","Percents (AUPRC: 0.202)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)



```

#####RUS

```{r}
prall_RUS <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_RUS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_RUS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_RUS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_RUS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.431)","All (AUPRC: 0.358)", "Counts (AUPRC: 0.209)","Percents (AUPRC: 0.202)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```

#####ROS

```{r}
prall_ROS <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.431)","All (AUPRC: 0.358)", "Counts (AUPRC: 0.209)","Percents (AUPRC: 0.202)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####SMOTE

```{r}
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.431)","All (AUPRC: 0.358)", "Counts (AUPRC: 0.209)","Percents (AUPRC: 0.202)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROSE

```{r}
prall_ROSE <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROSE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROSE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROSE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROSE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.431)","All (AUPRC: 0.358)", "Counts (AUPRC: 0.209)","Percents (AUPRC: 0.202)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


####25kb

#####None

```{r}

prall_None <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_None$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_None$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_None$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_None$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.436)","All (AUPRC: 0.380)", "Percents (AUPRC: 0.239)","Counts (AUPRC: 0.231)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```

#####RUS

```{r}
prall_RUS <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_RUS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_RUS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_RUS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_RUS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.436)","All (AUPRC: 0.380)", "Percents (AUPRC: 0.239)","Counts (AUPRC: 0.231)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROS

```{r}
prall_ROS <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.436)","All (AUPRC: 0.380)", "Percents (AUPRC: 0.239)","Counts (AUPRC: 0.231)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####SMOTE

```{r}
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.436)","All (AUPRC: 0.380)", "Percents (AUPRC: 0.239)","Counts (AUPRC: 0.231)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROSE

```{r}
prall_ROSE <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROSE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROSE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROSE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROSE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.436)","All (AUPRC: 0.380)", "Percents (AUPRC: 0.239)","Counts (AUPRC: 0.231)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


####50kb

#####None

```{r}

prall_None <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_None$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_None$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_None$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_None$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.405)","All (AUPRC: 0.367)", "Percents (AUPRC: 0.218)","Counts (AUPRC: 0.212)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```

#####RUS

```{r}
prall_RUS <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_RUS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_RUS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_RUS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_RUS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.405)","All (AUPRC: 0.367)", "Percents (AUPRC: 0.218)","Counts (AUPRC: 0.212)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROS

```{r}
prall_ROS <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.405)","All (AUPRC: 0.367)", "Percents (AUPRC: 0.218)","Counts (AUPRC: 0.212)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####SMOTE

```{r}
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.405)","All (AUPRC: 0.367)", "Percents (AUPRC: 0.218)","Counts (AUPRC: 0.212)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROSE

```{r}
prall_ROSE <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROSE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROSE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROSE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROSE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.405)","All (AUPRC: 0.367)", "Percents (AUPRC: 0.218)","Counts (AUPRC: 0.212)", "Baseline"),
#       col=c("red", "black", "green", "blue", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


####100kb

#####None

```{r}

prall_None <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_None$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_None$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_None$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_None$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.361)","All (AUPRC: 0.301)", "Counts (AUPRC: 0.175)", "Percents (AUPRC: 0.156)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```

#####RUS

```{r}
prall_RUS <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_RUS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_RUS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_RUS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_RUS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.361)","All (AUPRC: 0.301)", "Counts (AUPRC: 0.175)", "Percents (AUPRC: 0.156)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROS

```{r}
prall_ROS <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROS$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROS$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROS$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROS$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.361)","All (AUPRC: 0.301)", "Counts (AUPRC: 0.175)", "Percents (AUPRC: 0.156)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####SMOTE

```{r}
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_SMOTE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.361)","All (AUPRC: 0.301)", "Counts (AUPRC: 0.175)", "Percents (AUPRC: 0.156)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```


#####ROSE

```{r}
prall_ROSE <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/op/RFE/prcurve.rds")

#plot(prall, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, rand.plot = TRUE)
plot(prall_ROSE$curve, auc.main= FALSE, legend=FALSE, col='black', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")
lines(prdist_ROSE$curve, auc.main= FALSE, legend=FALSE, col='red', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, xlab="Recall", ylab="Precision")#, add=TRUE)
lines(proc_ROSE$curve, auc.main= FALSE, legend=FALSE, col='blue', panel.first= grid(), cex.main = 1.5, type="l",lwd=2, add=TRUE)
lines(prop_ROSE$curve, auc.main= FALSE, legend=FALSE, col='green', panel.first= grid(), cex.main = 1.5, type="l", ylim=c(0,1), lwd=2, add=TRUE)

test <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/test.rds")
abline(h = sum(test$y=="Yes")/(sum(test$y=="Yes") + sum(test$y=="No")), col="black", lty=2)

#legend("topright", title="Predictor Type", legend=c("Distance (AUPRC: 0.361)","All (AUPRC: 0.301)", "Counts (AUPRC: 0.175)", "Percents (AUPRC: 0.156)", "Baseline"),
#       col=c("red", "black", "blue", "green", "black"), lty=c(1,1,1,1,2), lwd=c(3,3,3,3,1), cex=0.8)

```



###Combined

```{r}
#10kb
##None
prall_None <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/op/RFE/prcurve.rds")

prall_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/op/RFE/prcurve.rds")

prdata_None_10kb <- rbind.data.frame(prall_None$curve,
                                prdist_None$curve,
                                prop_None$curve,
                                proc_None$curve,
                                prall_None_k562$curve,
                                prdist_None_k562$curve,
                                prop_None_k562$curve,
                                proc_None_k562$curve)
names(prdata_None_10kb) <- c("Recall", "Precision", "Threshold")
prdata_None_10kb$Predictor <- c(rep("All", dim(prall_None$curve)[1]),
                           rep("Distance", dim(prdist_None$curve)[1]),
                           rep("OP", dim(prop_None$curve)[1]),
                           rep("OC", dim(proc_None$curve)[1]),
                           rep("All", dim(prall_None_k562$curve)[1]),
                           rep("Distance", dim(prdist_None_k562$curve)[1]),
                           rep("OP", dim(prop_None_k562$curve)[1]),
                           rep("OC", dim(proc_None_k562$curve)[1]))
prdata_None_10kb$CL <- c(rep("GM12878", (dim(prall_None$curve)[1]+
                                      dim(prdist_None$curve)[1]+
                                      dim(prop_None$curve)[1]+
                                      dim(proc_None$curve)[1])),
                    rep("K562", (dim(prall_None_k562$curve)[1]+
                                      dim(prdist_None_k562$curve)[1]+
                                      dim(prop_None_k562$curve)[1]+
                                      dim(proc_None_k562$curve)[1])))
prdata_None_10kb$Predictor <- factor(prdata_None_10kb$Predictor)
prdata_None_10kb$CL <- factor(prdata_None_10kb$CL)


prplot_None_10kb <- ggplot(prdata_None_10kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##RUS
prall_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/op/RFE/prcurve.rds")

prall_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/op/RFE/prcurve.rds")

prdata_RUS_10kb <- rbind.data.frame(prall_RUS$curve,
                                prdist_RUS$curve,
                                prop_RUS$curve,
                                proc_RUS$curve,
                                prall_RUS_k562$curve,
                                prdist_RUS_k562$curve,
                                prop_RUS_k562$curve,
                                proc_RUS_k562$curve)
names(prdata_RUS_10kb) <- c("Recall", "Precision", "Threshold")
prdata_RUS_10kb$Predictor <- c(rep("All", dim(prall_RUS$curve)[1]),
                           rep("Distance", dim(prdist_RUS$curve)[1]),
                           rep("OP", dim(prop_RUS$curve)[1]),
                           rep("OC", dim(proc_RUS$curve)[1]),
                           rep("All", dim(prall_RUS_k562$curve)[1]),
                           rep("Distance", dim(prdist_RUS_k562$curve)[1]),
                           rep("OP", dim(prop_RUS_k562$curve)[1]),
                           rep("OC", dim(proc_RUS_k562$curve)[1]))
prdata_RUS_10kb$CL <- c(rep("GM12878", (dim(prall_RUS$curve)[1]+
                                      dim(prdist_RUS$curve)[1]+
                                      dim(prop_RUS$curve)[1]+
                                      dim(proc_RUS$curve)[1])),
                    rep("K562", (dim(prall_RUS_k562$curve)[1]+
                                      dim(prdist_RUS_k562$curve)[1]+
                                      dim(prop_RUS_k562$curve)[1]+
                                      dim(proc_RUS_k562$curve)[1])))
prdata_RUS_10kb$Predictor <- factor(prdata_RUS_10kb$Predictor)
prdata_RUS_10kb$CL <- factor(prdata_RUS_10kb$CL)


prplot_RUS_10kb <- ggplot(prdata_RUS_10kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##ROS
prall_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/op/RFE/prcurve.rds")

prall_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/op/RFE/prcurve.rds")

prdata_ROS_10kb <- rbind.data.frame(prall_ROS$curve,
                                prdist_ROS$curve,
                                prop_ROS$curve,
                                proc_ROS$curve,
                                prall_ROS_k562$curve,
                                prdist_ROS_k562$curve,
                                prop_ROS_k562$curve,
                                proc_ROS_k562$curve)
names(prdata_ROS_10kb) <- c("Recall", "Precision", "Threshold")
prdata_ROS_10kb$Predictor <- c(rep("All", dim(prall_ROS$curve)[1]),
                           rep("Distance", dim(prdist_ROS$curve)[1]),
                           rep("OP", dim(prop_ROS$curve)[1]),
                           rep("OC", dim(proc_ROS$curve)[1]),
                           rep("All", dim(prall_ROS_k562$curve)[1]),
                           rep("Distance", dim(prdist_ROS_k562$curve)[1]),
                           rep("OP", dim(prop_ROS_k562$curve)[1]),
                           rep("OC", dim(proc_ROS_k562$curve)[1]))
prdata_ROS_10kb$CL <- c(rep("GM12878", (dim(prall_ROS$curve)[1]+
                                      dim(prdist_ROS$curve)[1]+
                                      dim(prop_ROS$curve)[1]+
                                      dim(proc_ROS$curve)[1])),
                    rep("K562", (dim(prall_ROS_k562$curve)[1]+
                                      dim(prdist_ROS_k562$curve)[1]+
                                      dim(prop_ROS_k562$curve)[1]+
                                      dim(proc_ROS_k562$curve)[1])))
prdata_ROS_10kb$Predictor <- factor(prdata_ROS_10kb$Predictor)
prdata_ROS_10kb$CL <- factor(prdata_ROS_10kb$CL)


prplot_ROS_10kb <- ggplot(prdata_ROS_10kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##SMOTE
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

prall_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

prdata_SMOTE_10kb <- rbind.data.frame(prall_SMOTE$curve,
                                prdist_SMOTE$curve,
                                prop_SMOTE$curve,
                                proc_SMOTE$curve,
                                prall_SMOTE_k562$curve,
                                prdist_SMOTE_k562$curve,
                                prop_SMOTE_k562$curve,
                                proc_SMOTE_k562$curve)
names(prdata_SMOTE_10kb) <- c("Recall", "Precision", "Threshold")
prdata_SMOTE_10kb$Predictor <- c(rep("All", dim(prall_SMOTE$curve)[1]),
                           rep("Distance", dim(prdist_SMOTE$curve)[1]),
                           rep("OP", dim(prop_SMOTE$curve)[1]),
                           rep("OC", dim(proc_SMOTE$curve)[1]),
                           rep("All", dim(prall_SMOTE_k562$curve)[1]),
                           rep("Distance", dim(prdist_SMOTE_k562$curve)[1]),
                           rep("OP", dim(prop_SMOTE_k562$curve)[1]),
                           rep("OC", dim(proc_SMOTE_k562$curve)[1]))
prdata_SMOTE_10kb$CL <- c(rep("GM12878", (dim(prall_SMOTE$curve)[1]+
                                      dim(prdist_SMOTE$curve)[1]+
                                      dim(prop_SMOTE$curve)[1]+
                                      dim(proc_SMOTE$curve)[1])),
                    rep("K562", (dim(prall_SMOTE_k562$curve)[1]+
                                      dim(prdist_SMOTE_k562$curve)[1]+
                                      dim(prop_SMOTE_k562$curve)[1]+
                                      dim(proc_SMOTE_k562$curve)[1])))
prdata_SMOTE_10kb$Predictor <- factor(prdata_SMOTE_10kb$Predictor)
prdata_SMOTE_10kb$CL <- factor(prdata_SMOTE_10kb$CL)


prplot_SMOTE_10kb <- ggplot(prdata_SMOTE_10kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()

##ROSE
prall_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/op/RFE/prcurve.rds")

prall_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/op/RFE/prcurve.rds")

prdata_ROSE_10kb <- rbind.data.frame(prall_ROSE$curve,
                                prdist_ROSE$curve,
                                prop_ROSE$curve,
                                proc_ROSE$curve,
                                prall_ROSE_k562$curve,
                                prdist_ROSE_k562$curve,
                                prop_ROSE_k562$curve,
                                proc_ROSE_k562$curve)
names(prdata_ROSE_10kb) <- c("Recall", "Precision", "Threshold")
prdata_ROSE_10kb$Predictor <- c(rep("All", dim(prall_ROSE$curve)[1]),
                           rep("Distance", dim(prdist_ROSE$curve)[1]),
                           rep("OP", dim(prop_ROSE$curve)[1]),
                           rep("OC", dim(proc_ROSE$curve)[1]),
                           rep("All", dim(prall_ROSE_k562$curve)[1]),
                           rep("Distance", dim(prdist_ROSE_k562$curve)[1]),
                           rep("OP", dim(prop_ROSE_k562$curve)[1]),
                           rep("OC", dim(proc_ROSE_k562$curve)[1]))
prdata_ROSE_10kb$CL <- c(rep("GM12878", (dim(prall_ROSE$curve)[1]+
                                      dim(prdist_ROSE$curve)[1]+
                                      dim(prop_ROSE$curve)[1]+
                                      dim(proc_ROSE$curve)[1])),
                    rep("K562", (dim(prall_ROSE_k562$curve)[1]+
                                      dim(prdist_ROSE_k562$curve)[1]+
                                      dim(prop_ROSE_k562$curve)[1]+
                                      dim(proc_ROSE_k562$curve)[1])))
prdata_ROSE_10kb$Predictor <- factor(prdata_ROSE_10kb$Predictor)
prdata_ROSE_10kb$CL <- factor(prdata_ROSE_10kb$CL)


prplot_ROSE_10kb <- ggplot(prdata_ROSE_10kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()

##Collecting 10kb plots
ggarrange(prplot_None_10kb,
          prplot_RUS_10kb,
          prplot_ROS_10kb,
          prplot_SMOTE_10kb,
          prplot_ROSE_10kb,
          nrow=3,ncol=2,
          common.legend = TRUE, legend = "right")

#######################################################################################

#25kb
##None
prall_None <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/op/RFE/prcurve.rds")

prall_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/op/RFE/prcurve.rds")

prdata_None_25kb <- rbind.data.frame(prall_None$curve,
                                prdist_None$curve,
                                prop_None$curve,
                                proc_None$curve,
                                prall_None_k562$curve,
                                prdist_None_k562$curve,
                                prop_None_k562$curve,
                                proc_None_k562$curve)
names(prdata_None_25kb) <- c("Recall", "Precision", "Threshold")
prdata_None_25kb$Predictor <- c(rep("All", dim(prall_None$curve)[1]),
                           rep("Distance", dim(prdist_None$curve)[1]),
                           rep("OP", dim(prop_None$curve)[1]),
                           rep("OC", dim(proc_None$curve)[1]),
                           rep("All", dim(prall_None_k562$curve)[1]),
                           rep("Distance", dim(prdist_None_k562$curve)[1]),
                           rep("OP", dim(prop_None_k562$curve)[1]),
                           rep("OC", dim(proc_None_k562$curve)[1]))
prdata_None_25kb$CL <- c(rep("GM12878", (dim(prall_None$curve)[1]+
                                      dim(prdist_None$curve)[1]+
                                      dim(prop_None$curve)[1]+
                                      dim(proc_None$curve)[1])),
                    rep("K562", (dim(prall_None_k562$curve)[1]+
                                      dim(prdist_None_k562$curve)[1]+
                                      dim(prop_None_k562$curve)[1]+
                                      dim(proc_None_k562$curve)[1])))
prdata_None_25kb$Predictor <- factor(prdata_None_25kb$Predictor)
prdata_None_25kb$CL <- factor(prdata_None_25kb$CL)


prplot_None_25kb <- ggplot(prdata_None_25kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##RUS
prall_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/op/RFE/prcurve.rds")

prall_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/op/RFE/prcurve.rds")

prdata_RUS_25kb <- rbind.data.frame(prall_RUS$curve,
                                prdist_RUS$curve,
                                prop_RUS$curve,
                                proc_RUS$curve,
                                prall_RUS_k562$curve,
                                prdist_RUS_k562$curve,
                                prop_RUS_k562$curve,
                                proc_RUS_k562$curve)
names(prdata_RUS_25kb) <- c("Recall", "Precision", "Threshold")
prdata_RUS_25kb$Predictor <- c(rep("All", dim(prall_RUS$curve)[1]),
                           rep("Distance", dim(prdist_RUS$curve)[1]),
                           rep("OP", dim(prop_RUS$curve)[1]),
                           rep("OC", dim(proc_RUS$curve)[1]),
                           rep("All", dim(prall_RUS_k562$curve)[1]),
                           rep("Distance", dim(prdist_RUS_k562$curve)[1]),
                           rep("OP", dim(prop_RUS_k562$curve)[1]),
                           rep("OC", dim(proc_RUS_k562$curve)[1]))
prdata_RUS_25kb$CL <- c(rep("GM12878", (dim(prall_RUS$curve)[1]+
                                      dim(prdist_RUS$curve)[1]+
                                      dim(prop_RUS$curve)[1]+
                                      dim(proc_RUS$curve)[1])),
                    rep("K562", (dim(prall_RUS_k562$curve)[1]+
                                      dim(prdist_RUS_k562$curve)[1]+
                                      dim(prop_RUS_k562$curve)[1]+
                                      dim(proc_RUS_k562$curve)[1])))
prdata_RUS_25kb$Predictor <- factor(prdata_RUS_25kb$Predictor)
prdata_RUS_25kb$CL <- factor(prdata_RUS_25kb$CL)


prplot_RUS_25kb <- ggplot(prdata_RUS_25kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##ROS
prall_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/op/RFE/prcurve.rds")

prall_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/op/RFE/prcurve.rds")

prdata_ROS_25kb <- rbind.data.frame(prall_ROS$curve,
                                prdist_ROS$curve,
                                prop_ROS$curve,
                                proc_ROS$curve,
                                prall_ROS_k562$curve,
                                prdist_ROS_k562$curve,
                                prop_ROS_k562$curve,
                                proc_ROS_k562$curve)
names(prdata_ROS_25kb) <- c("Recall", "Precision", "Threshold")
prdata_ROS_25kb$Predictor <- c(rep("All", dim(prall_ROS$curve)[1]),
                           rep("Distance", dim(prdist_ROS$curve)[1]),
                           rep("OP", dim(prop_ROS$curve)[1]),
                           rep("OC", dim(proc_ROS$curve)[1]),
                           rep("All", dim(prall_ROS_k562$curve)[1]),
                           rep("Distance", dim(prdist_ROS_k562$curve)[1]),
                           rep("OP", dim(prop_ROS_k562$curve)[1]),
                           rep("OC", dim(proc_ROS_k562$curve)[1]))
prdata_ROS_25kb$CL <- c(rep("GM12878", (dim(prall_ROS$curve)[1]+
                                      dim(prdist_ROS$curve)[1]+
                                      dim(prop_ROS$curve)[1]+
                                      dim(proc_ROS$curve)[1])),
                    rep("K562", (dim(prall_ROS_k562$curve)[1]+
                                      dim(prdist_ROS_k562$curve)[1]+
                                      dim(prop_ROS_k562$curve)[1]+
                                      dim(proc_ROS_k562$curve)[1])))
prdata_ROS_25kb$Predictor <- factor(prdata_ROS_25kb$Predictor)
prdata_ROS_25kb$CL <- factor(prdata_ROS_25kb$CL)


prplot_ROS_25kb <- ggplot(prdata_ROS_25kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##SMOTE
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

prall_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

prdata_SMOTE_25kb <- rbind.data.frame(prall_SMOTE$curve,
                                prdist_SMOTE$curve,
                                prop_SMOTE$curve,
                                proc_SMOTE$curve,
                                prall_SMOTE_k562$curve,
                                prdist_SMOTE_k562$curve,
                                prop_SMOTE_k562$curve,
                                proc_SMOTE_k562$curve)
names(prdata_SMOTE_25kb) <- c("Recall", "Precision", "Threshold")
prdata_SMOTE_25kb$Predictor <- c(rep("All", dim(prall_SMOTE$curve)[1]),
                           rep("Distance", dim(prdist_SMOTE$curve)[1]),
                           rep("OP", dim(prop_SMOTE$curve)[1]),
                           rep("OC", dim(proc_SMOTE$curve)[1]),
                           rep("All", dim(prall_SMOTE_k562$curve)[1]),
                           rep("Distance", dim(prdist_SMOTE_k562$curve)[1]),
                           rep("OP", dim(prop_SMOTE_k562$curve)[1]),
                           rep("OC", dim(proc_SMOTE_k562$curve)[1]))
prdata_SMOTE_25kb$CL <- c(rep("GM12878", (dim(prall_SMOTE$curve)[1]+
                                      dim(prdist_SMOTE$curve)[1]+
                                      dim(prop_SMOTE$curve)[1]+
                                      dim(proc_SMOTE$curve)[1])),
                    rep("K562", (dim(prall_SMOTE_k562$curve)[1]+
                                      dim(prdist_SMOTE_k562$curve)[1]+
                                      dim(prop_SMOTE_k562$curve)[1]+
                                      dim(proc_SMOTE_k562$curve)[1])))
prdata_SMOTE_25kb$Predictor <- factor(prdata_SMOTE_25kb$Predictor)
prdata_SMOTE_25kb$CL <- factor(prdata_SMOTE_25kb$CL)


prplot_SMOTE_25kb <- ggplot(prdata_SMOTE_25kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()

##ROSE
prall_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/op/RFE/prcurve.rds")

prall_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/op/RFE/prcurve.rds")

prdata_ROSE_25kb <- rbind.data.frame(prall_ROSE$curve,
                                prdist_ROSE$curve,
                                prop_ROSE$curve,
                                proc_ROSE$curve,
                                prall_ROSE_k562$curve,
                                prdist_ROSE_k562$curve,
                                prop_ROSE_k562$curve,
                                proc_ROSE_k562$curve)
names(prdata_ROSE_25kb) <- c("Recall", "Precision", "Threshold")
prdata_ROSE_25kb$Predictor <- c(rep("All", dim(prall_ROSE$curve)[1]),
                           rep("Distance", dim(prdist_ROSE$curve)[1]),
                           rep("OP", dim(prop_ROSE$curve)[1]),
                           rep("OC", dim(proc_ROSE$curve)[1]),
                           rep("All", dim(prall_ROSE_k562$curve)[1]),
                           rep("Distance", dim(prdist_ROSE_k562$curve)[1]),
                           rep("OP", dim(prop_ROSE_k562$curve)[1]),
                           rep("OC", dim(proc_ROSE_k562$curve)[1]))
prdata_ROSE_25kb$CL <- c(rep("GM12878", (dim(prall_ROSE$curve)[1]+
                                      dim(prdist_ROSE$curve)[1]+
                                      dim(prop_ROSE$curve)[1]+
                                      dim(proc_ROSE$curve)[1])),
                    rep("K562", (dim(prall_ROSE_k562$curve)[1]+
                                      dim(prdist_ROSE_k562$curve)[1]+
                                      dim(prop_ROSE_k562$curve)[1]+
                                      dim(proc_ROSE_k562$curve)[1])))
prdata_ROSE_25kb$Predictor <- factor(prdata_ROSE_25kb$Predictor)
prdata_ROSE_25kb$CL <- factor(prdata_ROSE_25kb$CL)


prplot_ROSE_25kb <- ggplot(prdata_ROSE_25kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()

###############################################################################

#50kb
##None
prall_None <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/op/RFE/prcurve.rds")

prall_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/op/RFE/prcurve.rds")

prdata_None_50kb <- rbind.data.frame(prall_None$curve,
                                prdist_None$curve,
                                prop_None$curve,
                                proc_None$curve,
                                prall_None_k562$curve,
                                prdist_None_k562$curve,
                                prop_None_k562$curve,
                                proc_None_k562$curve)
names(prdata_None_50kb) <- c("Recall", "Precision", "Threshold")
prdata_None_50kb$Predictor <- c(rep("All", dim(prall_None$curve)[1]),
                           rep("Distance", dim(prdist_None$curve)[1]),
                           rep("OP", dim(prop_None$curve)[1]),
                           rep("OC", dim(proc_None$curve)[1]),
                           rep("All", dim(prall_None_k562$curve)[1]),
                           rep("Distance", dim(prdist_None_k562$curve)[1]),
                           rep("OP", dim(prop_None_k562$curve)[1]),
                           rep("OC", dim(proc_None_k562$curve)[1]))
prdata_None_50kb$CL <- c(rep("GM12878", (dim(prall_None$curve)[1]+
                                      dim(prdist_None$curve)[1]+
                                      dim(prop_None$curve)[1]+
                                      dim(proc_None$curve)[1])),
                    rep("K562", (dim(prall_None_k562$curve)[1]+
                                      dim(prdist_None_k562$curve)[1]+
                                      dim(prop_None_k562$curve)[1]+
                                      dim(proc_None_k562$curve)[1])))
prdata_None_50kb$Predictor <- factor(prdata_None_50kb$Predictor)
prdata_None_50kb$CL <- factor(prdata_None_50kb$CL)


prplot_None_50kb <- ggplot(prdata_None_50kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##RUS
prall_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/op/RFE/prcurve.rds")

prall_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/op/RFE/prcurve.rds")

prdata_RUS_50kb <- rbind.data.frame(prall_RUS$curve,
                                prdist_RUS$curve,
                                prop_RUS$curve,
                                proc_RUS$curve,
                                prall_RUS_k562$curve,
                                prdist_RUS_k562$curve,
                                prop_RUS_k562$curve,
                                proc_RUS_k562$curve)
names(prdata_RUS_50kb) <- c("Recall", "Precision", "Threshold")
prdata_RUS_50kb$Predictor <- c(rep("All", dim(prall_RUS$curve)[1]),
                           rep("Distance", dim(prdist_RUS$curve)[1]),
                           rep("OP", dim(prop_RUS$curve)[1]),
                           rep("OC", dim(proc_RUS$curve)[1]),
                           rep("All", dim(prall_RUS_k562$curve)[1]),
                           rep("Distance", dim(prdist_RUS_k562$curve)[1]),
                           rep("OP", dim(prop_RUS_k562$curve)[1]),
                           rep("OC", dim(proc_RUS_k562$curve)[1]))
prdata_RUS_50kb$CL <- c(rep("GM12878", (dim(prall_RUS$curve)[1]+
                                      dim(prdist_RUS$curve)[1]+
                                      dim(prop_RUS$curve)[1]+
                                      dim(proc_RUS$curve)[1])),
                    rep("K562", (dim(prall_RUS_k562$curve)[1]+
                                      dim(prdist_RUS_k562$curve)[1]+
                                      dim(prop_RUS_k562$curve)[1]+
                                      dim(proc_RUS_k562$curve)[1])))
prdata_RUS_50kb$Predictor <- factor(prdata_RUS_50kb$Predictor)
prdata_RUS_50kb$CL <- factor(prdata_RUS_50kb$CL)


prplot_RUS_50kb <- ggplot(prdata_RUS_50kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##ROS
prall_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/op/RFE/prcurve.rds")

prall_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/op/RFE/prcurve.rds")

prdata_ROS_50kb <- rbind.data.frame(prall_ROS$curve,
                                prdist_ROS$curve,
                                prop_ROS$curve,
                                proc_ROS$curve,
                                prall_ROS_k562$curve,
                                prdist_ROS_k562$curve,
                                prop_ROS_k562$curve,
                                proc_ROS_k562$curve)
names(prdata_ROS_50kb) <- c("Recall", "Precision", "Threshold")
prdata_ROS_50kb$Predictor <- c(rep("All", dim(prall_ROS$curve)[1]),
                           rep("Distance", dim(prdist_ROS$curve)[1]),
                           rep("OP", dim(prop_ROS$curve)[1]),
                           rep("OC", dim(proc_ROS$curve)[1]),
                           rep("All", dim(prall_ROS_k562$curve)[1]),
                           rep("Distance", dim(prdist_ROS_k562$curve)[1]),
                           rep("OP", dim(prop_ROS_k562$curve)[1]),
                           rep("OC", dim(proc_ROS_k562$curve)[1]))
prdata_ROS_50kb$CL <- c(rep("GM12878", (dim(prall_ROS$curve)[1]+
                                      dim(prdist_ROS$curve)[1]+
                                      dim(prop_ROS$curve)[1]+
                                      dim(proc_ROS$curve)[1])),
                    rep("K562", (dim(prall_ROS_k562$curve)[1]+
                                      dim(prdist_ROS_k562$curve)[1]+
                                      dim(prop_ROS_k562$curve)[1]+
                                      dim(proc_ROS_k562$curve)[1])))
prdata_ROS_50kb$Predictor <- factor(prdata_ROS_50kb$Predictor)
prdata_ROS_50kb$CL <- factor(prdata_ROS_50kb$CL)


prplot_ROS_50kb <- ggplot(prdata_ROS_50kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##SMOTE
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

prall_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

prdata_SMOTE_50kb <- rbind.data.frame(prall_SMOTE$curve,
                                prdist_SMOTE$curve,
                                prop_SMOTE$curve,
                                proc_SMOTE$curve,
                                prall_SMOTE_k562$curve,
                                prdist_SMOTE_k562$curve,
                                prop_SMOTE_k562$curve,
                                proc_SMOTE_k562$curve)
names(prdata_SMOTE_50kb) <- c("Recall", "Precision", "Threshold")
prdata_SMOTE_50kb$Predictor <- c(rep("All", dim(prall_SMOTE$curve)[1]),
                           rep("Distance", dim(prdist_SMOTE$curve)[1]),
                           rep("OP", dim(prop_SMOTE$curve)[1]),
                           rep("OC", dim(proc_SMOTE$curve)[1]),
                           rep("All", dim(prall_SMOTE_k562$curve)[1]),
                           rep("Distance", dim(prdist_SMOTE_k562$curve)[1]),
                           rep("OP", dim(prop_SMOTE_k562$curve)[1]),
                           rep("OC", dim(proc_SMOTE_k562$curve)[1]))
prdata_SMOTE_50kb$CL <- c(rep("GM12878", (dim(prall_SMOTE$curve)[1]+
                                      dim(prdist_SMOTE$curve)[1]+
                                      dim(prop_SMOTE$curve)[1]+
                                      dim(proc_SMOTE$curve)[1])),
                    rep("K562", (dim(prall_SMOTE_k562$curve)[1]+
                                      dim(prdist_SMOTE_k562$curve)[1]+
                                      dim(prop_SMOTE_k562$curve)[1]+
                                      dim(proc_SMOTE_k562$curve)[1])))
prdata_SMOTE_50kb$Predictor <- factor(prdata_SMOTE_50kb$Predictor)
prdata_SMOTE_50kb$CL <- factor(prdata_SMOTE_50kb$CL)


prplot_SMOTE_50kb <- ggplot(prdata_SMOTE_50kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()

##ROSE
prall_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/op/RFE/prcurve.rds")

prall_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/op/RFE/prcurve.rds")

prdata_ROSE_50kb <- rbind.data.frame(prall_ROSE$curve,
                                prdist_ROSE$curve,
                                prop_ROSE$curve,
                                proc_ROSE$curve,
                                prall_ROSE_k562$curve,
                                prdist_ROSE_k562$curve,
                                prop_ROSE_k562$curve,
                                proc_ROSE_k562$curve)
names(prdata_ROSE_50kb) <- c("Recall", "Precision", "Threshold")
prdata_ROSE_50kb$Predictor <- c(rep("All", dim(prall_ROSE$curve)[1]),
                           rep("Distance", dim(prdist_ROSE$curve)[1]),
                           rep("OP", dim(prop_ROSE$curve)[1]),
                           rep("OC", dim(proc_ROSE$curve)[1]),
                           rep("All", dim(prall_ROSE_k562$curve)[1]),
                           rep("Distance", dim(prdist_ROSE_k562$curve)[1]),
                           rep("OP", dim(prop_ROSE_k562$curve)[1]),
                           rep("OC", dim(proc_ROSE_k562$curve)[1]))
prdata_ROSE_50kb$CL <- c(rep("GM12878", (dim(prall_ROSE$curve)[1]+
                                      dim(prdist_ROSE$curve)[1]+
                                      dim(prop_ROSE$curve)[1]+
                                      dim(proc_ROSE$curve)[1])),
                    rep("K562", (dim(prall_ROSE_k562$curve)[1]+
                                      dim(prdist_ROSE_k562$curve)[1]+
                                      dim(prop_ROSE_k562$curve)[1]+
                                      dim(proc_ROSE_k562$curve)[1])))
prdata_ROSE_50kb$Predictor <- factor(prdata_ROSE_50kb$Predictor)
prdata_ROSE_50kb$CL <- factor(prdata_ROSE_50kb$CL)


prplot_ROSE_50kb <- ggplot(prdata_ROSE_50kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()

###########################################################################

#100kb
##None
prall_None <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/op/RFE/prcurve.rds")

prall_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/all/RFE/prcurve.rds")
prdist_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/Distance/RFE/prcurve.rds")
proc_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/oc/RFE/prcurve.rds")
prop_None_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/op/RFE/prcurve.rds")

prdata_None_100kb <- rbind.data.frame(prall_None$curve,
                                prdist_None$curve,
                                prop_None$curve,
                                proc_None$curve,
                                prall_None_k562$curve,
                                prdist_None_k562$curve,
                                prop_None_k562$curve,
                                proc_None_k562$curve)
names(prdata_None_100kb) <- c("Recall", "Precision", "Threshold")
prdata_None_100kb$Predictor <- c(rep("All", dim(prall_None$curve)[1]),
                           rep("Distance", dim(prdist_None$curve)[1]),
                           rep("OP", dim(prop_None$curve)[1]),
                           rep("OC", dim(proc_None$curve)[1]),
                           rep("All", dim(prall_None_k562$curve)[1]),
                           rep("Distance", dim(prdist_None_k562$curve)[1]),
                           rep("OP", dim(prop_None_k562$curve)[1]),
                           rep("OC", dim(proc_None_k562$curve)[1]))
prdata_None_100kb$CL <- c(rep("GM12878", (dim(prall_None$curve)[1]+
                                      dim(prdist_None$curve)[1]+
                                      dim(prop_None$curve)[1]+
                                      dim(proc_None$curve)[1])),
                    rep("K562", (dim(prall_None_k562$curve)[1]+
                                      dim(prdist_None_k562$curve)[1]+
                                      dim(prop_None_k562$curve)[1]+
                                      dim(proc_None_k562$curve)[1])))
prdata_None_100kb$Predictor <- factor(prdata_None_100kb$Predictor)
prdata_None_100kb$CL <- factor(prdata_None_100kb$CL)


prplot_None_100kb <- ggplot(prdata_None_100kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##RUS
prall_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/op/RFE/prcurve.rds")

prall_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/all/RFE/prcurve.rds")
prdist_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/Distance/RFE/prcurve.rds")
proc_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/oc/RFE/prcurve.rds")
prop_RUS_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/op/RFE/prcurve.rds")

prdata_RUS_100kb <- rbind.data.frame(prall_RUS$curve,
                                prdist_RUS$curve,
                                prop_RUS$curve,
                                proc_RUS$curve,
                                prall_RUS_k562$curve,
                                prdist_RUS_k562$curve,
                                prop_RUS_k562$curve,
                                proc_RUS_k562$curve)
names(prdata_RUS_100kb) <- c("Recall", "Precision", "Threshold")
prdata_RUS_100kb$Predictor <- c(rep("All", dim(prall_RUS$curve)[1]),
                           rep("Distance", dim(prdist_RUS$curve)[1]),
                           rep("OP", dim(prop_RUS$curve)[1]),
                           rep("OC", dim(proc_RUS$curve)[1]),
                           rep("All", dim(prall_RUS_k562$curve)[1]),
                           rep("Distance", dim(prdist_RUS_k562$curve)[1]),
                           rep("OP", dim(prop_RUS_k562$curve)[1]),
                           rep("OC", dim(proc_RUS_k562$curve)[1]))
prdata_RUS_100kb$CL <- c(rep("GM12878", (dim(prall_RUS$curve)[1]+
                                      dim(prdist_RUS$curve)[1]+
                                      dim(prop_RUS$curve)[1]+
                                      dim(proc_RUS$curve)[1])),
                    rep("K562", (dim(prall_RUS_k562$curve)[1]+
                                      dim(prdist_RUS_k562$curve)[1]+
                                      dim(prop_RUS_k562$curve)[1]+
                                      dim(proc_RUS_k562$curve)[1])))
prdata_RUS_100kb$Predictor <- factor(prdata_RUS_100kb$Predictor)
prdata_RUS_100kb$CL <- factor(prdata_RUS_100kb$CL)


prplot_RUS_100kb <- ggplot(prdata_RUS_100kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##ROS
prall_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/op/RFE/prcurve.rds")

prall_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/all/RFE/prcurve.rds")
prdist_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/Distance/RFE/prcurve.rds")
proc_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/oc/RFE/prcurve.rds")
prop_ROS_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/op/RFE/prcurve.rds")

prdata_ROS_100kb <- rbind.data.frame(prall_ROS$curve,
                                prdist_ROS$curve,
                                prop_ROS$curve,
                                proc_ROS$curve,
                                prall_ROS_k562$curve,
                                prdist_ROS_k562$curve,
                                prop_ROS_k562$curve,
                                proc_ROS_k562$curve)
names(prdata_ROS_100kb) <- c("Recall", "Precision", "Threshold")
prdata_ROS_100kb$Predictor <- c(rep("All", dim(prall_ROS$curve)[1]),
                           rep("Distance", dim(prdist_ROS$curve)[1]),
                           rep("OP", dim(prop_ROS$curve)[1]),
                           rep("OC", dim(proc_ROS$curve)[1]),
                           rep("All", dim(prall_ROS_k562$curve)[1]),
                           rep("Distance", dim(prdist_ROS_k562$curve)[1]),
                           rep("OP", dim(prop_ROS_k562$curve)[1]),
                           rep("OC", dim(proc_ROS_k562$curve)[1]))
prdata_ROS_100kb$CL <- c(rep("GM12878", (dim(prall_ROS$curve)[1]+
                                      dim(prdist_ROS$curve)[1]+
                                      dim(prop_ROS$curve)[1]+
                                      dim(proc_ROS$curve)[1])),
                    rep("K562", (dim(prall_ROS_k562$curve)[1]+
                                      dim(prdist_ROS_k562$curve)[1]+
                                      dim(prop_ROS_k562$curve)[1]+
                                      dim(proc_ROS_k562$curve)[1])))
prdata_ROS_100kb$Predictor <- factor(prdata_ROS_100kb$Predictor)
prdata_ROS_100kb$CL <- factor(prdata_ROS_100kb$CL)


prplot_ROS_100kb <- ggplot(prdata_ROS_100kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()


##SMOTE
prall_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

prall_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/all/RFE/prcurve.rds")
prdist_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")
proc_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/oc/RFE/prcurve.rds")
prop_SMOTE_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/op/RFE/prcurve.rds")

prdata_SMOTE_100kb <- rbind.data.frame(prall_SMOTE$curve,
                                prdist_SMOTE$curve,
                                prop_SMOTE$curve,
                                proc_SMOTE$curve,
                                prall_SMOTE_k562$curve,
                                prdist_SMOTE_k562$curve,
                                prop_SMOTE_k562$curve,
                                proc_SMOTE_k562$curve)
names(prdata_SMOTE_100kb) <- c("Recall", "Precision", "Threshold")
prdata_SMOTE_100kb$Predictor <- c(rep("All", dim(prall_SMOTE$curve)[1]),
                           rep("Distance", dim(prdist_SMOTE$curve)[1]),
                           rep("OP", dim(prop_SMOTE$curve)[1]),
                           rep("OC", dim(proc_SMOTE$curve)[1]),
                           rep("All", dim(prall_SMOTE_k562$curve)[1]),
                           rep("Distance", dim(prdist_SMOTE_k562$curve)[1]),
                           rep("OP", dim(prop_SMOTE_k562$curve)[1]),
                           rep("OC", dim(proc_SMOTE_k562$curve)[1]))
prdata_SMOTE_100kb$CL <- c(rep("GM12878", (dim(prall_SMOTE$curve)[1]+
                                      dim(prdist_SMOTE$curve)[1]+
                                      dim(prop_SMOTE$curve)[1]+
                                      dim(proc_SMOTE$curve)[1])),
                    rep("K562", (dim(prall_SMOTE_k562$curve)[1]+
                                      dim(prdist_SMOTE_k562$curve)[1]+
                                      dim(prop_SMOTE_k562$curve)[1]+
                                      dim(proc_SMOTE_k562$curve)[1])))
prdata_SMOTE_100kb$Predictor <- factor(prdata_SMOTE_100kb$Predictor)
prdata_SMOTE_100kb$CL <- factor(prdata_SMOTE_100kb$CL)


prplot_SMOTE_100kb <- ggplot(prdata_SMOTE_100kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()

##ROSE
prall_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/op/RFE/prcurve.rds")

prall_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/all/RFE/prcurve.rds")
prdist_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")
proc_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/oc/RFE/prcurve.rds")
prop_ROSE_k562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/op/RFE/prcurve.rds")

prdata_ROSE_100kb <- rbind.data.frame(prall_ROSE$curve,
                                prdist_ROSE$curve,
                                prop_ROSE$curve,
                                proc_ROSE$curve,
                                prall_ROSE_k562$curve,
                                prdist_ROSE_k562$curve,
                                prop_ROSE_k562$curve,
                                proc_ROSE_k562$curve)
names(prdata_ROSE_100kb) <- c("Recall", "Precision", "Threshold")
prdata_ROSE_100kb$Predictor <- c(rep("All", dim(prall_ROSE$curve)[1]),
                           rep("Distance", dim(prdist_ROSE$curve)[1]),
                           rep("OP", dim(prop_ROSE$curve)[1]),
                           rep("OC", dim(proc_ROSE$curve)[1]),
                           rep("All", dim(prall_ROSE_k562$curve)[1]),
                           rep("Distance", dim(prdist_ROSE_k562$curve)[1]),
                           rep("OP", dim(prop_ROSE_k562$curve)[1]),
                           rep("OC", dim(proc_ROSE_k562$curve)[1]))
prdata_ROSE_100kb$CL <- c(rep("GM12878", (dim(prall_ROSE$curve)[1]+
                                      dim(prdist_ROSE$curve)[1]+
                                      dim(prop_ROSE$curve)[1]+
                                      dim(proc_ROSE$curve)[1])),
                    rep("K562", (dim(prall_ROSE_k562$curve)[1]+
                                      dim(prdist_ROSE_k562$curve)[1]+
                                      dim(prop_ROSE_k562$curve)[1]+
                                      dim(proc_ROSE_k562$curve)[1])))
prdata_ROSE_100kb$Predictor <- factor(prdata_ROSE_100kb$Predictor)
prdata_ROSE_100kb$CL <- factor(prdata_ROSE_100kb$CL)


prplot_ROSE_100kb <- ggplot(prdata_ROSE_100kb, aes(x=Recall, y=Precision, color=Predictor, linetype=CL)) +
  geom_line(size=.75)+
  scale_linetype_manual(name=("Cell Line"), values=c("solid", "dashed"))+
  scale_color_discrete(name = "Predictor Type") +
  theme_minimal()+
  theme_bw()

###############################################################

##Collecting 25kb, 50kb, and 100kb plots

ggarrange(prplot_None_25kb, prplot_None_50kb, prplot_None_100kb,
          prplot_RUS_25kb, prplot_RUS_50kb, prplot_RUS_100kb,
          prplot_ROS_25kb, prplot_ROS_50kb, prplot_ROS_100kb,
          prplot_SMOTE_25kb, prplot_SMOTE_50kb, prplot_SMOTE_100kb,
          prplot_ROSE_25kb, prplot_ROSE_50kb, prplot_ROSE_100kb,
          ncol=3,
          nrow=5,
          common.legend = TRUE,
          legend = "right")
```

##Tables of AUPRC

```{r}

gm12878_10kb_none_oc <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/OC/RFE/prcurve.rds")$auc.integral
gm12878_10kb_rus_oc <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/OC/RFE/prcurve.rds")$auc.integral
gm12878_10kb_ros_oc <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/OC/RFE/prcurve.rds")$auc.integral
gm12878_10kb_smote_oc <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/OC/RFE/prcurve.rds")$auc.integral
gm12878_10kb_rose_oc <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/OC/RFE/prcurve.rds")$auc.integral

gm12878_25kb_none_oc <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/OC/RFE/prcurve.rds")$auc.integral
gm12878_25kb_rus_oc <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/OC/RFE/prcurve.rds")$auc.integral
gm12878_25kb_ros_oc <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/OC/RFE/prcurve.rds")$auc.integral
gm12878_25kb_smote_oc <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/OC/RFE/prcurve.rds")$auc.integral
gm12878_25kb_rose_oc <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/OC/RFE/prcurve.rds")$auc.integral

gm12878_50kb_none_oc <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/OC/RFE/prcurve.rds")$auc.integral
gm12878_50kb_rus_oc <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/OC/RFE/prcurve.rds")$auc.integral
gm12878_50kb_ros_oc <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/OC/RFE/prcurve.rds")$auc.integral
gm12878_50kb_smote_oc <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/OC/RFE/prcurve.rds")$auc.integral
gm12878_50kb_rose_oc <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/OC/RFE/prcurve.rds")$auc.integral

gm12878_100kb_none_oc <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/OC/RFE/prcurve.rds")$auc.integral
gm12878_100kb_rus_oc <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/OC/RFE/prcurve.rds")$auc.integral
gm12878_100kb_ros_oc <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/OC/RFE/prcurve.rds")$auc.integral
gm12878_100kb_smote_oc <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/OC/RFE/prcurve.rds")$auc.integral
gm12878_100kb_rose_oc <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/OC/RFE/prcurve.rds")$auc.integral

K562_10kb_none_oc <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/OC/RFE/prcurve.rds")$auc.integral
K562_10kb_rus_oc <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/OC/RFE/prcurve.rds")$auc.integral
K562_10kb_ros_oc <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/OC/RFE/prcurve.rds")$auc.integral
K562_10kb_smote_oc <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/OC/RFE/prcurve.rds")$auc.integral
K562_10kb_rose_oc <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/OC/RFE/prcurve.rds")$auc.integral

K562_25kb_none_oc <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/OC/RFE/prcurve.rds")$auc.integral
K562_25kb_rus_oc <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/OC/RFE/prcurve.rds")$auc.integral
K562_25kb_ros_oc <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/OC/RFE/prcurve.rds")$auc.integral
K562_25kb_smote_oc <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/OC/RFE/prcurve.rds")$auc.integral
K562_25kb_rose_oc <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/OC/RFE/prcurve.rds")$auc.integral

K562_50kb_none_oc <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/OC/RFE/prcurve.rds")$auc.integral
K562_50kb_rus_oc <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/OC/RFE/prcurve.rds")$auc.integral
K562_50kb_ros_oc <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/OC/RFE/prcurve.rds")$auc.integral
K562_50kb_smote_oc <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/OC/RFE/prcurve.rds")$auc.integral
K562_50kb_rose_oc <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/OC/RFE/prcurve.rds")$auc.integral

K562_100kb_none_oc <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/OC/RFE/prcurve.rds")$auc.integral
K562_100kb_rus_oc <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/OC/RFE/prcurve.rds")$auc.integral
K562_100kb_ros_oc <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/OC/RFE/prcurve.rds")$auc.integral
K562_100kb_smote_oc <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/OC/RFE/prcurve.rds")$auc.integral
K562_100kb_rose_oc <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/OC/RFE/prcurve.rds")$auc.integral

gm12878_10kb_none_OP <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/OP/RFE/prcurve.rds")$auc.integral
gm12878_10kb_rus_OP <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/OP/RFE/prcurve.rds")$auc.integral
gm12878_10kb_ros_OP <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/OP/RFE/prcurve.rds")$auc.integral
gm12878_10kb_smote_OP <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/OP/RFE/prcurve.rds")$auc.integral
gm12878_10kb_rose_OP <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/OP/RFE/prcurve.rds")$auc.integral

gm12878_25kb_none_OP <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/OP/RFE/prcurve.rds")$auc.integral
gm12878_25kb_rus_OP <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/OP/RFE/prcurve.rds")$auc.integral
gm12878_25kb_ros_OP <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/OP/RFE/prcurve.rds")$auc.integral
gm12878_25kb_smote_OP <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/OP/RFE/prcurve.rds")$auc.integral
gm12878_25kb_rose_OP <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/OP/RFE/prcurve.rds")$auc.integral

gm12878_50kb_none_OP <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/OP/RFE/prcurve.rds")$auc.integral
gm12878_50kb_rus_OP <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/OP/RFE/prcurve.rds")$auc.integral
gm12878_50kb_ros_OP <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/OP/RFE/prcurve.rds")$auc.integral
gm12878_50kb_smote_OP <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/OP/RFE/prcurve.rds")$auc.integral
gm12878_50kb_rose_OP <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/OP/RFE/prcurve.rds")$auc.integral

gm12878_100kb_none_OP <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/OP/RFE/prcurve.rds")$auc.integral
gm12878_100kb_rus_OP <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/OP/RFE/prcurve.rds")$auc.integral
gm12878_100kb_ros_OP <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/OP/RFE/prcurve.rds")$auc.integral
gm12878_100kb_smote_OP <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/OP/RFE/prcurve.rds")$auc.integral
gm12878_100kb_rose_OP <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/OP/RFE/prcurve.rds")$auc.integral

K562_10kb_none_OP <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/OP/RFE/prcurve.rds")$auc.integral
K562_10kb_rus_OP <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/OP/RFE/prcurve.rds")$auc.integral
K562_10kb_ros_OP <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/OP/RFE/prcurve.rds")$auc.integral
K562_10kb_smote_OP <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/OP/RFE/prcurve.rds")$auc.integral
K562_10kb_rose_OP <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/OP/RFE/prcurve.rds")$auc.integral

K562_25kb_none_OP <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/OP/RFE/prcurve.rds")$auc.integral
K562_25kb_rus_OP <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/OP/RFE/prcurve.rds")$auc.integral
K562_25kb_ros_OP <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/OP/RFE/prcurve.rds")$auc.integral
K562_25kb_smote_OP <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/OP/RFE/prcurve.rds")$auc.integral
K562_25kb_rose_OP <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/OP/RFE/prcurve.rds")$auc.integral

K562_50kb_none_OP <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/OP/RFE/prcurve.rds")$auc.integral
K562_50kb_rus_OP <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/OP/RFE/prcurve.rds")$auc.integral
K562_50kb_ros_OP <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/OP/RFE/prcurve.rds")$auc.integral
K562_50kb_smote_OP <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/OP/RFE/prcurve.rds")$auc.integral
K562_50kb_rose_OP <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/OP/RFE/prcurve.rds")$auc.integral

K562_100kb_none_OP <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/OP/RFE/prcurve.rds")$auc.integral
K562_100kb_rus_OP <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/OP/RFE/prcurve.rds")$auc.integral
K562_100kb_ros_OP <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/OP/RFE/prcurve.rds")$auc.integral
K562_100kb_smote_OP <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/OP/RFE/prcurve.rds")$auc.integral
K562_100kb_rose_OP <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/OP/RFE/prcurve.rds")$auc.integral

gm12878_10kb_none_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/Distance/RFE/prcurve.rds")$auc.integral
gm12878_10kb_rus_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/Distance/RFE/prcurve.rds")$auc.integral
gm12878_10kb_ros_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/Distance/RFE/prcurve.rds")$auc.integral
gm12878_10kb_smote_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")$auc.integral
gm12878_10kb_rose_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")$auc.integral

gm12878_25kb_none_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/Distance/RFE/prcurve.rds")$auc.integral
gm12878_25kb_rus_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/Distance/RFE/prcurve.rds")$auc.integral
gm12878_25kb_ros_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/Distance/RFE/prcurve.rds")$auc.integral
gm12878_25kb_smote_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")$auc.integral
gm12878_25kb_rose_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")$auc.integral

gm12878_50kb_none_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/Distance/RFE/prcurve.rds")$auc.integral
gm12878_50kb_rus_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/Distance/RFE/prcurve.rds")$auc.integral
gm12878_50kb_ros_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/Distance/RFE/prcurve.rds")$auc.integral
gm12878_50kb_smote_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")$auc.integral
gm12878_50kb_rose_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")$auc.integral

gm12878_100kb_none_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/Distance/RFE/prcurve.rds")$auc.integral
gm12878_100kb_rus_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/Distance/RFE/prcurve.rds")$auc.integral
gm12878_100kb_ros_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/Distance/RFE/prcurve.rds")$auc.integral
gm12878_100kb_smote_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")$auc.integral
gm12878_100kb_rose_Distance <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")$auc.integral

K562_10kb_none_Distance <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/Distance/RFE/prcurve.rds")$auc.integral
K562_10kb_rus_Distance <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/Distance/RFE/prcurve.rds")$auc.integral
K562_10kb_ros_Distance <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/Distance/RFE/prcurve.rds")$auc.integral
K562_10kb_smote_Distance <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")$auc.integral
K562_10kb_rose_Distance <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")$auc.integral

K562_25kb_none_Distance <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/Distance/RFE/prcurve.rds")$auc.integral
K562_25kb_rus_Distance <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/Distance/RFE/prcurve.rds")$auc.integral
K562_25kb_ros_Distance <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/Distance/RFE/prcurve.rds")$auc.integral
K562_25kb_smote_Distance <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")$auc.integral
K562_25kb_rose_Distance <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")$auc.integral

K562_50kb_none_Distance <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/Distance/RFE/prcurve.rds")$auc.integral
K562_50kb_rus_Distance <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/Distance/RFE/prcurve.rds")$auc.integral
K562_50kb_ros_Distance <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/Distance/RFE/prcurve.rds")$auc.integral
K562_50kb_smote_Distance <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")$auc.integral
K562_50kb_rose_Distance <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")$auc.integral

K562_100kb_none_Distance <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/Distance/RFE/prcurve.rds")$auc.integral
K562_100kb_rus_Distance <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/Distance/RFE/prcurve.rds")$auc.integral
K562_100kb_ros_Distance <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/Distance/RFE/prcurve.rds")$auc.integral
K562_100kb_smote_Distance <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/Distance/RFE/prcurve.rds")$auc.integral
K562_100kb_rose_Distance <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/Distance/RFE/prcurve.rds")$auc.integral

gm12878_10kb_none_all <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/all/RFE/prcurve.rds")$auc.integral
gm12878_10kb_rus_all <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/all/RFE/prcurve.rds")$auc.integral
gm12878_10kb_ros_all <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/all/RFE/prcurve.rds")$auc.integral
gm12878_10kb_smote_all <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/all/RFE/prcurve.rds")$auc.integral
gm12878_10kb_rose_all <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/all/RFE/prcurve.rds")$auc.integral

gm12878_25kb_none_all <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/all/RFE/prcurve.rds")$auc.integral
gm12878_25kb_rus_all <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/all/RFE/prcurve.rds")$auc.integral
gm12878_25kb_ros_all <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/all/RFE/prcurve.rds")$auc.integral
gm12878_25kb_smote_all <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/all/RFE/prcurve.rds")$auc.integral
gm12878_25kb_rose_all <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/all/RFE/prcurve.rds")$auc.integral

gm12878_50kb_none_all <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/all/RFE/prcurve.rds")$auc.integral
gm12878_50kb_rus_all <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/all/RFE/prcurve.rds")$auc.integral
gm12878_50kb_ros_all <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/all/RFE/prcurve.rds")$auc.integral
gm12878_50kb_smote_all <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/all/RFE/prcurve.rds")$auc.integral
gm12878_50kb_rose_all <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/all/RFE/prcurve.rds")$auc.integral

gm12878_100kb_none_all <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/all/RFE/prcurve.rds")$auc.integral
gm12878_100kb_rus_all <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/all/RFE/prcurve.rds")$auc.integral
gm12878_100kb_ros_all <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/all/RFE/prcurve.rds")$auc.integral
gm12878_100kb_smote_all <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/all/RFE/prcurve.rds")$auc.integral
gm12878_100kb_rose_all <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/all/RFE/prcurve.rds")$auc.integral

K562_10kb_none_all <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/all/RFE/prcurve.rds")$auc.integral
K562_10kb_rus_all <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/all/RFE/prcurve.rds")$auc.integral
K562_10kb_ros_all <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/all/RFE/prcurve.rds")$auc.integral
K562_10kb_smote_all <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/all/RFE/prcurve.rds")$auc.integral
K562_10kb_rose_all <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/all/RFE/prcurve.rds")$auc.integral

K562_25kb_none_all <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/all/RFE/prcurve.rds")$auc.integral
K562_25kb_rus_all <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/all/RFE/prcurve.rds")$auc.integral
K562_25kb_ros_all <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/all/RFE/prcurve.rds")$auc.integral
K562_25kb_smote_all <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/all/RFE/prcurve.rds")$auc.integral
K562_25kb_rose_all <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/all/RFE/prcurve.rds")$auc.integral

K562_50kb_none_all <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/all/RFE/prcurve.rds")$auc.integral
K562_50kb_rus_all <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/all/RFE/prcurve.rds")$auc.integral
K562_50kb_ros_all <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/all/RFE/prcurve.rds")$auc.integral
K562_50kb_smote_all <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/all/RFE/prcurve.rds")$auc.integral
K562_50kb_rose_all <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/all/RFE/prcurve.rds")$auc.integral

K562_100kb_none_all <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/all/RFE/prcurve.rds")$auc.integral
K562_100kb_rus_all <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/all/RFE/prcurve.rds")$auc.integral
K562_100kb_ros_all <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/all/RFE/prcurve.rds")$auc.integral
K562_100kb_smote_all <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/all/RFE/prcurve.rds")$auc.integral
K562_100kb_rose_all <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/all/RFE/prcurve.rds")$auc.integral

prcurvetable <- data.frame(CL=c(rep("GM12878", 20), rep("K562", 20)),
                           Resolution=c(c(rep("10 kb", 5), 
                                        rep("25 kb", 5),
                                        rep("50 kb", 5),
                                        rep("100 kb", 5)),
                                        c(rep("10 kb", 5), 
                                        rep("25 kb", 5),
                                        rep("50 kb", 5),
                                        rep("100 kb", 5))),
                           ReSampling=rep(c("None",
                                        "RUS",
                                        "ROS",
                                        "SMOTE",
                                        "ROSE"),8))
prcurvetable$OC <- c(gm12878_10kb_none_oc,
gm12878_10kb_rus_oc,
gm12878_10kb_ros_oc,
gm12878_10kb_smote_oc,
gm12878_10kb_rose_oc,
gm12878_25kb_none_oc,
gm12878_25kb_rus_oc,
gm12878_25kb_ros_oc,
gm12878_25kb_smote_oc,
gm12878_25kb_rose_oc,
gm12878_50kb_none_oc,
gm12878_50kb_rus_oc,
gm12878_50kb_ros_oc,
gm12878_50kb_smote_oc,
gm12878_50kb_rose_oc,
gm12878_100kb_none_oc,
gm12878_100kb_rus_oc,
gm12878_100kb_ros_oc,
gm12878_100kb_smote_oc,
gm12878_100kb_rose_oc,
K562_10kb_none_oc,
K562_10kb_rus_oc,
K562_10kb_ros_oc,
K562_10kb_smote_oc,
K562_10kb_rose_oc,
K562_25kb_none_oc,
K562_25kb_rus_oc,
K562_25kb_ros_oc,
K562_25kb_smote_oc,
K562_25kb_rose_oc,
K562_50kb_none_oc,
K562_50kb_rus_oc,
K562_50kb_ros_oc,
K562_50kb_smote_oc,
K562_50kb_rose_oc,
K562_100kb_none_oc,
K562_100kb_rus_oc,
K562_100kb_ros_oc,
K562_100kb_smote_oc,
K562_100kb_rose_oc)

prcurvetable$OP <- c(gm12878_10kb_none_OP,
gm12878_10kb_rus_OP,
gm12878_10kb_ros_OP,
gm12878_10kb_smote_OP,
gm12878_10kb_rose_OP,
gm12878_25kb_none_OP,
gm12878_25kb_rus_OP,
gm12878_25kb_ros_OP,
gm12878_25kb_smote_OP,
gm12878_25kb_rose_OP,
gm12878_50kb_none_OP,
gm12878_50kb_rus_OP,
gm12878_50kb_ros_OP,
gm12878_50kb_smote_OP,
gm12878_50kb_rose_OP,
gm12878_100kb_none_OP,
gm12878_100kb_rus_OP,
gm12878_100kb_ros_OP,
gm12878_100kb_smote_OP,
gm12878_100kb_rose_OP,
K562_10kb_none_OP,
K562_10kb_rus_OP,
K562_10kb_ros_OP,
K562_10kb_smote_OP,
K562_10kb_rose_OP,
K562_25kb_none_OP,
K562_25kb_rus_OP,
K562_25kb_ros_OP,
K562_25kb_smote_OP,
K562_25kb_rose_OP,
K562_50kb_none_OP,
K562_50kb_rus_OP,
K562_50kb_ros_OP,
K562_50kb_smote_OP,
K562_50kb_rose_OP,
K562_100kb_none_OP,
K562_100kb_rus_OP,
K562_100kb_ros_OP,
K562_100kb_smote_OP,
K562_100kb_rose_OP)

prcurvetable$Distance <- c(gm12878_10kb_none_Distance,
gm12878_10kb_rus_Distance,
gm12878_10kb_ros_Distance,
gm12878_10kb_smote_Distance,
gm12878_10kb_rose_Distance,
gm12878_25kb_none_Distance,
gm12878_25kb_rus_Distance,
gm12878_25kb_ros_Distance,
gm12878_25kb_smote_Distance,
gm12878_25kb_rose_Distance,
gm12878_50kb_none_Distance,
gm12878_50kb_rus_Distance,
gm12878_50kb_ros_Distance,
gm12878_50kb_smote_Distance,
gm12878_50kb_rose_Distance,
gm12878_100kb_none_Distance,
gm12878_100kb_rus_Distance,
gm12878_100kb_ros_Distance,
gm12878_100kb_smote_Distance,
gm12878_100kb_rose_Distance,
K562_10kb_none_Distance,
K562_10kb_rus_Distance,
K562_10kb_ros_Distance,
K562_10kb_smote_Distance,
K562_10kb_rose_Distance,
K562_25kb_none_Distance,
K562_25kb_rus_Distance,
K562_25kb_ros_Distance,
K562_25kb_smote_Distance,
K562_25kb_rose_Distance,
K562_50kb_none_Distance,
K562_50kb_rus_Distance,
K562_50kb_ros_Distance,
K562_50kb_smote_Distance,
K562_50kb_rose_Distance,
K562_100kb_none_Distance,
K562_100kb_rus_Distance,
K562_100kb_ros_Distance,
K562_100kb_smote_Distance,
K562_100kb_rose_Distance)

prcurvetable$All <- c(gm12878_10kb_none_all,
gm12878_10kb_rus_all,
gm12878_10kb_ros_all,
gm12878_10kb_smote_all,
gm12878_10kb_rose_all,
gm12878_25kb_none_all,
gm12878_25kb_rus_all,
gm12878_25kb_ros_all,
gm12878_25kb_smote_all,
gm12878_25kb_rose_all,
gm12878_50kb_none_all,
gm12878_50kb_rus_all,
gm12878_50kb_ros_all,
gm12878_50kb_smote_all,
gm12878_50kb_rose_all,
gm12878_100kb_none_all,
gm12878_100kb_rus_all,
gm12878_100kb_ros_all,
gm12878_100kb_smote_all,
gm12878_100kb_rose_all,
K562_10kb_none_all,
K562_10kb_rus_all,
K562_10kb_ros_all,
K562_10kb_smote_all,
K562_10kb_rose_all,
K562_25kb_none_all,
K562_25kb_rus_all,
K562_25kb_ros_all,
K562_25kb_smote_all,
K562_25kb_rose_all,
K562_50kb_none_all,
K562_50kb_rus_all,
K562_50kb_ros_all,
K562_50kb_smote_all,
K562_50kb_rose_all,
K562_100kb_none_all,
K562_100kb_rus_all,
K562_100kb_ros_all,
K562_100kb_smote_all,
K562_100kb_rose_all)



```


## RFE

###10kb

```{r}
rfeModel_None_dist <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/Distance/RFE/rfeModel_dist.rds")
rfeModel_RUS_dist <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROS_dist <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/Distance/RFE/rfeModel_dist.rds")
rfeModel_SMOTE_dist <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROSE_dist <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/Distance/RFE/rfeModel_dist.rds")

rfeModel_None_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/Distance/RFE/rfeModel_dist.rds")
rfeModel_RUS_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROS_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/Distance/RFE/rfeModel_dist.rds")
rfeModel_SMOTE_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROSE_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/Distance/RFE/rfeModel_dist.rds")

#None
resampdata_None_10kb <- rbind.data.frame(rfeModel_None_dist$results,rfeModel_None_dist_K562$results)
resampdata_None_10kb$CL <- c(rep("GM12878", dim(rfeModel_None_dist$results)[1]),
                             rep("K562", dim(rfeModel_None_dist_K562$results)[1]))

rfeplot_None_10kb <- ggplot(resampdata_None_10kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,.5)

#RUS
resampdata_RUS_10kb <- rbind.data.frame(rfeModel_RUS_dist$results,rfeModel_RUS_dist_K562$results)
resampdata_RUS_10kb$CL <- c(rep("GM12878", dim(rfeModel_RUS_dist$results)[1]),
                             rep("K562", dim(rfeModel_RUS_dist_K562$results)[1]))

rfeplot_RUS_10kb <- ggplot(resampdata_RUS_10kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#ROS
resampdata_ROS_10kb <- rbind.data.frame(rfeModel_ROS_dist$results,rfeModel_ROS_dist_K562$results)
resampdata_ROS_10kb$CL <- c(rep("GM12878", dim(rfeModel_ROS_dist$results)[1]),
                             rep("K562", dim(rfeModel_ROS_dist_K562$results)[1]))

rfeplot_ROS_10kb <- ggplot(resampdata_ROS_10kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#SMOTE
resampdata_SMOTE_10kb <- rbind.data.frame(rfeModel_SMOTE_dist$results,rfeModel_SMOTE_dist_K562$results)
resampdata_SMOTE_10kb$CL <- c(rep("GM12878", dim(rfeModel_SMOTE_dist$results)[1]),
                             rep("K562", dim(rfeModel_SMOTE_dist_K562$results)[1]))

rfeplot_SMOTE_10kb <- ggplot(resampdata_SMOTE_10kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#ROSE
resampdata_ROSE_10kb <- rbind.data.frame(rfeModel_ROSE_dist$results,rfeModel_ROSE_dist_K562$results)
resampdata_ROSE_10kb$CL <- c(rep("GM12878", dim(rfeModel_ROSE_dist$results)[1]),
                             rep("K562", dim(rfeModel_ROSE_dist_K562$results)[1]))

rfeplot_ROSE_10kb <- ggplot(resampdata_ROSE_10kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#Combining 10 kb plots
ggarrange(rfeplot_None_10kb,
          rfeplot_RUS_10kb,
          rfeplot_ROS_10kb,
          rfeplot_SMOTE_10kb,
          rfeplot_ROSE_10kb,
          nrow = 3,
          ncol = 2,
          common.legend = TRUE,
          legend = "right")

```

###25kb

```{r}
rfeModel_None_dist <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/Distance/RFE/rfeModel_dist.rds")
rfeModel_RUS_dist <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROS_dist <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/Distance/RFE/rfeModel_dist.rds")
rfeModel_SMOTE_dist <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROSE_dist <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/Distance/RFE/rfeModel_dist.rds")

rfeModel_None_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/Distance/RFE/rfeModel_dist.rds")
rfeModel_RUS_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROS_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/Distance/RFE/rfeModel_dist.rds")
rfeModel_SMOTE_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROSE_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/Distance/RFE/rfeModel_dist.rds")

#None
resampdata_None_25kb <- rbind.data.frame(rfeModel_None_dist$results,rfeModel_None_dist_K562$results)
resampdata_None_25kb$CL <- c(rep("GM12878", dim(rfeModel_None_dist$results)[1]),
                             rep("K562", dim(rfeModel_None_dist_K562$results)[1]))

rfeplot_None_25kb <- ggplot(resampdata_None_25kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,.5)

#RUS
resampdata_RUS_25kb <- rbind.data.frame(rfeModel_RUS_dist$results,rfeModel_RUS_dist_K562$results)
resampdata_RUS_25kb$CL <- c(rep("GM12878", dim(rfeModel_RUS_dist$results)[1]),
                             rep("K562", dim(rfeModel_RUS_dist_K562$results)[1]))

rfeplot_RUS_25kb <- ggplot(resampdata_RUS_25kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#ROS
resampdata_ROS_25kb <- rbind.data.frame(rfeModel_ROS_dist$results,rfeModel_ROS_dist_K562$results)
resampdata_ROS_25kb$CL <- c(rep("GM12878", dim(rfeModel_ROS_dist$results)[1]),
                             rep("K562", dim(rfeModel_ROS_dist_K562$results)[1]))

rfeplot_ROS_25kb <- ggplot(resampdata_ROS_25kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#SMOTE
resampdata_SMOTE_25kb <- rbind.data.frame(rfeModel_SMOTE_dist$results,rfeModel_SMOTE_dist_K562$results)
resampdata_SMOTE_25kb$CL <- c(rep("GM12878", dim(rfeModel_SMOTE_dist$results)[1]),
                             rep("K562", dim(rfeModel_SMOTE_dist_K562$results)[1]))

rfeplot_SMOTE_25kb <- ggplot(resampdata_SMOTE_25kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#ROSE
resampdata_ROSE_25kb <- rbind.data.frame(rfeModel_ROSE_dist$results,rfeModel_ROSE_dist_K562$results)
resampdata_ROSE_25kb$CL <- c(rep("GM12878", dim(rfeModel_ROSE_dist$results)[1]),
                             rep("K562", dim(rfeModel_ROSE_dist_K562$results)[1]))

rfeplot_ROSE_25kb <- ggplot(resampdata_ROSE_25kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

```

###50kb

```{r}
rfeModel_None_dist <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/Distance/RFE/rfeModel_dist.rds")
rfeModel_RUS_dist <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROS_dist <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/Distance/RFE/rfeModel_dist.rds")
rfeModel_SMOTE_dist <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROSE_dist <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/Distance/RFE/rfeModel_dist.rds")

rfeModel_None_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/Distance/RFE/rfeModel_dist.rds")
rfeModel_RUS_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROS_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/Distance/RFE/rfeModel_dist.rds")
rfeModel_SMOTE_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROSE_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/Distance/RFE/rfeModel_dist.rds")

#None
resampdata_None_50kb <- rbind.data.frame(rfeModel_None_dist$results,rfeModel_None_dist_K562$results)
resampdata_None_50kb$CL <- c(rep("GM12878", dim(rfeModel_None_dist$results)[1]),
                             rep("K562", dim(rfeModel_None_dist_K562$results)[1]))

rfeplot_None_50kb <- ggplot(resampdata_None_50kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,.5)

#RUS
resampdata_RUS_50kb <- rbind.data.frame(rfeModel_RUS_dist$results,rfeModel_RUS_dist_K562$results)
resampdata_RUS_50kb$CL <- c(rep("GM12878", dim(rfeModel_RUS_dist$results)[1]),
                             rep("K562", dim(rfeModel_RUS_dist_K562$results)[1]))

rfeplot_RUS_50kb <- ggplot(resampdata_RUS_50kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#ROS
resampdata_ROS_50kb <- rbind.data.frame(rfeModel_ROS_dist$results,rfeModel_ROS_dist_K562$results)
resampdata_ROS_50kb$CL <- c(rep("GM12878", dim(rfeModel_ROS_dist$results)[1]),
                             rep("K562", dim(rfeModel_ROS_dist_K562$results)[1]))

rfeplot_ROS_50kb <- ggplot(resampdata_ROS_50kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#SMOTE
resampdata_SMOTE_50kb <- rbind.data.frame(rfeModel_SMOTE_dist$results,rfeModel_SMOTE_dist_K562$results)
resampdata_SMOTE_50kb$CL <- c(rep("GM12878", dim(rfeModel_SMOTE_dist$results)[1]),
                             rep("K562", dim(rfeModel_SMOTE_dist_K562$results)[1]))

rfeplot_SMOTE_50kb <- ggplot(resampdata_SMOTE_50kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#ROSE
resampdata_ROSE_50kb <- rbind.data.frame(rfeModel_ROSE_dist$results,rfeModel_ROSE_dist_K562$results)
resampdata_ROSE_50kb$CL <- c(rep("GM12878", dim(rfeModel_ROSE_dist$results)[1]),
                             rep("K562", dim(rfeModel_ROSE_dist_K562$results)[1]))

rfeplot_ROSE_50kb <- ggplot(resampdata_ROSE_50kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)


```

###100kb

```{r}
rfeModel_None_dist <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/Distance/RFE/rfeModel_dist.rds")
rfeModel_RUS_dist <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROS_dist <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/Distance/RFE/rfeModel_dist.rds")
rfeModel_SMOTE_dist <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROSE_dist <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/Distance/RFE/rfeModel_dist.rds")

rfeModel_None_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/Distance/RFE/rfeModel_dist.rds")
rfeModel_RUS_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROS_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/Distance/RFE/rfeModel_dist.rds")
rfeModel_SMOTE_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/Distance/RFE/rfeModel_dist.rds")
rfeModel_ROSE_dist_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/Distance/RFE/rfeModel_dist.rds")

#None
resampdata_None_100kb <- rbind.data.frame(rfeModel_None_dist$results,rfeModel_None_dist_K562$results)
resampdata_None_100kb$CL <- c(rep("GM12878", dim(rfeModel_None_dist$results)[1]),
                             rep("K562", dim(rfeModel_None_dist_K562$results)[1]))

rfeplot_None_100kb <- ggplot(resampdata_None_100kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,.5)

#RUS
resampdata_RUS_100kb <- rbind.data.frame(rfeModel_RUS_dist$results,rfeModel_RUS_dist_K562$results)
resampdata_RUS_100kb$CL <- c(rep("GM12878", dim(rfeModel_RUS_dist$results)[1]),
                             rep("K562", dim(rfeModel_RUS_dist_K562$results)[1]))

rfeplot_RUS_100kb <- ggplot(resampdata_RUS_100kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#ROS
resampdata_ROS_100kb <- rbind.data.frame(rfeModel_ROS_dist$results,rfeModel_ROS_dist_K562$results)
resampdata_ROS_100kb$CL <- c(rep("GM12878", dim(rfeModel_ROS_dist$results)[1]),
                             rep("K562", dim(rfeModel_ROS_dist_K562$results)[1]))

rfeplot_ROS_100kb <- ggplot(resampdata_ROS_100kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#SMOTE
resampdata_SMOTE_100kb <- rbind.data.frame(rfeModel_SMOTE_dist$results,rfeModel_SMOTE_dist_K562$results)
resampdata_SMOTE_100kb$CL <- c(rep("GM12878", dim(rfeModel_SMOTE_dist$results)[1]),
                             rep("K562", dim(rfeModel_SMOTE_dist_K562$results)[1]))

rfeplot_SMOTE_100kb <- ggplot(resampdata_SMOTE_100kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

#ROSE
resampdata_ROSE_100kb <- rbind.data.frame(rfeModel_ROSE_dist$results,rfeModel_ROSE_dist_K562$results)
resampdata_ROSE_100kb$CL <- c(rep("GM12878", dim(rfeModel_ROSE_dist$results)[1]),
                             rep("K562", dim(rfeModel_ROSE_dist_K562$results)[1]))

rfeplot_ROSE_100kb <- ggplot(resampdata_ROSE_100kb, aes(x=Variables, y=AUPRC, color=CL)) +
  geom_point(position = position_dodge(width = 3))+
  geom_line() +
  geom_errorbar(aes(ymin=AUPRC-AUPRCSD, ymax=AUPRC+AUPRCSD), 
                width=5,
                position = position_dodge(width = 3))+
  scale_color_discrete(name="Cell Line")+
  scale_x_discrete(name="Number of Features", 
                   breaks=c("2", "4", "8", "16", "32", "64", "128"), 
                   labels=c("2", "4", "8", "16", "32", "64", "128"), 
                   limits=as.character(c(1:138)))+
  theme_minimal()#+
  #ylim(0,1)

```


### Combined

```{r}

ggarrange(rfeplot_None_25kb, rfeplot_None_50kb, rfeplot_None_100kb,
          rfeplot_RUS_25kb, rfeplot_RUS_50kb, rfeplot_RUS_100kb,
          rfeplot_ROS_25kb, rfeplot_ROS_50kb, rfeplot_ROS_100kb,
          rfeplot_SMOTE_25kb, rfeplot_SMOTE_50kb, rfeplot_SMOTE_100kb,
          rfeplot_ROSE_25kb, rfeplot_ROSE_50kb, rfeplot_ROSE_100kb,
          nrow = 5,
          ncol = 3,
          common.legend = TRUE,
          legend = "right")


```

## Evaluating Regularization

### GM12878

####10kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/train.rds")

features <- names(train)[-1]
features <- features[grep("dist", features)]
features <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "Gm12878", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", features)

#None
##OC
enetcoefs_none_oc_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_none_op_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_none_dist_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/Distance/ENET/enetcoefs.rds")

#RUS
##OC
enetcoefs_RUS_oc_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_RUS_op_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_RUS_dist_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/Distance/ENET/enetcoefs.rds")

#ROS
##OC
enetcoefs_ROS_oc_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_ROS_op_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_ROS_dist_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/Distance/ENET/enetcoefs.rds")

#SMOTE
##OC
enetcoefs_SMOTE_oc_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_SMOTE_op_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_SMOTE_dist_10kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/Distance/ENET/enetcoefs.rds")

enetcoefslist <- list(enetcoefs_none_oc_10kb_gm12878, 
                      enetcoefs_none_op_10kb_gm12878, 
                      enetcoefs_none_dist_10kb_gm12878,
                      enetcoefs_RUS_oc_10kb_gm12878, 
                      enetcoefs_RUS_op_10kb_gm12878, 
                      enetcoefs_RUS_dist_10kb_gm12878,
                      enetcoefs_ROS_oc_10kb_gm12878, 
                      enetcoefs_ROS_op_10kb_gm12878, 
                      enetcoefs_ROS_dist_10kb_gm12878,
                      enetcoefs_SMOTE_oc_10kb_gm12878, 
                      enetcoefs_SMOTE_op_10kb_gm12878, 
                      enetcoefs_SMOTE_dist_10kb_gm12878)

enetcoefslist <- lapply(enetcoefslist, function(x){gsub(paste(c("_dist", "_perc", "_count"), collapse = "|"), "", x)})

featuremat_10kb <- array(NA, dim=c(length(features),12), dimnames = list("Features"=features,
                                                                    "Predictor Type"=rep(c("OC",
                                                                                         "OP", 
                                                                                         "Distance"),4)))


for(j in 1:length(enetcoefslist)){
    featuremat_10kb[,j] <- ifelse(features %in% enetcoefslist[[j]], 1, 0)
}

#using lattice
levelplot(t(featuremat_10kb), 
          colorkey=FALSE, 
          scales=list(x=list(rot=45),
                      alternating=3), 
          col.regions=c("white", "red"),
          aspect="fill",panel = function(...){
            panel.levelplot(...)
            panel.abline(v = 3.5);
            panel.abline(v = 6.5);
            panel.abline(v = 9.5);
          },
          xlab="",
          ylab="")
grid.text("None",x=unit(.27,"npc"),y=unit(.95, "npc"))
grid.text("RUS",x=unit(.43,"npc"),y=unit(.95, "npc"))
grid.text("ROS",x=unit(.59,"npc"),y=unit(.95, "npc"))
grid.text("SMOTE",x=unit(.75,"npc"),y=unit(.95, "npc"))

featuredf <- data.frame(featuremat_10kb)
featuredf$Feature <- rownames(featuredf)
rownames(featuredf) <- NULL
featuredf <- featuredf[,c(13,1:12)]
names(featuredf) <- c("Feature",
                      "None.OC", "None.OP", "None.Distance",
                      "RUS.OC", "RUS.OP", "RUS.Distance",
                      "ROS.OC", "ROS.OP", "ROS.Distance",
                      "SMOTE.OC", "SMOTE.OP", "SMOTE.Distance")

x <- melt(featuredf, id.vars = 1)


```

####25kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/training_testing/train.rds")

features <- names(train)[-1]
features <- features[grep("dist", features)]
features <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "Gm12878", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", features)

#None
##OC
enetcoefs_none_oc_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_none_op_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_none_dist_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/Distance/ENET/enetcoefs.rds")

#RUS
##OC
enetcoefs_RUS_oc_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_RUS_op_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_RUS_dist_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/Distance/ENET/enetcoefs.rds")

#ROS
##OC
enetcoefs_ROS_oc_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_ROS_op_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_ROS_dist_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/Distance/ENET/enetcoefs.rds")

#SMOTE
##OC
enetcoefs_SMOTE_oc_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_SMOTE_op_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_SMOTE_dist_25kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/Distance/ENET/enetcoefs.rds")

enetcoefslist <- list(enetcoefs_none_oc_25kb_gm12878, 
                      enetcoefs_none_op_25kb_gm12878, 
                      enetcoefs_none_dist_25kb_gm12878,
                      enetcoefs_RUS_oc_25kb_gm12878, 
                      enetcoefs_RUS_op_25kb_gm12878, 
                      enetcoefs_RUS_dist_25kb_gm12878,
                      enetcoefs_ROS_oc_25kb_gm12878, 
                      enetcoefs_ROS_op_25kb_gm12878, 
                      enetcoefs_ROS_dist_25kb_gm12878,
                      enetcoefs_SMOTE_oc_25kb_gm12878, 
                      enetcoefs_SMOTE_op_25kb_gm12878, 
                      enetcoefs_SMOTE_dist_25kb_gm12878)

enetcoefslist <- lapply(enetcoefslist, function(x){gsub(paste(c("_dist", "_perc", "_count"), collapse = "|"), "", x)})

featuremat_25kb <- array(NA, dim=c(length(features),12), dimnames = list("Features"=features,
                                                                    "Predictor Type"=rep(c("OC",
                                                                                         "OP", 
                                                                                         "Distance"),4)))


for(j in 1:length(enetcoefslist)){
    featuremat_25kb[,j] <- ifelse(features %in% enetcoefslist[[j]], 1, 0)
}

#using lattice
levelplot(t(featuremat_25kb), 
          colorkey=FALSE, 
          scales=list(x=list(rot=45),
                      alternating=3), 
          col.regions=c("white", "red"),
          aspect="fill",panel = function(...){
            panel.levelplot(...)
            panel.abline(v = 3.5);
            panel.abline(v = 6.5);
            panel.abline(v = 9.5);
          },
          xlab="",
          ylab="")
grid.text("None",x=unit(.27,"npc"),y=unit(.95, "npc"))
grid.text("RUS",x=unit(.43,"npc"),y=unit(.95, "npc"))
grid.text("ROS",x=unit(.59,"npc"),y=unit(.95, "npc"))
grid.text("SMOTE",x=unit(.75,"npc"),y=unit(.95, "npc"))

featuredf <- data.frame(featuremat_25kb)
featuredf$Feature <- rownames(featuredf)
rownames(featuredf) <- NULL
featuredf <- featuredf[,c(13,1:12)]
names(featuredf) <- c("Feature",
                      "None.OC", "None.OP", "None.Distance",
                      "RUS.OC", "RUS.OP", "RUS.Distance",
                      "ROS.OC", "ROS.OP", "ROS.Distance",
                      "SMOTE.OC", "SMOTE.OP", "SMOTE.Distance")

x <- melt(featuredf, id.vars = 1)


```

####50kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/training_testing/train.rds")

features <- names(train)[-1]
features <- features[grep("dist", features)]
features <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "Gm12878", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", features)

#None
##OC
enetcoefs_none_oc_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_none_op_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_none_dist_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/Distance/ENET/enetcoefs.rds")

#RUS
##OC
enetcoefs_RUS_oc_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_RUS_op_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_RUS_dist_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/Distance/ENET/enetcoefs.rds")

#ROS
##OC
enetcoefs_ROS_oc_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_ROS_op_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_ROS_dist_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/Distance/ENET/enetcoefs.rds")

#SMOTE
##OC
enetcoefs_SMOTE_oc_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_SMOTE_op_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_SMOTE_dist_50kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/Distance/ENET/enetcoefs.rds")

enetcoefslist <- list(enetcoefs_none_oc_50kb_gm12878, 
                      enetcoefs_none_op_50kb_gm12878, 
                      enetcoefs_none_dist_50kb_gm12878,
                      enetcoefs_RUS_oc_50kb_gm12878, 
                      enetcoefs_RUS_op_50kb_gm12878, 
                      enetcoefs_RUS_dist_50kb_gm12878,
                      enetcoefs_ROS_oc_50kb_gm12878, 
                      enetcoefs_ROS_op_50kb_gm12878, 
                      enetcoefs_ROS_dist_50kb_gm12878,
                      enetcoefs_SMOTE_oc_50kb_gm12878, 
                      enetcoefs_SMOTE_op_50kb_gm12878, 
                      enetcoefs_SMOTE_dist_50kb_gm12878)

enetcoefslist <- lapply(enetcoefslist, function(x){gsub(paste(c("_dist", "_perc", "_count"), collapse = "|"), "", x)})

featuremat_50kb <- array(NA, dim=c(length(features),12), dimnames = list("Features"=features,
                                                                    "Predictor Type"=rep(c("OC",
                                                                                         "OP", 
                                                                                         "Distance"),4)))


for(j in 1:length(enetcoefslist)){
    featuremat_50kb[,j] <- ifelse(features %in% enetcoefslist[[j]], 1, 0)
}

#using lattice
levelplot(t(featuremat_50kb), 
          colorkey=FALSE, 
          scales=list(x=list(rot=45),
                      alternating=3), 
          col.regions=c("white", "red"),
          aspect="fill",panel = function(...){
            panel.levelplot(...)
            panel.abline(v = 3.5);
            panel.abline(v = 6.5);
            panel.abline(v = 9.5);
          },
          xlab="",
          ylab="")
grid.text("None",x=unit(.27,"npc"),y=unit(.95, "npc"))
grid.text("RUS",x=unit(.43,"npc"),y=unit(.95, "npc"))
grid.text("ROS",x=unit(.59,"npc"),y=unit(.95, "npc"))
grid.text("SMOTE",x=unit(.75,"npc"),y=unit(.95, "npc"))

featuredf <- data.frame(featuremat_50kb)
featuredf$Feature <- rownames(featuredf)
rownames(featuredf) <- NULL
featuredf <- featuredf[,c(13,1:12)]
names(featuredf) <- c("Feature",
                      "None.OC", "None.OP", "None.Distance",
                      "RUS.OC", "RUS.OP", "RUS.Distance",
                      "ROS.OC", "ROS.OP", "ROS.Distance",
                      "SMOTE.OC", "SMOTE.OP", "SMOTE.Distance")

x <- melt(featuredf, id.vars = 1)


```

####100kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/training_testing/train.rds")

features <- names(train)[-1]
features <- features[grep("dist", features)]
features <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "Gm12878", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", features)

#None
##OC
enetcoefs_none_oc_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_none_op_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_none_dist_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/Distance/ENET/enetcoefs.rds")

#RUS
##OC
enetcoefs_RUS_oc_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_RUS_op_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_RUS_dist_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/Distance/ENET/enetcoefs.rds")

#ROS
##OC
enetcoefs_ROS_oc_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_ROS_op_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_ROS_dist_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/Distance/ENET/enetcoefs.rds")

#SMOTE
##OC
enetcoefs_SMOTE_oc_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_SMOTE_op_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_SMOTE_dist_100kb_gm12878 <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/Distance/ENET/enetcoefs.rds")

enetcoefslist <- list(enetcoefs_none_oc_100kb_gm12878, 
                      enetcoefs_none_op_100kb_gm12878, 
                      enetcoefs_none_dist_100kb_gm12878,
                      enetcoefs_RUS_oc_100kb_gm12878, 
                      enetcoefs_RUS_op_100kb_gm12878, 
                      enetcoefs_RUS_dist_100kb_gm12878,
                      enetcoefs_ROS_oc_100kb_gm12878, 
                      enetcoefs_ROS_op_100kb_gm12878, 
                      enetcoefs_ROS_dist_100kb_gm12878,
                      enetcoefs_SMOTE_oc_100kb_gm12878, 
                      enetcoefs_SMOTE_op_100kb_gm12878, 
                      enetcoefs_SMOTE_dist_100kb_gm12878)

enetcoefslist <- lapply(enetcoefslist, function(x){gsub(paste(c("_dist", "_perc", "_count"), collapse = "|"), "", x)})

featuremat_100kb <- array(NA, dim=c(length(features),12), dimnames = list("Features"=features,
                                                                    "Predictor Type"=rep(c("OC",
                                                                                         "OP", 
                                                                                         "Distance"),4)))


for(j in 1:length(enetcoefslist)){
    featuremat_100kb[,j] <- ifelse(features %in% enetcoefslist[[j]], 1, 0)
}

#using lattice
levelplot(t(featuremat_100kb), 
          colorkey=FALSE, 
          scales=list(x=list(rot=45),
                      alternating=3), 
          col.regions=c("white", "red"),
          aspect="fill",panel = function(...){
            panel.levelplot(...)
            panel.abline(v = 3.5);
            panel.abline(v = 6.5);
            panel.abline(v = 9.5);
          },
          xlab="",
          ylab="")
grid.text("None",x=unit(.27,"npc"),y=unit(.95, "npc"))
grid.text("RUS",x=unit(.43,"npc"),y=unit(.95, "npc"))
grid.text("ROS",x=unit(.59,"npc"),y=unit(.95, "npc"))
grid.text("SMOTE",x=unit(.75,"npc"),y=unit(.95, "npc"))

featuredf <- data.frame(featuremat_100kb)
featuredf$Feature <- rownames(featuredf)
rownames(featuredf) <- NULL
featuredf <- featuredf[,c(13,1:12)]
names(featuredf) <- c("Feature",
                      "None.OC", "None.OP", "None.Distance",
                      "RUS.OC", "RUS.OP", "RUS.Distance",
                      "ROS.OC", "ROS.OP", "ROS.Distance",
                      "SMOTE.OC", "SMOTE.OP", "SMOTE.Distance")

x <- melt(featuredf, id.vars = 1)


```

####Combined

```{r}
all_featuremat_gm12878 <- cbind(featuremat_10kb,featuremat_25kb,featuremat_50kb,featuremat_100kb)
levelplot(t(all_featuremat_gm12878), 
          colorkey=FALSE, 
          scales=list(x=list(rot=45, cex=.5),
                      alternating=3,
                      y=list(cex=.7)), 
          col.regions=c("white", "red"),
          aspect="fill",panel = function(...){
            panel.levelplot(...)
            panel.abline(v = 1.5, lty = "dashed");
            panel.abline(v = 2.5, lty = "dashed");
            panel.abline(v = 3.5);
            panel.abline(v = 4.5, lty = "dashed");
            panel.abline(v = 5.5, lty = "dashed");
            panel.abline(v = 6.5);
            panel.abline(v = 7.5, lty = "dashed");
            panel.abline(v = 8.5, lty = "dashed");
            panel.abline(v = 9.5);
            panel.abline(v = 10.5, lty = "dashed");
            panel.abline(v = 11.5, lty = "dashed");
            panel.abline(v = 12.5, col="yellow");
            panel.abline(v = 13.5, lty = "dashed");
            panel.abline(v = 14.5, lty = "dashed");
            panel.abline(v = 15.5);
            panel.abline(v = 16.5, lty = "dashed");
            panel.abline(v = 17.5, lty = "dashed");
            panel.abline(v = 18.5);
            panel.abline(v = 19.5, lty = "dashed");
            panel.abline(v = 20.5, lty = "dashed");
            panel.abline(v = 21.5);
            panel.abline(v = 22.5, lty = "dashed");
            panel.abline(v = 23.5, lty = "dashed");
            panel.abline(v = 24.5, col="yellow");
            panel.abline(v = 25.5, lty = "dashed");
            panel.abline(v = 26.5, lty = "dashed");
            panel.abline(v = 27.5);
            panel.abline(v = 28.5, lty = "dashed");
            panel.abline(v = 29.5, lty = "dashed");
            panel.abline(v = 30.5);
            panel.abline(v = 31.5, lty = "dashed");
            panel.abline(v = 32.5, lty = "dashed");
            panel.abline(v = 33.5);
            panel.abline(v = 34.5, lty = "dashed");
            panel.abline(v = 35.5, lty = "dashed");
            panel.abline(v = 36.5, col="yellow");
            panel.abline(v = 37.5, lty = "dashed");
            panel.abline(v = 38.5, lty = "dashed");
            panel.abline(v = 39.5);
            panel.abline(v = 40.5, lty = "dashed");
            panel.abline(v = 41.5, lty = "dashed");
            panel.abline(v = 42.5);
            panel.abline(v = 43.5, lty = "dashed");
            panel.abline(v = 44.5, lty = "dashed");
            panel.abline(v = 45.5);
            panel.abline(v = 46.5, lty = "dashed");
            panel.abline(v = 47.5, lty = "dashed");
          },
          xlab="",
          ylab="")
```

### K562

####10kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/train.rds")

features <- names(train)[-1]
features <- features[grep("dist", features)]
features <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "K562", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", features)

#None
##OC
enetcoefs_none_oc_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_none_op_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_none_dist_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/Distance/ENET/enetcoefs.rds")

#RUS
##OC
enetcoefs_RUS_oc_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_RUS_op_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_RUS_dist_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/Distance/ENET/enetcoefs.rds")

#ROS
##OC
enetcoefs_ROS_oc_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_ROS_op_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_ROS_dist_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/Distance/ENET/enetcoefs.rds")

#SMOTE
##OC
enetcoefs_SMOTE_oc_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_SMOTE_op_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_SMOTE_dist_10kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/Distance/ENET/enetcoefs.rds")

enetcoefslist <- list(enetcoefs_none_oc_10kb_K562, 
                      enetcoefs_none_op_10kb_K562, 
                      enetcoefs_none_dist_10kb_K562,
                      enetcoefs_RUS_oc_10kb_K562, 
                      enetcoefs_RUS_op_10kb_K562, 
                      enetcoefs_RUS_dist_10kb_K562,
                      enetcoefs_ROS_oc_10kb_K562, 
                      enetcoefs_ROS_op_10kb_K562, 
                      enetcoefs_ROS_dist_10kb_K562,
                      enetcoefs_SMOTE_oc_10kb_K562, 
                      enetcoefs_SMOTE_op_10kb_K562, 
                      enetcoefs_SMOTE_dist_10kb_K562)

enetcoefslist <- lapply(enetcoefslist, function(x){gsub(paste(c("_dist", "_perc", "_count"), collapse = "|"), "", x)})

featuremat_10kb <- array(NA, dim=c(length(features),12), dimnames = list("Features"=features,
                                                                    "Predictor Type"=rep(c("OC",
                                                                                         "OP", 
                                                                                         "Distance"),4)))


for(j in 1:length(enetcoefslist)){
    featuremat_10kb[,j] <- ifelse(features %in% enetcoefslist[[j]], 1, 0)
}

#using lattice
levelplot(t(featuremat_10kb), 
          colorkey=FALSE, 
          scales=list(x=list(rot=45),
                      alternating=3), 
          col.regions=c("white", "red"),
          aspect="fill",panel = function(...){
            panel.levelplot(...)
            panel.abline(v = 3.5);
            panel.abline(v = 6.5);
            panel.abline(v = 9.5);
          },
          xlab="",
          ylab="")
grid.text("None",x=unit(.27,"npc"),y=unit(.95, "npc"))
grid.text("RUS",x=unit(.43,"npc"),y=unit(.95, "npc"))
grid.text("ROS",x=unit(.59,"npc"),y=unit(.95, "npc"))
grid.text("SMOTE",x=unit(.75,"npc"),y=unit(.95, "npc"))

featuredf <- data.frame(featuremat_10kb)
featuredf$Feature <- rownames(featuredf)
rownames(featuredf) <- NULL
featuredf <- featuredf[,c(13,1:12)]
names(featuredf) <- c("Feature",
                      "None.OC", "None.OP", "None.Distance",
                      "RUS.OC", "RUS.OP", "RUS.Distance",
                      "ROS.OC", "ROS.OP", "ROS.Distance",
                      "SMOTE.OC", "SMOTE.OP", "SMOTE.Distance")

x <- melt(featuredf, id.vars = 1)


```

####25kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/K562/25kb/training_testing/train.rds")

features <- names(train)[-1]
features <- features[grep("dist", features)]
features <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "K562", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", features)

#None
##OC
enetcoefs_none_oc_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_none_op_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_none_dist_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/Distance/ENET/enetcoefs.rds")

#RUS
##OC
enetcoefs_RUS_oc_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_RUS_op_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_RUS_dist_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/Distance/ENET/enetcoefs.rds")

#ROS
##OC
enetcoefs_ROS_oc_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_ROS_op_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_ROS_dist_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/Distance/ENET/enetcoefs.rds")

#SMOTE
##OC
enetcoefs_SMOTE_oc_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_SMOTE_op_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_SMOTE_dist_25kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/Distance/ENET/enetcoefs.rds")

enetcoefslist <- list(enetcoefs_none_oc_25kb_K562, 
                      enetcoefs_none_op_25kb_K562, 
                      enetcoefs_none_dist_25kb_K562,
                      enetcoefs_RUS_oc_25kb_K562, 
                      enetcoefs_RUS_op_25kb_K562, 
                      enetcoefs_RUS_dist_25kb_K562,
                      enetcoefs_ROS_oc_25kb_K562, 
                      enetcoefs_ROS_op_25kb_K562, 
                      enetcoefs_ROS_dist_25kb_K562,
                      enetcoefs_SMOTE_oc_25kb_K562, 
                      enetcoefs_SMOTE_op_25kb_K562, 
                      enetcoefs_SMOTE_dist_25kb_K562)

enetcoefslist <- lapply(enetcoefslist, function(x){gsub(paste(c("_dist", "_perc", "_count"), collapse = "|"), "", x)})

featuremat_25kb <- array(NA, dim=c(length(features),12), dimnames = list("Features"=features,
                                                                    "Predictor Type"=rep(c("OC",
                                                                                         "OP", 
                                                                                         "Distance"),4)))


for(j in 1:length(enetcoefslist)){
    featuremat_25kb[,j] <- ifelse(features %in% enetcoefslist[[j]], 1, 0)
}

#using lattice
levelplot(t(featuremat_25kb), 
          colorkey=FALSE, 
          scales=list(x=list(rot=45),
                      alternating=3), 
          col.regions=c("white", "red"),
          aspect="fill",panel = function(...){
            panel.levelplot(...)
            panel.abline(v = 3.5);
            panel.abline(v = 6.5);
            panel.abline(v = 9.5);
          },
          xlab="",
          ylab="")
grid.text("None",x=unit(.27,"npc"),y=unit(.95, "npc"))
grid.text("RUS",x=unit(.43,"npc"),y=unit(.95, "npc"))
grid.text("ROS",x=unit(.59,"npc"),y=unit(.95, "npc"))
grid.text("SMOTE",x=unit(.75,"npc"),y=unit(.95, "npc"))

featuredf <- data.frame(featuremat_25kb)
featuredf$Feature <- rownames(featuredf)
rownames(featuredf) <- NULL
featuredf <- featuredf[,c(13,1:12)]
names(featuredf) <- c("Feature",
                      "None.OC", "None.OP", "None.Distance",
                      "RUS.OC", "RUS.OP", "RUS.Distance",
                      "ROS.OC", "ROS.OP", "ROS.Distance",
                      "SMOTE.OC", "SMOTE.OP", "SMOTE.Distance")

x <- melt(featuredf, id.vars = 1)


```

####50kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/K562/50kb/training_testing/train.rds")

features <- names(train)[-1]
features <- features[grep("dist", features)]
features <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "K562", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", features)

#None
##OC
enetcoefs_none_oc_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_none_op_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_none_dist_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/Distance/ENET/enetcoefs.rds")

#RUS
##OC
enetcoefs_RUS_oc_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_RUS_op_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_RUS_dist_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/Distance/ENET/enetcoefs.rds")

#ROS
##OC
enetcoefs_ROS_oc_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_ROS_op_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_ROS_dist_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/Distance/ENET/enetcoefs.rds")

#SMOTE
##OC
enetcoefs_SMOTE_oc_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_SMOTE_op_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_SMOTE_dist_50kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/Distance/ENET/enetcoefs.rds")

enetcoefslist <- list(enetcoefs_none_oc_50kb_K562, 
                      enetcoefs_none_op_50kb_K562, 
                      enetcoefs_none_dist_50kb_K562,
                      enetcoefs_RUS_oc_50kb_K562, 
                      enetcoefs_RUS_op_50kb_K562, 
                      enetcoefs_RUS_dist_50kb_K562,
                      enetcoefs_ROS_oc_50kb_K562, 
                      enetcoefs_ROS_op_50kb_K562, 
                      enetcoefs_ROS_dist_50kb_K562,
                      enetcoefs_SMOTE_oc_50kb_K562, 
                      enetcoefs_SMOTE_op_50kb_K562, 
                      enetcoefs_SMOTE_dist_50kb_K562)

enetcoefslist <- lapply(enetcoefslist, function(x){gsub(paste(c("_dist", "_perc", "_count"), collapse = "|"), "", x)})

featuremat_50kb <- array(NA, dim=c(length(features),12), dimnames = list("Features"=features,
                                                                    "Predictor Type"=rep(c("OC",
                                                                                         "OP", 
                                                                                         "Distance"),4)))


for(j in 1:length(enetcoefslist)){
    featuremat_50kb[,j] <- ifelse(features %in% enetcoefslist[[j]], 1, 0)
}

#using lattice
levelplot(t(featuremat_50kb), 
          colorkey=FALSE, 
          scales=list(x=list(rot=45),
                      alternating=3), 
          col.regions=c("white", "red"),
          aspect="fill",panel = function(...){
            panel.levelplot(...)
            panel.abline(v = 3.5);
            panel.abline(v = 6.5);
            panel.abline(v = 9.5);
          },
          xlab="",
          ylab="")
grid.text("None",x=unit(.27,"npc"),y=unit(.95, "npc"))
grid.text("RUS",x=unit(.43,"npc"),y=unit(.95, "npc"))
grid.text("ROS",x=unit(.59,"npc"),y=unit(.95, "npc"))
grid.text("SMOTE",x=unit(.75,"npc"),y=unit(.95, "npc"))

featuredf <- data.frame(featuremat_50kb)
featuredf$Feature <- rownames(featuredf)
rownames(featuredf) <- NULL
featuredf <- featuredf[,c(13,1:12)]
names(featuredf) <- c("Feature",
                      "None.OC", "None.OP", "None.Distance",
                      "RUS.OC", "RUS.OP", "RUS.Distance",
                      "ROS.OC", "ROS.OP", "ROS.Distance",
                      "SMOTE.OC", "SMOTE.OP", "SMOTE.Distance")

x <- melt(featuredf, id.vars = 1)


```

####100kb

```{r}
train <- readRDS("Z:/TAD_data_analysis/K562/100kb/training_testing/train.rds")

features <- names(train)[-1]
features <- features[grep("dist", features)]
features <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "K562", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", features)

#None
##OC
enetcoefs_none_oc_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_none_op_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_none_dist_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/Distance/ENET/enetcoefs.rds")

#RUS
##OC
enetcoefs_RUS_oc_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_RUS_op_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_RUS_dist_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/Distance/ENET/enetcoefs.rds")

#ROS
##OC
enetcoefs_ROS_oc_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_ROS_op_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_ROS_dist_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/Distance/ENET/enetcoefs.rds")

#SMOTE
##OC
enetcoefs_SMOTE_oc_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/OC/ENET/enetcoefs.rds")
##OP
enetcoefs_SMOTE_op_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/OP/ENET/enetcoefs.rds")
##Distance
enetcoefs_SMOTE_dist_100kb_K562 <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/Distance/ENET/enetcoefs.rds")

enetcoefslist <- list(enetcoefs_none_oc_100kb_K562, 
                      enetcoefs_none_op_100kb_K562, 
                      enetcoefs_none_dist_100kb_K562,
                      enetcoefs_RUS_oc_100kb_K562, 
                      enetcoefs_RUS_op_100kb_K562, 
                      enetcoefs_RUS_dist_100kb_K562,
                      enetcoefs_ROS_oc_100kb_K562, 
                      enetcoefs_ROS_op_100kb_K562, 
                      enetcoefs_ROS_dist_100kb_K562,
                      enetcoefs_SMOTE_oc_100kb_K562, 
                      enetcoefs_SMOTE_op_100kb_K562, 
                      enetcoefs_SMOTE_dist_100kb_K562)

enetcoefslist <- lapply(enetcoefslist, function(x){gsub(paste(c("_dist", "_perc", "_count"), collapse = "|"), "", x)})

featuremat_100kb <- array(NA, dim=c(length(features),12), dimnames = list("Features"=features,
                                                                    "Predictor Type"=rep(c("OC",
                                                                                         "OP", 
                                                                                         "Distance"),4)))


for(j in 1:length(enetcoefslist)){
    featuremat_100kb[,j] <- ifelse(features %in% enetcoefslist[[j]], 1, 0)
}

#using lattice
levelplot(t(featuremat_100kb), 
          colorkey=FALSE, 
          scales=list(x=list(rot=45),
                      alternating=3), 
          col.regions=c("white", "red"),
          aspect="fill",panel = function(...){
            panel.levelplot(...)
            panel.abline(v = 3.5);
            panel.abline(v = 6.5);
            panel.abline(v = 9.5);
          },
          xlab="",
          ylab="")
grid.text("None",x=unit(.27,"npc"),y=unit(.95, "npc"))
grid.text("RUS",x=unit(.43,"npc"),y=unit(.95, "npc"))
grid.text("ROS",x=unit(.59,"npc"),y=unit(.95, "npc"))
grid.text("SMOTE",x=unit(.75,"npc"),y=unit(.95, "npc"))

featuredf <- data.frame(featuremat_100kb)
featuredf$Feature <- rownames(featuredf)
rownames(featuredf) <- NULL
featuredf <- featuredf[,c(13,1:12)]
names(featuredf) <- c("Feature",
                      "None.OC", "None.OP", "None.Distance",
                      "RUS.OC", "RUS.OP", "RUS.Distance",
                      "ROS.OC", "ROS.OP", "ROS.Distance",
                      "SMOTE.OC", "SMOTE.OP", "SMOTE.Distance")

x <- melt(featuredf, id.vars = 1)


```

####Combined

```{r}
all_featuremat_K562 <- cbind(featuremat_10kb,featuremat_25kb,featuremat_50kb,featuremat_100kb)
levelplot(t(all_featuremat_K562), 
          colorkey=FALSE, 
          scales=list(x=list(rot=45, cex=.5),
                      alternating=3,
                      y=list(cex=.7)), 
          col.regions=c("white", "red"),
          aspect="fill",panel = function(...){
            panel.levelplot(...)
            panel.abline(v = 1.5, lty = "dashed");
            panel.abline(v = 2.5, lty = "dashed");
            panel.abline(v = 3.5);
            panel.abline(v = 4.5, lty = "dashed");
            panel.abline(v = 5.5, lty = "dashed");
            panel.abline(v = 6.5);
            panel.abline(v = 7.5, lty = "dashed");
            panel.abline(v = 8.5, lty = "dashed");
            panel.abline(v = 9.5);
            panel.abline(v = 10.5, lty = "dashed");
            panel.abline(v = 11.5, lty = "dashed");
            panel.abline(v = 12.5, col="yellow");
            panel.abline(v = 13.5, lty = "dashed");
            panel.abline(v = 14.5, lty = "dashed");
            panel.abline(v = 15.5);
            panel.abline(v = 16.5, lty = "dashed");
            panel.abline(v = 17.5, lty = "dashed");
            panel.abline(v = 18.5);
            panel.abline(v = 19.5, lty = "dashed");
            panel.abline(v = 20.5, lty = "dashed");
            panel.abline(v = 21.5);
            panel.abline(v = 22.5, lty = "dashed");
            panel.abline(v = 23.5, lty = "dashed");
            panel.abline(v = 24.5, col="yellow");
            panel.abline(v = 25.5, lty = "dashed");
            panel.abline(v = 26.5, lty = "dashed");
            panel.abline(v = 27.5);
            panel.abline(v = 28.5, lty = "dashed");
            panel.abline(v = 29.5, lty = "dashed");
            panel.abline(v = 30.5);
            panel.abline(v = 31.5, lty = "dashed");
            panel.abline(v = 32.5, lty = "dashed");
            panel.abline(v = 33.5);
            panel.abline(v = 34.5, lty = "dashed");
            panel.abline(v = 35.5, lty = "dashed");
            panel.abline(v = 36.5, col="yellow");
            panel.abline(v = 37.5, lty = "dashed");
            panel.abline(v = 38.5, lty = "dashed");
            panel.abline(v = 39.5);
            panel.abline(v = 40.5, lty = "dashed");
            panel.abline(v = 41.5, lty = "dashed");
            panel.abline(v = 42.5);
            panel.abline(v = 43.5, lty = "dashed");
            panel.abline(v = 44.5, lty = "dashed");
            panel.abline(v = 45.5);
            panel.abline(v = 46.5, lty = "dashed");
            panel.abline(v = 47.5, lty = "dashed");
          },
          xlab="",
          ylab="")
```



#Barplots of performance metrics for models with distance-type predictors

##10kb

```{r}
#GM12878

##None
rfperf_gm12878_10kb_none <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/Distance/RFE/RF/rfperf.rds")

##RUS
rfperf_gm12878_10kb_rus <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/RUS/Distance/RFE/RF/rfperf.rds")

##ROS
rfperf_gm12878_10kb_ros <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROS/Distance/RFE/RF/rfperf.rds")

##SMOTE
rfperf_gm12878_10kb_smote <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/SMOTE/Distance/RFE/RF/rfperf.rds")

##ROSE
rfperf_gm12878_10kb_rose <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/ROSE/Distance/RFE/RF/rfperf.rds")

#K562

##None
rfperf_K562_10kb_none <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/None/Distance/RFE/RF/rfperf.rds")

##RUS
rfperf_K562_10kb_rus <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/RUS/Distance/RFE/RF/rfperf.rds")

##ROS
rfperf_K562_10kb_ros <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROS/Distance/RFE/RF/rfperf.rds")

##SMOTE
rfperf_K562_10kb_smote <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/SMOTE/Distance/RFE/RF/rfperf.rds")

##ROSE
rfperf_K562_10kb_rose <- readRDS("Z:/TAD_data_analysis/K562/10kb/Ensemble/ROSE/Distance/RFE/RF/rfperf.rds")


all10kbresults <- data.frame(Resampling=c(rep("None", 12),
                                       rep("RUS", 12),
                                       rep("ROS", 12),
                                       rep("SMOTE", 12),
                                       rep("ROSE", 12)),
                          CL=rep(c(rep("GM12878",6),
                               rep("K562", 6)),5),
                          Metric=rep(c("Accuracy", 
                                       "AUPRC", 
                                       "F1-Score", 
                                       "MCC",
                                       "Informedness",
                                       "Balanced Acc"), 10))

all10kbresults$Performance <- c(round(rfperf_gm12878_10kb_none[9,2],2), #accuracy
                                round(rfperf_gm12878_10kb_none[19,2],2), #auprc
                                round(rfperf_gm12878_10kb_none[16,2],2), #f1
                                round(rfperf_gm12878_10kb_none[15,2],2), #mcc
								round(rfperf_gm12878_10kb_none[18,2],2), #youden
								(round(rfperf_gm12878_10kb_none[6,2],2) + round(rfperf_gm12878_10kb_none[7,2],2))/2, #balanced accuracy
								
                                round(rfperf_K562_10kb_none[9,2],2),
                                round(rfperf_K562_10kb_none[19,2],2),
                                round(rfperf_K562_10kb_none[16,2],2),
                                round(rfperf_K562_10kb_none[15,2],2),
								round(rfperf_K562_10kb_none[18,2],2),
								(round(rfperf_K562_10kb_none[6,2],2) + round(rfperf_K562_10kb_none[7,2],2))/2,
								
                                round(mean(rfperf_gm12878_10kb_rus[9,1]),2),
                                round(mean(rfperf_gm12878_10kb_rus[19,1]),2),
                                round(mean(rfperf_gm12878_10kb_rus[16,1]),2),
                                round(mean(rfperf_gm12878_10kb_rus[15,1]),2),
								round(mean(rfperf_gm12878_10kb_rus[18,1]),2),
								(round(mean(rfperf_gm12878_10kb_rus[6,1]),2) + round(mean(rfperf_gm12878_10kb_rus[7,1]),2))/2,
								
                                round(mean(rfperf_K562_10kb_rus[9,1]),2),
                                round(mean(rfperf_K562_10kb_rus[19,1]),2),
                                round(mean(rfperf_K562_10kb_rus[16,1]),2),
                                round(mean(rfperf_K562_10kb_rus[15,1]),2),
								round(mean(rfperf_K562_10kb_rus[18,1]),2),
								(round(mean(rfperf_K562_10kb_rus[6,1]),2) + round(mean(rfperf_K562_10kb_rus[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_10kb_ros[9,1]),2),
                                round(mean(rfperf_gm12878_10kb_ros[19,1]),2),
                                round(mean(rfperf_gm12878_10kb_ros[16,1]),2),
                                round(mean(rfperf_gm12878_10kb_ros[15,1]),2),
								round(mean(rfperf_gm12878_10kb_ros[18,1]),2),
								(round(mean(rfperf_gm12878_10kb_ros[6,1]),2) + round(mean(rfperf_gm12878_10kb_ros[7,1]),2))/2,
								
                                round(mean(rfperf_K562_10kb_ros[9,1]),2),
                                round(mean(rfperf_K562_10kb_ros[19,1]),2),
                                round(mean(rfperf_K562_10kb_ros[16,1]),2),
                                round(mean(rfperf_K562_10kb_ros[15,1]),2),
								round(mean(rfperf_K562_10kb_ros[18,1]),2),
								(round(mean(rfperf_K562_10kb_ros[6,1]),2) + round(mean(rfperf_K562_10kb_ros[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_10kb_smote[9,1]),2),
                                round(mean(rfperf_gm12878_10kb_smote[19,1]),2),
                                round(mean(rfperf_gm12878_10kb_smote[16,1]),2),
                                round(mean(rfperf_gm12878_10kb_smote[15,1]),2),
								round(mean(rfperf_gm12878_10kb_smote[18,1]),2),
								(round(mean(rfperf_gm12878_10kb_smote[6,1]),2) + round(mean(rfperf_gm12878_10kb_smote[7,1]),2))/2,
								
                                round(mean(rfperf_K562_10kb_smote[9,1]),2),
                                round(mean(rfperf_K562_10kb_smote[19,1]),2),
                                round(mean(rfperf_K562_10kb_smote[16,1]),2),
                                round(mean(rfperf_K562_10kb_smote[15,1]),2),
								round(mean(rfperf_K562_10kb_smote[18,1]),2),
								(round(mean(rfperf_K562_10kb_smote[6,1]),2) + round(mean(rfperf_K562_10kb_smote[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_10kb_rose[9,1]),2),
                                round(mean(rfperf_gm12878_10kb_rose[19,1]),2),
                                round(mean(rfperf_gm12878_10kb_rose[16,1]),2),
                                round(mean(rfperf_gm12878_10kb_rose[15,1]),2),
								round(mean(rfperf_gm12878_10kb_rose[18,1]),2),
								(round(mean(rfperf_gm12878_10kb_rose[6,1]),2) + round(mean(rfperf_gm12878_10kb_rose[7,1]),2))/2,
								
                                round(mean(rfperf_K562_10kb_rose[9,1]),2),
                                round(mean(rfperf_K562_10kb_rose[19,1]),2),
                                round(mean(rfperf_K562_10kb_rose[16,1]),2),
                                round(mean(rfperf_K562_10kb_rose[15,1]),2),
								round(mean(rfperf_K562_10kb_rose[18,1]),2),
								(round(mean(rfperf_K562_10kb_rose[6,1]),2) + round(mean(rfperf_K562_10kb_rose[7,1]),2))/2)

all10kbresults$Resampling <- factor(all10kbresults$Resampling, levels=c("None", "RUS", "ROS", "SMOTE", "ROSE"))
all10kbresults$CL <- factor(all10kbresults$CL, levels=c("GM12878", "K562"))
all10kbresults$Metric <- factor(all10kbresults$Metric, levels=c("Accuracy", "AUPRC", "F1-Score", "MCC"))

none10kbplot <- ggplot(all10kbresults[which(all10kbresults$Resampling=="None"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

rus10kbplot <- ggplot(all10kbresults[which(all10kbresults$Resampling=="RUS"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

ros10kbplot <- ggplot(all10kbresults[which(all10kbresults$Resampling=="ROS"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

smote10kbplot <- ggplot(all10kbresults[which(all10kbresults$Resampling=="SMOTE"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

rose10kbplot <- ggplot(all10kbresults[which(all10kbresults$Resampling=="ROSE"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))

######################################################################

#comparing only f1 and mcc

f1mcc10kbplot <- ggplot(all10kbresults[which(all10kbresults$Metric=="F1-Score" |
                                               all10kbresults$Metric=="MCC"),],
                       aes(x=Resampling, y=Performance, fill=CL)) +
  geom_bar( stat="identity", position="dodge") +
  facet_grid(~ Metric) +
  xlab("Resampling Technique") +
  theme_minimal() +
  theme_bw() +
  scale_fill_discrete(name="Cell Line")+
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))

#comparing only informedness and balanced accuracy
informBA10kbplot <- ggplot(all10kbresults[which(all10kbresults$Metric=="Informedness" |
                                               all10kbresults$Metric=="Balanced Acc"),],
                       aes(x=Resampling, y=Performance, fill=CL)) +
  geom_bar( stat="identity", position="dodge") +
  facet_grid(~ Metric) +
  ylim(0,.8)+
  xlab("Resampling Technique") +
  theme_minimal() +
  theme_bw() +
  scale_fill_discrete(name="Cell Line")+
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))

```


##25kb

```{r}
#GM12878

##None
rfperf_gm12878_25kb_none <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/Distance/RFE/RF/rfperf.rds")

##RUS
rfperf_gm12878_25kb_rus <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/RUS/Distance/RFE/RF/rfperf.rds")

##ROS
rfperf_gm12878_25kb_ros <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROS/Distance/RFE/RF/rfperf.rds")

##SMOTE
rfperf_gm12878_25kb_smote <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/SMOTE/Distance/RFE/RF/rfperf.rds")

##ROSE
rfperf_gm12878_25kb_rose <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/ROSE/Distance/RFE/RF/rfperf.rds")

#K562

##None
rfperf_K562_25kb_none <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/None/Distance/RFE/RF/rfperf.rds")

##RUS
rfperf_K562_25kb_rus <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/RUS/Distance/RFE/RF/rfperf.rds")

##ROS
rfperf_K562_25kb_ros <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROS/Distance/RFE/RF/rfperf.rds")

##SMOTE
rfperf_K562_25kb_smote <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/SMOTE/Distance/RFE/RF/rfperf.rds")

##ROSE
rfperf_K562_25kb_rose <- readRDS("Z:/TAD_data_analysis/K562/25kb/Ensemble/ROSE/Distance/RFE/RF/rfperf.rds")


all25kbresults <- data.frame(Resampling=c(rep("None", 12),
                                       rep("RUS", 12),
                                       rep("ROS", 12),
                                       rep("SMOTE", 12),
                                       rep("ROSE", 12)),
                          CL=rep(c(rep("GM12878",6),
                               rep("K562", 6)),5),
                          Metric=rep(c("Accuracy", 
                                       "AUPRC", 
                                       "F1-Score", 
                                       "MCC",
                                       "Informedness",
                                       "Balanced Acc"), 10))

all25kbresults$Performance <- c(round(rfperf_gm12878_25kb_none[9,2],2), #accuracy
                                round(rfperf_gm12878_25kb_none[19,2],2), #auprc
                                round(rfperf_gm12878_25kb_none[16,2],2), #f1
                                round(rfperf_gm12878_25kb_none[15,2],2), #mcc
								round(rfperf_gm12878_25kb_none[18,2],2), #youden
								(round(rfperf_gm12878_25kb_none[6,2],2) + round(rfperf_gm12878_25kb_none[7,2],2))/2, #balanced accuracy
								
                                round(rfperf_K562_25kb_none[9,2],2),
                                round(rfperf_K562_25kb_none[19,2],2),
                                round(rfperf_K562_25kb_none[16,2],2),
                                round(rfperf_K562_25kb_none[15,2],2),
								round(rfperf_K562_25kb_none[18,2],2),
								(round(rfperf_K562_25kb_none[6,2],2) + round(rfperf_K562_25kb_none[7,2],2))/2,
								
                                round(mean(rfperf_gm12878_25kb_rus[9,1]),2),
                                round(mean(rfperf_gm12878_25kb_rus[19,1]),2),
                                round(mean(rfperf_gm12878_25kb_rus[16,1]),2),
                                round(mean(rfperf_gm12878_25kb_rus[15,1]),2),
								round(mean(rfperf_gm12878_25kb_rus[18,1]),2),
								(round(mean(rfperf_gm12878_25kb_rus[6,1]),2) + round(mean(rfperf_gm12878_25kb_rus[7,1]),2))/2,
								
                                round(mean(rfperf_K562_25kb_rus[9,1]),2),
                                round(mean(rfperf_K562_25kb_rus[19,1]),2),
                                round(mean(rfperf_K562_25kb_rus[16,1]),2),
                                round(mean(rfperf_K562_25kb_rus[15,1]),2),
								round(mean(rfperf_K562_25kb_rus[18,1]),2),
								(round(mean(rfperf_K562_25kb_rus[6,1]),2) + round(mean(rfperf_K562_25kb_rus[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_25kb_ros[9,1]),2),
                                round(mean(rfperf_gm12878_25kb_ros[19,1]),2),
                                round(mean(rfperf_gm12878_25kb_ros[16,1]),2),
                                round(mean(rfperf_gm12878_25kb_ros[15,1]),2),
								round(mean(rfperf_gm12878_25kb_ros[18,1]),2),
								(round(mean(rfperf_gm12878_25kb_ros[6,1]),2) + round(mean(rfperf_gm12878_25kb_ros[7,1]),2))/2,
								
                                round(mean(rfperf_K562_25kb_ros[9,1]),2),
                                round(mean(rfperf_K562_25kb_ros[19,1]),2),
                                round(mean(rfperf_K562_25kb_ros[16,1]),2),
                                round(mean(rfperf_K562_25kb_ros[15,1]),2),
								round(mean(rfperf_K562_25kb_ros[18,1]),2),
								(round(mean(rfperf_K562_25kb_ros[6,1]),2) + round(mean(rfperf_K562_25kb_ros[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_25kb_smote[9,1]),2),
                                round(mean(rfperf_gm12878_25kb_smote[19,1]),2),
                                round(mean(rfperf_gm12878_25kb_smote[16,1]),2),
                                round(mean(rfperf_gm12878_25kb_smote[15,1]),2),
								round(mean(rfperf_gm12878_25kb_smote[18,1]),2),
								(round(mean(rfperf_gm12878_25kb_smote[6,1]),2) + round(mean(rfperf_gm12878_25kb_smote[7,1]),2))/2,
								
                                round(mean(rfperf_K562_25kb_smote[9,1]),2),
                                round(mean(rfperf_K562_25kb_smote[19,1]),2),
                                round(mean(rfperf_K562_25kb_smote[16,1]),2),
                                round(mean(rfperf_K562_25kb_smote[15,1]),2),
								round(mean(rfperf_K562_25kb_smote[18,1]),2),
								(round(mean(rfperf_K562_25kb_smote[6,1]),2) + round(mean(rfperf_K562_25kb_smote[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_25kb_rose[9,1]),2),
                                round(mean(rfperf_gm12878_25kb_rose[19,1]),2),
                                round(mean(rfperf_gm12878_25kb_rose[16,1]),2),
                                round(mean(rfperf_gm12878_25kb_rose[15,1]),2),
								round(mean(rfperf_gm12878_25kb_rose[18,1]),2),
								(round(mean(rfperf_gm12878_25kb_rose[6,1]),2) + round(mean(rfperf_gm12878_25kb_rose[7,1]),2))/2,
								
                                round(mean(rfperf_K562_25kb_rose[9,1]),2),
                                round(mean(rfperf_K562_25kb_rose[19,1]),2),
                                round(mean(rfperf_K562_25kb_rose[16,1]),2),
                                round(mean(rfperf_K562_25kb_rose[15,1]),2),
								round(mean(rfperf_K562_25kb_rose[18,1]),2),
								(round(mean(rfperf_K562_25kb_rose[6,1]),2) + round(mean(rfperf_K562_25kb_rose[7,1]),2))/2)

all25kbresults$Resampling <- factor(all25kbresults$Resampling, levels=c("None", "RUS", "ROS", "SMOTE", "ROSE"))
all25kbresults$CL <- factor(all25kbresults$CL, levels=c("GM12878", "K562"))
all25kbresults$Metric <- factor(all25kbresults$Metric, levels=c("Accuracy", "AUPRC", "F1-Score", "MCC"))

none25kbplot <- ggplot(all25kbresults[which(all25kbresults$Resampling=="None"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

rus25kbplot <- ggplot(all25kbresults[which(all25kbresults$Resampling=="RUS"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

ros25kbplot <- ggplot(all25kbresults[which(all25kbresults$Resampling=="ROS"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

smote25kbplot <- ggplot(all25kbresults[which(all25kbresults$Resampling=="SMOTE"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

rose25kbplot <- ggplot(all25kbresults[which(all25kbresults$Resampling=="ROSE"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))

######################################################################

#comparing only f1 and mcc

f1mcc25kbplot <- ggplot(all25kbresults[which(all25kbresults$Metric=="F1-Score" |
                                               all25kbresults$Metric=="MCC"),],
                       aes(x=Resampling, y=Performance, fill=CL)) +
  geom_bar( stat="identity", position="dodge") +
  facet_grid(~ Metric) +
  xlab("Resampling Technique") +
  theme_minimal() +
  theme_bw() +
  scale_fill_discrete(name="Cell Line")+
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))

#comparing only informedness and balanced accuracy
informBA25kbplot <- ggplot(all25kbresults[which(all25kbresults$Metric=="Informedness" |
                                               all25kbresults$Metric=="Balanced Acc"),],
                       aes(x=Resampling, y=Performance, fill=CL)) +
  geom_bar( stat="identity", position="dodge") +
  facet_grid(~ Metric) +
  xlab("Resampling Technique") +
  ylim(0,.8)+
  theme_minimal() +
  theme_bw() +
  scale_fill_discrete(name="Cell Line")+
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))


```


##50kb

```{r}
#GM12878

##None
rfperf_gm12878_50kb_none <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/Distance/RFE/RF/rfperf.rds")

##RUS
rfperf_gm12878_50kb_rus <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/RUS/Distance/RFE/RF/rfperf.rds")

##ROS
rfperf_gm12878_50kb_ros <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROS/Distance/RFE/RF/rfperf.rds")

##SMOTE
rfperf_gm12878_50kb_smote <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/SMOTE/Distance/RFE/RF/rfperf.rds")

##ROSE
rfperf_gm12878_50kb_rose <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/ROSE/Distance/RFE/RF/rfperf.rds")

#K562

##None
rfperf_K562_50kb_none <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/None/Distance/RFE/RF/rfperf.rds")

##RUS
rfperf_K562_50kb_rus <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/RUS/Distance/RFE/RF/rfperf.rds")

##ROS
rfperf_K562_50kb_ros <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROS/Distance/RFE/RF/rfperf.rds")

##SMOTE
rfperf_K562_50kb_smote <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/SMOTE/Distance/RFE/RF/rfperf.rds")

##ROSE
rfperf_K562_50kb_rose <- readRDS("Z:/TAD_data_analysis/K562/50kb/Ensemble/ROSE/Distance/RFE/RF/rfperf.rds")


all50kbresults <- data.frame(Resampling=c(rep("None", 12),
                                       rep("RUS", 12),
                                       rep("ROS", 12),
                                       rep("SMOTE", 12),
                                       rep("ROSE", 12)),
                          CL=rep(c(rep("GM12878",6),
                               rep("K562", 6)),5),
                          Metric=rep(c("Accuracy", 
                                       "AUPRC", 
                                       "F1-Score", 
                                       "MCC",
                                       "Informedness",
                                       "Balanced Acc"), 10))

all50kbresults$Performance <- c(round(rfperf_gm12878_50kb_none[9,2],2), #accuracy
                                round(rfperf_gm12878_50kb_none[19,2],2), #auprc
                                round(rfperf_gm12878_50kb_none[16,2],2), #f1
                                round(rfperf_gm12878_50kb_none[15,2],2), #mcc
								round(rfperf_gm12878_50kb_none[18,2],2), #youden
								(round(rfperf_gm12878_50kb_none[6,2],2) + round(rfperf_gm12878_50kb_none[7,2],2))/2, #balanced accuracy
								
                                round(rfperf_K562_50kb_none[9,2],2),
                                round(rfperf_K562_50kb_none[19,2],2),
                                round(rfperf_K562_50kb_none[16,2],2),
                                round(rfperf_K562_50kb_none[15,2],2),
								round(rfperf_K562_50kb_none[18,2],2),
								(round(rfperf_K562_50kb_none[6,2],2) + round(rfperf_K562_50kb_none[7,2],2))/2,
								
                                round(mean(rfperf_gm12878_50kb_rus[9,1]),2),
                                round(mean(rfperf_gm12878_50kb_rus[19,1]),2),
                                round(mean(rfperf_gm12878_50kb_rus[16,1]),2),
                                round(mean(rfperf_gm12878_50kb_rus[15,1]),2),
								round(mean(rfperf_gm12878_50kb_rus[18,1]),2),
								(round(mean(rfperf_gm12878_50kb_rus[6,1]),2) + round(mean(rfperf_gm12878_50kb_rus[7,1]),2))/2,
								
                                round(mean(rfperf_K562_50kb_rus[9,1]),2),
                                round(mean(rfperf_K562_50kb_rus[19,1]),2),
                                round(mean(rfperf_K562_50kb_rus[16,1]),2),
                                round(mean(rfperf_K562_50kb_rus[15,1]),2),
								round(mean(rfperf_K562_50kb_rus[18,1]),2),
								(round(mean(rfperf_K562_50kb_rus[6,1]),2) + round(mean(rfperf_K562_50kb_rus[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_50kb_ros[9,1]),2),
                                round(mean(rfperf_gm12878_50kb_ros[19,1]),2),
                                round(mean(rfperf_gm12878_50kb_ros[16,1]),2),
                                round(mean(rfperf_gm12878_50kb_ros[15,1]),2),
								round(mean(rfperf_gm12878_50kb_ros[18,1]),2),
								(round(mean(rfperf_gm12878_50kb_ros[6,1]),2) + round(mean(rfperf_gm12878_50kb_ros[7,1]),2))/2,
								
                                round(mean(rfperf_K562_50kb_ros[9,1]),2),
                                round(mean(rfperf_K562_50kb_ros[19,1]),2),
                                round(mean(rfperf_K562_50kb_ros[16,1]),2),
                                round(mean(rfperf_K562_50kb_ros[15,1]),2),
								round(mean(rfperf_K562_50kb_ros[18,1]),2),
								(round(mean(rfperf_K562_50kb_ros[6,1]),2) + round(mean(rfperf_K562_50kb_ros[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_50kb_smote[9,1]),2),
                                round(mean(rfperf_gm12878_50kb_smote[19,1]),2),
                                round(mean(rfperf_gm12878_50kb_smote[16,1]),2),
                                round(mean(rfperf_gm12878_50kb_smote[15,1]),2),
								round(mean(rfperf_gm12878_50kb_smote[18,1]),2),
								(round(mean(rfperf_gm12878_50kb_smote[6,1]),2) + round(mean(rfperf_gm12878_50kb_smote[7,1]),2))/2,
								
                                round(mean(rfperf_K562_50kb_smote[9,1]),2),
                                round(mean(rfperf_K562_50kb_smote[19,1]),2),
                                round(mean(rfperf_K562_50kb_smote[16,1]),2),
                                round(mean(rfperf_K562_50kb_smote[15,1]),2),
								round(mean(rfperf_K562_50kb_smote[18,1]),2),
								(round(mean(rfperf_K562_50kb_smote[6,1]),2) + round(mean(rfperf_K562_50kb_smote[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_50kb_rose[9,1]),2),
                                round(mean(rfperf_gm12878_50kb_rose[19,1]),2),
                                round(mean(rfperf_gm12878_50kb_rose[16,1]),2),
                                round(mean(rfperf_gm12878_50kb_rose[15,1]),2),
								round(mean(rfperf_gm12878_50kb_rose[18,1]),2),
								(round(mean(rfperf_gm12878_50kb_rose[6,1]),2) + round(mean(rfperf_gm12878_50kb_rose[7,1]),2))/2,
								
                                round(mean(rfperf_K562_50kb_rose[9,1]),2),
                                round(mean(rfperf_K562_50kb_rose[19,1]),2),
                                round(mean(rfperf_K562_50kb_rose[16,1]),2),
                                round(mean(rfperf_K562_50kb_rose[15,1]),2),
								round(mean(rfperf_K562_50kb_rose[18,1]),2),
								(round(mean(rfperf_K562_50kb_rose[6,1]),2) + round(mean(rfperf_K562_50kb_rose[7,1]),2))/2)

#all50kbresults$Resampling <- factor(all50kbresults$Resampling, levels=c("None", "RUS", "ROS", "SMOTE", "ROSE"))
#all50kbresults$CL <- factor(all50kbresults$CL, levels=c("GM12878", "K562"))
#all50kbresults$Metric <- factor(all50kbresults$Metric, levels=c("Accuracy", "AUPRC", "F1-Score", "MCC"))

none50kbplot <- ggplot(all50kbresults[which(all50kbresults$Resampling=="None"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

rus50kbplot <- ggplot(all50kbresults[which(all50kbresults$Resampling=="RUS"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

ros50kbplot <- ggplot(all50kbresults[which(all50kbresults$Resampling=="ROS"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

smote50kbplot <- ggplot(all50kbresults[which(all50kbresults$Resampling=="SMOTE"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

rose50kbplot <- ggplot(all50kbresults[which(all50kbresults$Resampling=="ROSE"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))

######################################################################

#comparing only f1 and mcc

f1mcc50kbplot <- ggplot(all50kbresults[which(all50kbresults$Metric=="F1-Score" |
                                               all50kbresults$Metric=="MCC"),],
                       aes(x=Resampling, y=Performance, fill=CL)) +
  geom_bar( stat="identity", position="dodge") +
  facet_grid(~ Metric) +
  xlab("Resampling Technique") +
  theme_minimal() +
  theme_bw() +
  scale_fill_discrete(name="Cell Line")+
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))

#comparing only informedness and balanced accuracy
informBA50kbplot <- ggplot(all50kbresults[which(all50kbresults$Metric=="Informedness" |
                                               all50kbresults$Metric=="Balanced Acc"),],
                       aes(x=Resampling, y=Performance, fill=CL)) +
  geom_bar( stat="identity", position="dodge") +
  facet_grid(~ Metric) +
  xlab("Resampling Technique") +
  ylim(0,.8)+
  theme_minimal() +
  theme_bw() +
  scale_fill_discrete(name="Cell Line")+
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))


```


##100kb

```{r}
#GM12878

##None
rfperf_gm12878_100kb_none <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/Distance/RFE/RF/rfperf.rds")

##RUS
rfperf_gm12878_100kb_rus <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/RUS/Distance/RFE/RF/rfperf.rds")

##ROS
rfperf_gm12878_100kb_ros <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROS/Distance/RFE/RF/rfperf.rds")

##SMOTE
rfperf_gm12878_100kb_smote <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/SMOTE/Distance/RFE/RF/rfperf.rds")

##ROSE
rfperf_gm12878_100kb_rose <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/ROSE/Distance/RFE/RF/rfperf.rds")

#K562

##None
rfperf_K562_100kb_none <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/None/Distance/RFE/RF/rfperf.rds")

##RUS
rfperf_K562_100kb_rus <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/RUS/Distance/RFE/RF/rfperf.rds")

##ROS
rfperf_K562_100kb_ros <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROS/Distance/RFE/RF/rfperf.rds")

##SMOTE
rfperf_K562_100kb_smote <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/SMOTE/Distance/RFE/RF/rfperf.rds")

##ROSE
rfperf_K562_100kb_rose <- readRDS("Z:/TAD_data_analysis/K562/100kb/Ensemble/ROSE/Distance/RFE/RF/rfperf.rds")


all100kbresults <- data.frame(Resampling=c(rep("None", 12),
                                       rep("RUS", 12),
                                       rep("ROS", 12),
                                       rep("SMOTE", 12),
                                       rep("ROSE", 12)),
                          CL=rep(c(rep("GM12878", 6),
                               rep("K562", 6)),5),
                          Metric=rep(c("Accuracy", 
                                       "AUPRC", 
                                       "F1-Score", 
                                       "MCC",
                                       "Informedness",
                                       "Balanced Acc"), 10))

all100kbresults$Performance <- c(round(rfperf_gm12878_100kb_none[9,2],2), #accuracy
                                round(rfperf_gm12878_100kb_none[19,2],2), #auprc
                                round(rfperf_gm12878_100kb_none[16,2],2), #f1
                                round(rfperf_gm12878_100kb_none[15,2],2), #mcc
								round(rfperf_gm12878_100kb_none[18,2],2), #youden
								(round(rfperf_gm12878_100kb_none[6,2],2) + round(rfperf_gm12878_100kb_none[7,2],2))/2, #balanced accuracy
								
                                round(rfperf_K562_100kb_none[9,2],2),
                                round(rfperf_K562_100kb_none[19,2],2),
                                round(rfperf_K562_100kb_none[16,2],2),
                                round(rfperf_K562_100kb_none[15,2],2),
								round(rfperf_K562_100kb_none[18,2],2),
								(round(rfperf_K562_100kb_none[6,2],2) + round(rfperf_K562_100kb_none[7,2],2))/2,
								
                                round(mean(rfperf_gm12878_100kb_rus[9,1]),2),
                                round(mean(rfperf_gm12878_100kb_rus[19,1]),2),
                                round(mean(rfperf_gm12878_100kb_rus[16,1]),2),
                                round(mean(rfperf_gm12878_100kb_rus[15,1]),2),
								round(mean(rfperf_gm12878_100kb_rus[18,1]),2),
								(round(mean(rfperf_gm12878_100kb_rus[6,1]),2) + round(mean(rfperf_gm12878_100kb_rus[7,1]),2))/2,
								
                                round(mean(rfperf_K562_100kb_rus[9,1]),2),
                                round(mean(rfperf_K562_100kb_rus[19,1]),2),
                                round(mean(rfperf_K562_100kb_rus[16,1]),2),
                                round(mean(rfperf_K562_100kb_rus[15,1]),2),
								round(mean(rfperf_K562_100kb_rus[18,1]),2),
								(round(mean(rfperf_K562_100kb_rus[6,1]),2) + round(mean(rfperf_K562_100kb_rus[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_100kb_ros[9,1]),2),
                                round(mean(rfperf_gm12878_100kb_ros[19,1]),2),
                                round(mean(rfperf_gm12878_100kb_ros[16,1]),2),
                                round(mean(rfperf_gm12878_100kb_ros[15,1]),2),
								round(mean(rfperf_gm12878_100kb_ros[18,1]),2),
								(round(mean(rfperf_gm12878_100kb_ros[6,1]),2) + round(mean(rfperf_gm12878_100kb_ros[7,1]),2))/2,
								
                                round(mean(rfperf_K562_100kb_ros[9,1]),2),
                                round(mean(rfperf_K562_100kb_ros[19,1]),2),
                                round(mean(rfperf_K562_100kb_ros[16,1]),2),
                                round(mean(rfperf_K562_100kb_ros[15,1]),2),
								round(mean(rfperf_K562_100kb_ros[18,1]),2),
								(round(mean(rfperf_K562_100kb_ros[6,1]),2) + round(mean(rfperf_K562_100kb_ros[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_100kb_smote[9,1]),2),
                                round(mean(rfperf_gm12878_100kb_smote[19,1]),2),
                                round(mean(rfperf_gm12878_100kb_smote[16,1]),2),
                                round(mean(rfperf_gm12878_100kb_smote[15,1]),2),
								round(mean(rfperf_gm12878_100kb_smote[18,1]),2),
								(round(mean(rfperf_gm12878_100kb_smote[6,1]),2) + round(mean(rfperf_gm12878_100kb_smote[7,1]),2))/2,
								
                                round(mean(rfperf_K562_100kb_smote[9,1]),2),
                                round(mean(rfperf_K562_100kb_smote[19,1]),2),
                                round(mean(rfperf_K562_100kb_smote[16,1]),2),
                                round(mean(rfperf_K562_100kb_smote[15,1]),2),
								round(mean(rfperf_K562_100kb_smote[18,1]),2),
								(round(mean(rfperf_K562_100kb_smote[6,1]),2) + round(mean(rfperf_K562_100kb_smote[7,1]),2))/2,
								
                                round(mean(rfperf_gm12878_100kb_rose[9,1]),2),
                                round(mean(rfperf_gm12878_100kb_rose[19,1]),2),
                                round(mean(rfperf_gm12878_100kb_rose[16,1]),2),
                                round(mean(rfperf_gm12878_100kb_rose[15,1]),2),
								round(mean(rfperf_gm12878_100kb_rose[18,1]),2),
								(round(mean(rfperf_gm12878_100kb_rose[6,1]),2) + round(mean(rfperf_gm12878_100kb_rose[7,1]),2))/2,
								
                                round(mean(rfperf_K562_100kb_rose[9,1]),2),
                                round(mean(rfperf_K562_100kb_rose[19,1]),2),
                                round(mean(rfperf_K562_100kb_rose[16,1]),2),
                                round(mean(rfperf_K562_100kb_rose[15,1]),2),
								round(mean(rfperf_K562_100kb_rose[18,1]),2),
								(round(mean(rfperf_K562_100kb_rose[6,1]),2) + round(mean(rfperf_K562_100kb_rose[7,1]),2))/2)

#all100kbresults$Resampling <- factor(all100kbresults$Resampling, levels=c("None", "RUS", "ROS", "SMOTE", "ROSE"))
#all100kbresults$CL <- factor(all100kbresults$CL, levels=c("GM12878", "K562"))
#all100kbresults$Metric <- factor(all100kbresults$Metric, levels=c("Accuracy", "AUPRC", "F1-Score", "MCC"))

none100kbplot <- ggplot(all100kbresults[which(all100kbresults$Resampling=="None"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

rus100kbplot <- ggplot(all100kbresults[which(all100kbresults$Resampling=="RUS"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

ros100kbplot <- ggplot(all100kbresults[which(all100kbresults$Resampling=="ROS"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

smote100kbplot <- ggplot(all100kbresults[which(all100kbresults$Resampling=="SMOTE"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20)) 

rose100kbplot <- ggplot(all100kbresults[which(all100kbresults$Resampling=="ROSE"),],
                       aes(x=CL, y=Performance, fill=Metric)) +
  geom_bar( stat="identity", position="dodge") +
  xlab("Cell Line") +
  ylim(0,1)+
  theme_bw() +
  theme_minimal() +
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15), #, angle = 45, margin = ggplot2::margin(t = 35)),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))

######################################################################

#comparing only f1 and mcc

f1mcc100kbplot <- ggplot(all100kbresults[which(all100kbresults$Metric=="F1-Score" |
                                               all100kbresults$Metric=="MCC"),],
                       aes(x=Resampling, y=Performance, fill=CL)) +
  geom_bar( stat="identity", position="dodge") +
  facet_grid(~ Metric) +
  xlab("Resampling Technique") +
  theme_minimal() +
  theme_bw() +
  scale_fill_discrete(name="Cell Line")+
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))

#comparing only informedness and balanced accuracy
informBA100kbplot <- ggplot(all100kbresults[which(all100kbresults$Metric=="Informedness" |
                                               all100kbresults$Metric=="Balanced Acc"),],
                       aes(x=Resampling, y=Performance, fill=CL)) +
  geom_bar( stat="identity", position="dodge") +
  facet_grid(~ Metric) +
  xlab("Resampling Technique") +
  ylim(0,.8)+
  theme_minimal() +
  theme_bw() +
  scale_fill_discrete(name="Cell Line")+
  #guides(fill=FALSE)+
	theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20))


```


#Table of model performances

```{r}


```





#Variable Importance Plots 

##10kb

###None

```{r}
rfimpvars_gm12878_10kb_none <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/Ensemble/None/Distance/RFE/RF/rfimpvars.rds")
rfimpvars_gm12878_10kb_none <- rfimpvars_gm12878_10kb_none[1:20,]

rfimpvars_gm12878_10kb_none$Feature <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "Gm12878", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", rfimpvars_gm12878_10kb_none$Feature)

rfimpvars_gm12878_10kb_none$Feature <- factor(rfimpvars_gm12878_10kb_none$Feature, levels=rfimpvars_gm12878_10kb_none$Feature)


ggplot(rfimpvars_gm12878_10kb_none, aes(x=Feature, y=Importance)) +
  geom_bar(stat="identity") +
  theme_minimal()+
  theme_bw()+
  theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20))
```

###ROS

```{r}

```


###RUS

###SMOTE

###ROSE


##25kb

###None

```{r}
rfimpvars_gm12878_25kb_none <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/Ensemble/None/Distance/RFE/RF/rfimpvars.rds")
rfimpvars_gm12878_25kb_none <- rfimpvars_gm12878_25kb_none[1:20,]

rfimpvars_gm12878_25kb_none$Feature <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "Gm12878", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", rfimpvars_gm12878_25kb_none$Feature)

rfimpvars_gm12878_25kb_none$Feature <- factor(rfimpvars_gm12878_25kb_none$Feature, levels=rfimpvars_gm12878_25kb_none$Feature)


ggplot(rfimpvars_gm12878_25kb_none, aes(x=Feature, y=Importance)) +
  geom_bar(stat="identity") +
  theme_minimal()+
  theme_bw()+
  theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20))
```


###ROS

###RUS

###SMOTE

###ROSE

##50kb

###None

```{r}
rfimpvars_gm12878_50kb_none <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/Ensemble/None/Distance/RFE/RF/rfimpvars.rds")
rfimpvars_gm12878_50kb_none <- rfimpvars_gm12878_50kb_none[1:20,]

rfimpvars_gm12878_50kb_none$Feature <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "Gm12878", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", rfimpvars_gm12878_50kb_none$Feature)

rfimpvars_gm12878_50kb_none$Feature <- factor(rfimpvars_gm12878_50kb_none$Feature, levels=rfimpvars_gm12878_50kb_none$Feature)


ggplot(rfimpvars_gm12878_50kb_none, aes(x=Feature, y=Importance)) +
  geom_bar(stat="identity") +
  theme_minimal()+
  theme_bw()+
  theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20))
```


###ROS

###RUS

###SMOTE

###ROSE


##100kb

###None
```{r}
rfimpvars_gm12878_100kb_none <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/Ensemble/None/Distance/RFE/RF/rfimpvars.rds")
rfimpvars_gm12878_100kb_none <- rfimpvars_gm12878_100kb_none[1:20,]

rfimpvars_gm12878_100kb_none$Feature <- gsub(paste(c("`", 
                                                    "_",
                                                    "-",
                                                    "Gm12878", 
                                                    "dist", 
                                                    "Haib", 
                                                    "Sydh",
                                                    "Uta",
                                                    "Uw",
                                                    "Broad",
                                                    "Uchicago"), collapse = "|"),"", rfimpvars_gm12878_100kb_none$Feature)

rfimpvars_gm12878_100kb_none$Feature <- factor(rfimpvars_gm12878_100kb_none$Feature, levels=rfimpvars_gm12878_100kb_none$Feature)


ggplot(rfimpvars_gm12878_100kb_none, aes(x=Feature, y=Importance)) +
  geom_bar(stat="identity") +
  theme_minimal()+
  theme_bw()+
  theme(axis.text.x = element_text(size=15,
	                                 angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20))
```


###ROS

###RUS

###SMOTE

###ROSE


#Network Analysis

```{r}
##venn diagram of top predictors 
#grid.newpage()
##vennp <- draw.triple.venn(area1 = 10, area2 = 10, area3 = 10, n12 = length(intersect(us,sm)), n23 = length(intersect(sm,km)), n13 = length(intersect(km,us)), 
##                 n123 = length(intersect(us,intersect(sm,km))), category = c("Under- \n Sampling", "SMOTE", "K-Medoids"), lty = "blank", 
##                 fill = c("red", "green", "blue"),cex=3,cat.cex = 3)
#
#vennp <- draw.pairwise.venn(length(varimp.rf.df.gm12878$Feature),
#						  length(varimp.rf.df.k562$Feature),
#						  length(intersect(varimp.rf.df.gm12878$Feature, varimp.rf.df.k562$Feature)),
#						  category = c("GM12878", "K562"),
#						  lty = "blank", 
#                          fill = c("red", "blue"),
#						  cex=3,
#						  cat.cex = 3,
#						  cat.pos = c(0,0),
#						  scaled = FALSE)


##Network Visualization between resolutions
rfimpvars <- readRDS("C:/Users/Spiro Stilianoudakis/Documents/TAD_data/RData/GM12878/5kb/CHR1/rus/distance/enet/rfimpvars.rds")

rf5kb <- data.frame(Feature = as.character(rownames(rfimpvars)),
					Importance = rowMeans(rfimpvars))
rownames(rf5kb) <- NULL
rf5kb$Feature <- as.character(rf5kb$Feature)
rf5kb$Feature[grep("Gm12878-", rf5kb$Feature)] <- gsub("Gm12878-","",rf5kb$Feature[grep("Gm12878-", rf5kb$Feature)])
rf5kb$Feature[grep("_dist", rf5kb$Feature)] <- gsub("_dist","",rf5kb$Feature[grep("_dist", rf5kb$Feature)])
rf5kb$Importance <- rf5kb$Importance/sum(rf5kb$Importance)


rfimpvars <- readRDS("C:/Users/Spiro Stilianoudakis/Documents/TAD_data/RData/GM12878/25kb/CHR1/rus/distance/enet/rfimpvars.rds")

rf25kb <- data.frame(Feature = as.character(rownames(rfimpvars)),
					Importance = rowMeans(rfimpvars))
rownames(rf25kb) <- NULL
rf25kb$Feature <- as.character(rf25kb$Feature)
rf25kb$Feature[grep("Gm12878-", rf25kb$Feature)] <- gsub("Gm12878-","",rf25kb$Feature[grep("Gm12878-", rf25kb$Feature)])
rf25kb$Feature[grep("_dist", rf25kb$Feature)] <- gsub("_dist","",rf25kb$Feature[grep("_dist", rf25kb$Feature)])
rf25kb$Importance <- rf25kb$Importance/sum(rf25kb$Importance)


rfimpvars <- readRDS("C:/Users/Spiro Stilianoudakis/Documents/TAD_data/RData/GM12878/50kb/CHR1/rus/distance/enet/rfimpvars.rds")

rf50kb <- data.frame(Feature = as.character(rownames(rfimpvars)),
					Importance = rowMeans(rfimpvars))
rownames(rf50kb) <- NULL
rf50kb$Feature <- as.character(rf50kb$Feature)
rf50kb$Feature[grep("Gm12878-", rf50kb$Feature)] <- gsub("Gm12878-","",rf50kb$Feature[grep("Gm12878-", rf50kb$Feature)])
rf50kb$Feature[grep("_dist", rf50kb$Feature)] <- gsub("_dist","",rf50kb$Feature[grep("_dist", rf50kb$Feature)])
rf50kb$Importance <- rf50kb$Importance/sum(rf50kb$Importance)


rfimpvars <- readRDS("C:/Users/Spiro Stilianoudakis/Documents/TAD_data/RData/GM12878/100kb/CHR1/rus/distance/enet/rfimpvars.rds")

rf100kb <- data.frame(Feature = as.character(rownames(rfimpvars)),
					Importance = rowMeans(rfimpvars))
rownames(rf100kb) <- NULL
rf100kb$Feature <- as.character(rf100kb$Feature)
rf100kb$Feature[grep("Gm12878-", rf100kb$Feature)] <- gsub("Gm12878-","",rf100kb$Feature[grep("Gm12878-", rf100kb$Feature)])
rf100kb$Feature[grep("_dist", rf100kb$Feature)] <- gsub("_dist","",rf100kb$Feature[grep("_dist", rf100kb$Feature)])
rf100kb$Importance <- rf100kb$Importance/sum(rf100kb$Importance)



commonannots <- union(rf5kb$Feature,union(rf25kb$Feature,union(rf50kb$Feature,rf100kb$Feature)))

networkmat <- matrix(ncol=4, nrow=length(commonannots), dimnames=list(commonannots, c("5kb", "25kb", "50kb", "100kb")))

networkmat[which(rownames(networkmat) %in% rf5kb$Feature),1] <- rf5kb$Importance
networkmat[which(rownames(networkmat) %in% rf25kb$Feature),2] <- rf25kb$Importance
networkmat[which(rownames(networkmat) %in% rf50kb$Feature),3] <- rf50kb$Importance
networkmat[which(rownames(networkmat) %in% rf100kb$Feature),4] <- rf100kb$Importance

networkmat[is.na(networkmat)] <- 0
networkmat <- networkmat*10

networkdf <- as.data.frame(networkmat)

net = network(networkdf,
              matrix.type = "bipartite",
              ignore.eval = FALSE,
              names.eval = "weights")

col = c("actor" = "green", "event" = "blue")

networkplot <- ggnet2(net, color = "mode", palette = col, edge.size = "weights", label=TRUE)

ggsave("C:/Users/Spiro Stilianoudakis/Documents/TAD_data/results/GM12878/networkplot.png")


networkdf <- as.data.frame(t(networkdf))

net = network(networkdf,
              matrix.type = "bipartite",
              ignore.eval = FALSE,
              names.eval = "weights")

col = c("actor" = "blue", "event" = "green")

networkplot2 <- ggnet2(net, color = "mode", palette = col, edge.size = "weights", label=TRUE)

ggsave("C:/Users/Spiro Stilianoudakis/Documents/TAD_data/results/GM12878/networkplot2.png")


```

