---
title: "Evaluating Distance Densities"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading Libraries

```{r}
library(GenomicRanges)
library(caret)
library(data.table)
library(gbm)
library(randomForest)
library(glmnet)
library(pROC)
library(plyr)
library(dplyr)
library(ggplot2)
library(DMwR)
library(gridExtra)
library(pROC)
library(ROCR)
#library(leaps)
library(cluster)
library(ggpubr)
library(scales)
library(GGally)
library(VennDiagram)
library(network)
library(sna)
library(gtable)
library(grid)
library(magrittr) 
library(DT)
library(tidyverse)
library(reshape)
library(ROSE)
library(lattice)

```


# Evaluating Distance Densities
##GM12878

```{r}
NTdistance_list_gm12878 <- readRDS("Z:/TAD_data_analysis/NTdistance_list_gm12878.rds")

LTdistance_list_gm12878 <- readRDS("Z:/TAD_data_analysis/LTdistance_list_gm12878.rds")

```

### 10kb
```{r}
#no transformation
ntplot10kb_gm12878 <- ggplot(NTdistance_list_gm12878[[1]], aes(x=value, group=variable, color="red")) + 
  geom_density(alpha=.5) +
  guides(color = FALSE)+ 
	xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  scale_x_continuous(limits = c(0,3e+7),
                     breaks = c(0, 1e+07, 2e+07, 3e+07),
                     labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))
  
#log transformation
ltplot10kb_gm12878 <- ggplot(LTdistance_list_gm12878[[1]], aes(x=value, group=variable)) + 
  geom_density(alpha=.5, color="blue") +
  guides(color = FALSE)+ 
	#xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  #scale_x_continuous(limits = c(0,3e+7),
  #                   breaks = c(0, 1e+07, 2e+07, 3e+07),
  #                   labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))

```


### 25kb
```{r}
#no transformation
ntplot25kb_gm12878 <- ggplot(NTdistance_list_gm12878[[2]], aes(x=value, group=variable, color="red")) + 
  geom_density(alpha=.5) +
  guides(color = FALSE)+ 
	xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  scale_x_continuous(limits = c(0,3e+7),
                     breaks = c(0, 1e+07, 2e+07, 3e+07),
                     labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))
  
#log transformation
ltplot25kb_gm12878 <- ggplot(LTdistance_list_gm12878[[2]], aes(x=value, group=variable)) + 
  geom_density(alpha=.5, color="blue") +
  guides(color = FALSE)+ 
	#xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  #scale_x_continuous(limits = c(0,3e+7),
  #                   breaks = c(0, 1e+07, 2e+07, 3e+07),
  #                   labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))

```

### 50kb
```{r}
#no transformation
ntplot50kb_gm12878 <- ggplot(NTdistance_list_gm12878[[3]], aes(x=value, group=variable, color="red")) + 
  geom_density(alpha=.5) +
  guides(color = FALSE)+ 
	xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  scale_x_continuous(limits = c(0,3e+7),
                     breaks = c(0, 1e+07, 2e+07, 3e+07),
                     labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))
  
#log transformation
ltplot50kb_gm12878 <- ggplot(LTdistance_list_gm12878[[3]], aes(x=value, group=variable)) + 
  geom_density(alpha=.5, color="blue") +
  guides(color = FALSE)+ 
	#xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  #scale_x_continuous(limits = c(0,3e+7),
  #                   breaks = c(0, 1e+07, 2e+07, 3e+07),
  #                   labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))

```

### 100kb
```{r}
#no transformation
ntplot100kb_gm12878 <- ggplot(NTdistance_list_gm12878[[4]], aes(x=value, group=variable, color="red")) + 
  geom_density(alpha=.5) +
  guides(color = FALSE)+ 
	xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  scale_x_continuous(limits = c(0,3e+7),
                     breaks = c(0, 1e+07, 2e+07, 3e+07),
                     labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))
  
#log transformation
ltplot100kb_gm12878 <- ggplot(LTdistance_list_gm12878[[4]], aes(x=value, group=variable)) + 
  geom_density(alpha=.5, color="blue") +
  guides(color = FALSE)+ 
	#xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  #scale_x_continuous(limits = c(0,3e+7),
  #                   breaks = c(0, 1e+07, 2e+07, 3e+07),
  #                   labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))

```


##K562

```{r}
NTdistance_list_K562 <- readRDS("Z:/TAD_data_analysis/NTdistance_list_K562.rds")

LTdistance_list_K562 <- readRDS("Z:/TAD_data_analysis/LTdistance_list_K562.rds")


```

### 10kb
```{r}
#no transformation
ntplot10kb_K562 <- ggplot(NTdistance_list_K562[[1]], aes(x=value, group=variable, color="red")) + 
  geom_density(alpha=.5) +
  guides(color = FALSE)+ 
	xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  scale_x_continuous(limits = c(0,3e+7),
                     breaks = c(0, 1e+07, 2e+07, 3e+07),
                     labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))
  
#log transformation
ltplot10kb_K562 <- ggplot(LTdistance_list_K562[[1]], aes(x=value, group=variable)) + 
  geom_density(alpha=.5, color="blue") +
  guides(color = FALSE)+ 
	#xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  #scale_x_continuous(limits = c(0,3e+7),
  #                   breaks = c(0, 1e+07, 2e+07, 3e+07),
  #                   labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))

```


### 25kb
```{r}
#no transformation
ntplot25kb_K562 <- ggplot(NTdistance_list_K562[[2]], aes(x=value, group=variable, color="red")) + 
  geom_density(alpha=.5) +
  guides(color = FALSE)+ 
	xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  scale_x_continuous(limits = c(0,3e+7),
                     breaks = c(0, 1e+07, 2e+07, 3e+07),
                     labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))
  
#log transformation
ltplot25kb_K562 <- ggplot(LTdistance_list_K562[[2]], aes(x=value, group=variable)) + 
  geom_density(alpha=.5, color="blue") +
  guides(color = FALSE)+ 
	#xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  #scale_x_continuous(limits = c(0,3e+7),
  #                   breaks = c(0, 1e+07, 2e+07, 3e+07),
  #                   labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))

```

### 50kb
```{r}
#no transformation
ntplot50kb_K562 <- ggplot(NTdistance_list_K562[[3]], aes(x=value, group=variable, color="red")) + 
  geom_density(alpha=.5) +
  guides(color = FALSE)+ 
	xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  scale_x_continuous(limits = c(0,3e+7),
                     breaks = c(0, 1e+07, 2e+07, 3e+07),
                     labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))
  
#log transformation
ltplot50kb_K562 <- ggplot(LTdistance_list_K562[[3]], aes(x=value, group=variable)) + 
  geom_density(alpha=.5, color="blue") +
  guides(color = FALSE)+ 
	#xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  #scale_x_continuous(limits = c(0,3e+7),
  #                   breaks = c(0, 1e+07, 2e+07, 3e+07),
  #                   labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))

```

### 100kb
```{r}
#no transformation
ntplot100kb_K562 <- ggplot(NTdistance_list_K562[[4]], aes(x=value, group=variable, color="red")) + 
  geom_density(alpha=.5) +
  guides(color = FALSE)+ 
	xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  scale_x_continuous(limits = c(0,3e+7),
                     breaks = c(0, 1e+07, 2e+07, 3e+07),
                     labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))
  
#log transformation
ltplot100kb_K562 <- ggplot(LTdistance_list_K562[[4]], aes(x=value, group=variable)) + 
  geom_density(alpha=.5, color="blue") +
  guides(color = FALSE)+ 
	#xlim(0,30000000) + 
  xlab("") +
	ylab("") + 
  #scale_x_continuous(limits = c(0,3e+7),
  #                   breaks = c(0, 1e+07, 2e+07, 3e+07),
  #                   labels = c(0,1,2,3))+
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15),
     axis.text.y = element_blank(),
     axis.title.x = element_text(size = 20),
     axis.title.y = element_text(size = 20),
     legend.text=element_text(size=15),
     legend.title=element_text(size=20),
     plot.title = element_text(size=20))

```


##Combined

###GM12878
```{r}
allplots_gm12878 <- ggarrange(ntplot10kb_gm12878,
                          ntplot25kb_gm12878,
                          ntplot50kb_gm12878,
                          ntplot100kb_gm12878, 
          ncol=4, 
          nrow=1,
          labels = c("A", "B", "C", "D"),
          font.label = list(size=20))
allplots_gm12878
annotate_figure(allplots_gm12878,
                bottom = text_grob("Distance (in millions of basepairs)", 
                                   color = "black", 
                                   face = "bold", 
                                   size = 15),
                left = text_grob("Density", 
                                 color = "black",
                                 size = 15,
                                 rot = 90))

allplots_gm12878 <- ggarrange(ltplot10kb_gm12878,
                          ltplot25kb_gm12878,
                          ltplot50kb_gm12878,
                          ltplot100kb_gm12878, 
          ncol=4, 
          nrow=1,
          labels = c("E", "F", "G", "H"),
          font.label = list(size=20))
allplots_gm12878
annotate_figure(allplots_gm12878,
                bottom = text_grob("Log2 Transformed Distance", 
                                   color = "black", 
                                   face = "bold", 
                                   size = 15),
                left = text_grob("Density", 
                                 color = "black",
                                 size = 15,
                                 rot = 90))

```

###K562

```{r}
allplots_K562 <- ggarrange(ntplot10kb_K562,
                          ntplot25kb_K562,
                          ntplot50kb_K562,
                          ntplot100kb_K562, 
          ncol=4, 
          nrow=1,
          labels = c("A", "B", "C", "D"),
          font.label = list(size=20))
allplots_K562
annotate_figure(allplots_K562,
                bottom = text_grob("Distance (in millions of basepairs)", 
                                   color = "black", 
                                   face = "bold", 
                                   size = 15),
                left = text_grob("Density", 
                                 color = "black",
                                 size = 15,
                                 rot = 90))

allplots_K562 <- ggarrange(ltplot10kb_K562,
                          ltplot25kb_K562,
                          ltplot50kb_K562,
                          ltplot100kb_K562, 
          ncol=4, 
          nrow=1,
          labels = c("E", "F", "G", "H"),
          font.label = list(size=20))
allplots_K562
annotate_figure(allplots_K562,
                bottom = text_grob("Log2 Transformed Distance", 
                                   color = "black", 
                                   face = "bold", 
                                   size = 15),
                left = text_grob("Density", 
                                 color = "black",
                                 size = 15,
                                 rot = 90))

```

