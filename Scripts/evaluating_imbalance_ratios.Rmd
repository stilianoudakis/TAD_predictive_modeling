---
title: "Evaluating Class Imbalance"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading Libraries

```{r}
library(GenomicRanges)
library(caret)
library(data.table)
library(gbm)
library(randomForest)
library(glmnet)
library(pROC)
library(plyr)
library(dplyr)
library(ggplot2)
library(DMwR)
library(gridExtra)
library(pROC)
library(ROCR)
#library(leaps)
library(cluster)
library(ggpubr)
library(scales)
library(GGally)
library(VennDiagram)
library(network)
library(sna)
library(gtable)
library(grid)
library(magrittr) 
library(DT)
library(tidyverse)
library(reshape)
library(ROSE)
library(lattice)

```

#Evaluating Imbalance Ratios
##GM12878
###10kb

```{r}
IR_gm12878_10kb <- numeric(22)

#reading in whole genome data
whole_genome_dat <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/gm12878_10kb.rds")
#reading in bin data on the whole genome that contains chromosome information
binslist_dat <- readRDS("Z:/TAD_data_analysis/GM12878/10kb/training_testing/binslist10.rds")
  

for(i in 1:22){
  #reducing the whole genome data to only specific chromosome
	reduce_chr <- paste0("chr", i)
	chr_specific_dat <- whole_genome_dat[which(as.character(seqnames(binslist_dat))==reduce_chr),]
	
  IR_gm12878_10kb[i] <- length(chr_specific_dat$y[which(chr_specific_dat$y=="Yes")])/length(chr_specific_dat$y[which(chr_specific_dat$y=="No")])
}


```		

###25kb

```{r}
IR_gm12878_25kb <- numeric(22)

#reading in whole genome data
whole_genome_dat <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/training_testing/gm12878_25kb.rds")
#reading in bin data on the whole genome that contains chromosome information
binslist_dat <- readRDS("Z:/TAD_data_analysis/GM12878/25kb/training_testing/binslist25.rds")
  

for(i in 1:22){
  #reducing the whole genome data to only specific chromosome
	reduce_chr <- paste0("chr", i)
	chr_specific_dat <- whole_genome_dat[which(as.character(seqnames(binslist_dat))==reduce_chr),]
	
  IR_gm12878_25kb[i] <- length(chr_specific_dat$y[which(chr_specific_dat$y=="Yes")])/length(chr_specific_dat$y[which(chr_specific_dat$y=="No")])
}


```		

###50kb

```{r}
IR_gm12878_50kb <- numeric(22)

#reading in whole genome data
whole_genome_dat <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/training_testing/gm12878_50kb.rds")
#reading in bin data on the whole genome that contains chromosome information
binslist_dat <- readRDS("Z:/TAD_data_analysis/GM12878/50kb/training_testing/binslist50.rds")
  

for(i in 1:22){
  #reducing the whole genome data to only specific chromosome
	reduce_chr <- paste0("chr", i)
	chr_specific_dat <- whole_genome_dat[which(as.character(seqnames(binslist_dat))==reduce_chr),]
	
  IR_gm12878_50kb[i] <- length(chr_specific_dat$y[which(chr_specific_dat$y=="Yes")])/length(chr_specific_dat$y[which(chr_specific_dat$y=="No")])
}


```		

###100kb

```{r}
IR_gm12878_100kb <- numeric(22)

#reading in whole genome data
whole_genome_dat <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/training_testing/gm12878_100kb.rds")
#reading in bin data on the whole genome that contains chromosome information
binslist_dat <- readRDS("Z:/TAD_data_analysis/GM12878/100kb/training_testing/binslist100.rds")
  

for(i in 1:22){
  #reducing the whole genome data to only specific chromosome
	reduce_chr <- paste0("chr", i)
	chr_specific_dat <- whole_genome_dat[which(as.character(seqnames(binslist_dat))==reduce_chr),]
	
  IR_gm12878_100kb[i] <- length(chr_specific_dat$y[which(chr_specific_dat$y=="Yes")])/length(chr_specific_dat$y[which(chr_specific_dat$y=="No")])
}


```		
	

##K562
###10kb

```{r}
IR_K562_10kb <- numeric(22)

#reading in whole genome data
whole_genome_dat <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/K562_10kb.rds")
#reading in bin data on the whole genome that contains chromosome information
binslist_dat <- readRDS("Z:/TAD_data_analysis/K562/10kb/training_testing/binslist10.rds")
  

for(i in 1:22){
  #reducing the whole genome data to only specific chromosome
	reduce_chr <- paste0("chr", i)
	chr_specific_dat <- whole_genome_dat[which(as.character(seqnames(binslist_dat))==reduce_chr),]
	
  IR_K562_10kb[i] <- length(chr_specific_dat$y[which(chr_specific_dat$y=="Yes")])/length(chr_specific_dat$y[which(chr_specific_dat$y=="No")])
}


```		

###25kb

```{r}
IR_K562_25kb <- numeric(22)

#reading in whole genome data
whole_genome_dat <- readRDS("Z:/TAD_data_analysis/K562/25kb/training_testing/K562_25kb.rds")
#reading in bin data on the whole genome that contains chromosome information
binslist_dat <- readRDS("Z:/TAD_data_analysis/K562/25kb/training_testing/binslist25.rds")
  

for(i in 1:22){
  #reducing the whole genome data to only specific chromosome
	reduce_chr <- paste0("chr", i)
	chr_specific_dat <- whole_genome_dat[which(as.character(seqnames(binslist_dat))==reduce_chr),]
	
  IR_K562_25kb[i] <- length(chr_specific_dat$y[which(chr_specific_dat$y=="Yes")])/length(chr_specific_dat$y[which(chr_specific_dat$y=="No")])
}


```		

###50kb

```{r}
IR_K562_50kb <- numeric(22)

#reading in whole genome data
whole_genome_dat <- readRDS("Z:/TAD_data_analysis/K562/50kb/training_testing/K562_50kb.rds")
#reading in bin data on the whole genome that contains chromosome information
binslist_dat <- readRDS("Z:/TAD_data_analysis/K562/50kb/training_testing/binslist50.rds")
  

for(i in 1:22){
  #reducing the whole genome data to only specific chromosome
	reduce_chr <- paste0("chr", i)
	chr_specific_dat <- whole_genome_dat[which(as.character(seqnames(binslist_dat))==reduce_chr),]
	
  IR_K562_50kb[i] <- length(chr_specific_dat$y[which(chr_specific_dat$y=="Yes")])/length(chr_specific_dat$y[which(chr_specific_dat$y=="No")])
}


```		

###100kb

```{r}
IR_K562_100kb <- numeric(22)

#reading in whole genome data
whole_genome_dat <- readRDS("Z:/TAD_data_analysis/K562/100kb/training_testing/K562_100kb.rds")
#reading in bin data on the whole genome that contains chromosome information
binslist_dat <- readRDS("Z:/TAD_data_analysis/K562/100kb/training_testing/binslist100.rds")
  

for(i in 1:22){
  #reducing the whole genome data to only specific chromosome
	reduce_chr <- paste0("chr", i)
	chr_specific_dat <- whole_genome_dat[which(as.character(seqnames(binslist_dat))==reduce_chr),]
	
  IR_K562_100kb[i] <- length(chr_specific_dat$y[which(chr_specific_dat$y=="Yes")])/length(chr_specific_dat$y[which(chr_specific_dat$y=="No")])
}


```		
	
# Combined

```{r}
irtab <- data.frame(IR = c(IR_gm12878_10kb,
                                 IR_gm12878_25kb,
                                 IR_gm12878_50kb,
                                 IR_gm12878_100kb,
                                 IR_K562_10kb,
                                 IR_K562_25kb,
                                 IR_K562_50kb,
                                 IR_K562_100kb),
                          CL = c(rep("GM12878", 22*4), rep("K562", 22*4)),
                          Resolution = rep(c("10 kb", "25 kb", "50 kb", "100 kb"), 2),
                          Chromosome = rep(paste0("CHR",1:22),4)
                          )

irtab$CL <- factor(irtab$CL, levels=c("GM12878", "K562"))
irtab$Resolution <- factor(irtab$Resolution, levels=c("10 kb", "25 kb", "50 kb", "100 kb"))
irtab$Chromosome <- factor(irtab$Chromosome, levels=paste0("CHR",1:22))

irtab <- irtab[-which(irtab$Chromosome=="CHR9"),]

ggplot(irtab, aes(x = Resolution, y = IR, fill = Resolution, color = Resolution)) +
  geom_boxplot(#fill = fill, 
               #colour = line,
               outlier.colour = "black") +
  facet_grid(~ CL) +
  guides(fill=FALSE, color=FALSE) +
  xlab("Resolution") +
  ylab("Imbalance Ratio") +
  theme_minimal() +
  theme_bw() +
  theme(axis.text.x = element_text(size=15,
                                   angle = 45, 
                                   #margin = ggplot2::margin(t = 35),
                                   hjust = 1),
        axis.text.y = element_text(size = 15),
        axis.title.x = element_text(size = 20),
        axis.title.y = element_text(size = 20),
        legend.text=element_text(size=15),
        legend.title=element_text(size=20),
        strip.text.x = element_text(size = 15))
  
  
```

