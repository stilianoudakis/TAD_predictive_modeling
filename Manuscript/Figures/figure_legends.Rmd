---
title: "Legends for Figures"
author: "Spiro Stilianoudakis"
date: "November 19, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Figure 1. Ensemble Framework.** A diagram of the cell line specific ensemble framework detailing the various combination of inputs used in the model building pipeline. The minoirty and majority classes were represented by the genomic bins that overlapped with flanked TAD boundaries or did not, respectively. Functional genomic annotations obtained from the UCSC Genome Browser Database composed the feature space. The data was split into a 7:3 training to testing set ratio. A feature engineering step was included to isolate the spatial relationship, of increasing granularity, between annotations and genomic bins. Data re-sampling and regularization was applied to the training data. Lastly, a random forest classification algorithm was implemeted and validated on the testing data.

<!--
A given system within the ensemble framework included the total number of genomic bins, labeled as having been overlapped with a flanked TAD boundary ($Y=1$) or not ($Y=0$). The data matrix that composed the feature space was composed of predictor-type specific annotations represented by $X = \{X_1, X_2, ..., X_p\}$, where $p$ was the complete set of functional annotations. The data was then split into a 7:3 training to testing set ratio. A re-sampling technique was applied to the training set, followed by an elastic-net regularization to reduce the feature space. Lastly, a random forest classification model was performed on the re-sampled and reduced training set and validated on the held out testing set common to all ensemble systems in the framework.
-->

**Figure 2. Model Construction.** An illustration of the proposed model construction given cell line specific Hi-C matrices. The contact matrix above is a visualization of the interconnectivity of chromosome 14 at 100 kb resolution, for the GM12878 cell line, on the intervals from 20 mb to 100 mb [@durand2016juicer]. The boundary coordinates of topologically association domains (TADs) were identified using the Arrowhead algorithm. To account for the uncertainty in TAD boundary detection, each boundary point was flanked on both sides by resolution-specific genomic regions (bins). The response vector $Y$, used for classification, was determined by whether a genomic bin overlapped with a flanked boundary region ($Y=1$) or not ($Y=0$). The spatial relationship between positional coordinates of various functional genomic annotations, obtained from ENCODE, together with the genomic bins were then used to define the feature space of the models represented by the data matrix $X = \{X_1, X_2, ..., X_p\}$, where $p$ was the complete set of functional annotations.

**Figure 3. The three predictor types.** Three separate types of predictors were considered when quantifying the association between TAD boundaries and genomic annotations. Each predictor type was used to build the feature space of specific models in the ensemble framework. The _overlap count_ (OC) predictors consider the total number of genomic features that overlapped with each genomic bin. The _overlap percent_ (OP) predictors were calculated by dividing the sum of all feature widths within each specific bin by the total bin width. The _distance_ ($log_{2}$ transformed) predictors were calculated by measuring the distance (in bases) from the center of each genomic bin to the center of the nearest genomic feature. 

**Figure 4. Comparing ensemble system specific model performances for GM12878.** Performances of random forest classification models built on each of the 3 predictor types: OC (A), OP (B), and Distance (C). Within each predictor type, and across resolution, MCCs metrics were recorded for models subsequently implemented on re-sampled data using the 4 re-sampling techniques: None (red), ROS (green), RUS (blue), and SMOTE (purple). Performances were aggregated using means across each chromosome, with error bars representing 1 standard deviation away from the mean. 

**Figure 5. Predictive importance is outweighed by transcription factor binding sites.** Stacked barplots illustrating the proportion of total predictive importance in models using optimal data level characteristics determined by the ensemble framework, for each resolution on GM12878. Proportions are separated by the set of annotations included in the feature space including chromatin state segmentation, histone modification, and transcription factor binding sites. 

**Figure 6. Comparing annotation-specific random forest models implemented on SMOTE re-sampled data with distance-type predictors for GM12878.** MCC performances were compared for models using specific groups of annotations as the feature space including: histone modifications (HM; red), chromatin state segmentations (CSS; green), transcription factor binding sites (TFBS; blue), and a feature space containing all 3 types combined (combined; purple). Each bar represents a model ran through the ensemble framework, with re-sampling technique and predictor-type characteristics fixed to SMOTE and distance-types. The error bars represent $\pm$ 1 standard deviation from the mean MCC across each chromosome.

**Figure 7. Predictive importance.** A heatmap illustrating the importance of the top 20 most predictive transcription factors for random forest models implemented on SMOTE resampled data with distance-type predictors for GM12878. Importances were sorted according to the 10 kb resolution and rescaled to values between 0 and 100. Transcription factors with higher values of predictive importance are denoted in dark red.

**Figure 8. Comparing $log_{2}$ distance profiles.** Boxplots illustrating the distribution of distances around 10 kb regions on the GM12878 genome that either overlapped with a flanked TAD boundary (Yes) or did not (No), for the most influential TFBS including SMC3, CTCF, RAD21, ZNF143, and YY1sc281. P-values obtained from Wilcoxon Rank Sum tests are provided assessing the significance [**** = p < 0.00001]. 

<!--
**Figure 7. Comparing $log_{2}$ distance profiles of top predictive transcription factor binding sites by bin class for 10 kb resolution, on GM12878.** Violin plots (top) and plots of differences in quantiles (bottom) between genomic bin class for 4 of the top predictive TFBS determined by the best performing model, including: SMC3 (A), ZNF143 (B), CTCF (C), and RAD21 (D). For the plots of differences in quantiles, the reference group are the genomic bins that did not overlap with a flanked TAD boundary. That is, quantile differences above 0 indicate that bins that overlapped with flanked TAD boundaries exhibited smaller quantiles.
-->



