---
title: "Legends for Figures"
author: "Spiro Stilianoudakis"
date: "November 19, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Figure 1: Model Construction.** An illustration of the proposed model construction given cell line-specific Hi-C matrices. The contact matrix above is a visualization of the interconnectivity of chromosome 14 at 100 kb resolution, for the GM12878 cell line, on the intervals from 20 mb to 100 mb. The boundary coordinates of topologically association domains (TADs) were identified using the Arrowhead algorithm. To account for the uncertainty in TAD boundary detection, each boundary point was flanked on both sides by resolution-specific genomic regions (bins). The response vector $Y$, used for classification, was determined by whether a genomic bin overlapped with a flanked boundary region (Y=1) or not (Y=0). The spatial relationship between positional coordinates of various functional genomic annotations, obtained from ENCODE, and the genomic bins were then used to define the feature space of the models.

**Figure 2: Ensemble Framework/Model Building Pipeline.** A diagram of the model building pipeline given a combination of inputs from the ensemble framework. A particular ensemble system included the total number of genomic bins, labeled as having been overlapped with a flanked TAD boundary or not, as well as a feature space composed of 1 of 3 different predictor-type specific annotations. The data was then split into a 7:3 training:testing set ratio. A re-sampling technique was applied to the training set, followed by an elastic-net regularization to reduce the feature space. Lastly, a random forest classification model was performed on the re-sampled and reduced training set and validated on the held out testing set common to all ensemble systems in the framework.

**Figure 3. The three predictor types considered when quantifying the association between TAD boundaries and genomic annotations.** The _overlap count_ (OC) predictors consider the total number of genomic features that overlapped with each genomic bin. The _overlap percent_ (OP) predictors were calculated by dividing the sum of all feature widths within each specific bin by the total bin width. The _distance_ ($log_{2}$ transformed) predictors were calculated by measuring the distance (in bases) from the center of each genomic bin to the center of the nearest genomic feature.

**Figure 4. Data summaries in the form of barplots for the GM12878 (red) and K562 (blue) cell lines.** (A) The total number of genomic bins created by partitioning the linear genome into unit intervals corresponding to the resolution of the relevant domain data. (B) Subsequent imbalance ratios, defined as the ratio of the number of bins that overlapped with a flanked TAD boundary to the number of bins that did not overlap with a flanked TAD boundary.


**Figure 7. Evaluating effect of class imbalance on model performance.** 

<!--
**Figure 4. Barplots comparing model performance for each predictor type.** Model performances were evaluated using F1-score, MCC, and balanced accuracy for each of the 4 resampling techniques, across both the GM12878 (A) and K562 (B) cell lines. The results presented are for models applied to 10 kb resolution data.

**Figure 5. Line plots comparing models using SMOTE resampling with distance-type predictors.** Model performances were evaluated using F1-score, MCC, and balanced accuracy for each of the 4 data resolutions, across both the GM12878 (red, solid line) and K562 (blue; dashed line) cell lines. For a given metric, each point represents a model applied to a particular resolution with distance type predictors for the feature space, after which the SMOTE algorithm was used to create balanced classes on the trianing set.

**Figure 6. Variable importance of the top 20 most predictive genomic annotations for models using SMOTE resampling with distance-type predictors.** The list of genomic features are the union of the top 20 most important genomic annotations across resolutions for the GM12878 (A) and K562 (B) cell lines. Variable importance is assigned on a continuous scale (range: 0-100). Grid entries filled in gray denote an annotation that was not featured as one of the top 20 most predictive variables in a given model. The genomic annotations are sorted by highest level of importance obtained from a random forest model using distance-type predictors at the 10 kb data resolution, while using SMOTE resampling, for each cell line respectively.
-->

<!--
**Figures 4-8. Precision-Recall curves for 10 kb data.** Precision-recall curves were used to initially compare performance of random forest models with different predictor types on 10 kb resolution data, across each resampling technique. GM12878 (solid line) and K562 (dashed line) cell lines were compared with predictor type-specific models which included overlap counts (blue), overlap percents (purple), log distance (green), and all three combined (red). 
-->

<!--
**Figure 9-13. Recursive Feature Elimination for 10 kb data** Beginning with the full set of distance type predictors for each cell line, models built on 10 kb resolution data were recursively evaluated at different subsets of feature size. For convenience and computational efficiency, feature size decreasing in powers of 2 was considered. The maximum size for feature subsets differed between cell line due the available annotations that were considered and provided in Supplementary Table 1. Near optimal performance was achieved using the top 32 distance type predictors for both the GM12878 (red) and K562 cell lines (blue).
-->


