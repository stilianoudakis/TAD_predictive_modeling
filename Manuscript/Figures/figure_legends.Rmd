---
title: "Legends for Figures"
author: "Spiro Stilianoudakis"
date: "November 19, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Figure 1: Model Construction.** An illustration of the proposed model construction given cell line-specific Hi-C matrices obtained from [@rao20143d]. The contact matrix above is a visualization of the interconnectivity of chromosome 14 (GM12878) on the intervals from 20 mb to 100 mb [@durand2016juicebox]. The coordinates of subsequent topologically association domains were identified using the arrowhead algorithm from Juicer. The linear genome, represented by the diagonal of the contact matrix, was then binned according to prespecified interaction frequency resolutions (10 kb, 25 kb, 50 kb, and 100 kb). Each TAD coordinate was then flanked by a unit-specific amount (in basepairs) respective to the resolution of the corresponding contact matrix. The response vector Y, used for classification, was determined by whether a genomic bin overlapped with a flanked boundary region (Y=1) or not (Y=0). The spatial relationship between positional coordinates of various functional genomic annotations, obtained from ENCODE, and the genomic bins were then used to define the feature space of the models.

**Figure 2: Ensemble Framework/Model Building Pipeline.** A diagram of the model building pipeline given a combination of inputs from the ensemble framework. For a particular cell line, contact matrix resolution, and set of features, the data was split into a 7:3 training:testing set ratio.  For the training set, recursive feature elimination was used to reduce the feature space and minimize the influence of uninformative predictors. A particular resampling technique was applied to the reduced training set to create balanced classes. A random forest classification algorithm was then performed and validated using the testing set.

**Figure 3. The three predictor types considered when quantifying the association between TAD boundaries and genomic annotations.** The _overlap count_ (OC) predictors consider the total number of genomic features that overlapped with each genomic bin. The _overlap percent_ (OP) predictors were calculated by dividing the sum of all feature widths within each specific bin by the total bin width. The _distance_ ($log_{2}$ transformed) predictors were calculated by measuring the distance (in bases) from the center of each genomic bin to the center of the nearest genomic feature.

**Figures 4-8. Precision-Recall curves for 10 kb data.** Precision-recall curves were used to initially compare performance of random forest models with different predictor types on 10 kb resolution data, across each resampling technique. GM12878 (solid line) and K562 (dashed line) cell lines were compared with predictor type-specific models which included overlap counts (blue), overlap percents (purple), log distance (green), and all three combined (red). 

**Figure 9-13. Recursive Feature Elimination for 10 kb data** Beginning with the full set of distance type predictors for each cell line, models built on 10 kb resolution data were recursively evaluated at different subsets of feature size. For convenience and computational efficiency, feature size decreasing in powers of 2 was considered. The maximum size for feature subsets differed between cell line due the available annotations that were considered and provided in Supplementary Table 1. Near optimal performance was achieved using the top 32 distance type predictors for both the GM12878 (red) and K562 cell lines (blue).



